<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<!-- Mirrored from localhost:8080/Additional_Documentation/New_SciPy_Tutorial?highlight=%28%28SciPy%29%29 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 23:20:10 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="edit_on_doubleclick" content="/">
<meta name="robots" content="noindex,nofollow">

<title>Additional_Documentation/New_SciPy_Tutorial - SciPy wiki dump</title>
<script type="text/javascript" src="../moin_static197/common/js/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../moin_static197/modern/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="../moin_static197/modern/css/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="../moin_static197/modern/css/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="../moin_static197/modern/css/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static197/modern/css/msie.css">
<![endif]-->


<link rel="alternate" title="SciPy: Additional_Documentation/New_SciPy_Tutorial" href="../../external.html?link=http://localhost:8080/Additional_Documentation/New_SciPy_Tutorial?diffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=Additional_Documentation%2FNew_SciPy_Tutorial&amp;ddiffs=1" type="application/rss+xml">


<link rel="Start" href="../AllPages.html">
<link rel="Alternate" title="Wiki Markup" href="../../external.html?link=http://localhost:8080/Additional_Documentation/New_SciPy_Tutorial?action=raw">
<link rel="Alternate" media="print" title="Print View" href="../../external.html?link=http://localhost:8080/Additional_Documentation/New_SciPy_Tutorial?action=print">
<link rel="Up" href="../Additional_Documentation.html">
<link rel="Search" href="../FindPage.html">
<link rel="Index" href="../TitleIndex.html">
<link rel="Glossary" href="../WordIndex.html">
<link rel="Help" href="../HelpOnFormatting.html">
</head>

<body  lang="en" dir="ltr"><div style="background: white; padding:2em;">This is an archival dump of old wiki content --- see <a href="http://scipy.org/">scipy.org</a> for current material</div>

<div id="header">


<form id="searchform" method="get" action="../../external.html?link=http://localhost:8080/Additional_Documentation/New_SciPy_Tutorial">
<div>
<input type="hidden" name="action" value="fullsearch">
<input type="hidden" name="context" value="180">
<label for="searchinput">Search:</label>
<input id="searchinput" type="text" name="value" value="" size="20"
    onfocus="searchFocus(this)" onblur="searchBlur(this)"
    onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search">
<input id="titlesearch" name="titlesearch" type="submit"
    value="Titles" alt="Search Titles">
<input id="fullsearch" name="fullsearch" type="submit"
    value="Text" alt="Search Full Text">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<ul id="username"><li><a href="New_SciPy_Tutorial456e.html?action=login" id="login" rel="nofollow">Login</a></li></ul>
<div id="locationline">
<div id="interwiki"><span><a href="../AllPages.html" rel="nofollow">SciPy</a></span></div>

<ul id="pagelocation">
<li><a href="../Additional_Documentation.html">Additional_Documentation</a></li><li><a class="backlink" href="New_SciPy_Tutorialb4cc.html?action=fullsearch&amp;context=180&amp;value=linkto%3A%22Additional_Documentation%2FNew_SciPy_Tutorial%22" rel="nofollow" title="Click to do a full-text search for this title">New_SciPy_Tutorial</a></li>
</ul>

</div>


<ul id="navibar">
<li class="wikilink"><a href="../RecentChanges.html">RecentChanges</a></li><li class="wikilink"><a class="nonexistent" href="../FindPage.html">FindPage</a></li><li class="wikilink"><a class="nonexistent" href="../HelpContents.html">HelpContents</a></li><li class="current"><a href="New_SciPy_Tutorial.html">New_SciPy_Tutorial</a></li>
</ul>

<div id="pageline"><hr style="display:none;"></div>

<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="New_SciPy_Tutorial37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../../external.html?link=http://localhost:8080/Additional_Documentation/New_SciPy_Tutorial">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

</div>

<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><span class="anchor" id="line-2"></span><p class="line867"><div class="table-of-contents"><p class="table-of-contents-heading">Contents<ol><li>
<a href="#New_SciPy_Tutorial">New <strong class="highlight">SciPy</strong> Tutorial</a></li><li>
<a href="#Prerequisites">Prerequisites</a><ol><li>
<a href="#Basic_matrix_operations">Basic matrix operations</a></li><li>
<a href="#Sparse_matrices">Sparse matrices</a><ol><li>
<a href="#Example_1">Example 1</a></li><li>
<a href="#Example_2">Example 2</a></li></ol></li><li>
<a href="#Numerical_integration">Numerical integration</a></li><li>
<a href="#Integrating_ODEs">Integrating ODEs</a></li></ol></li><li>
<a href="#Older_SciPy_Tutorial">Older <strong class="highlight">SciPy</strong> Tutorial</a></li></ol></div><p class="line874"> <span class="anchor" id="line-3"></span><span class="anchor" id="line-4"></span><p class="line867">
<h1 id="New_SciPy_Tutorial">New <strong class="highlight">SciPy</strong> Tutorial</h1>
<span class="anchor" id="line-5"></span><span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><p class="line874">[Under construction -- Please help!] <span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><p class="line867">
<h1 id="Prerequisites">Prerequisites</h1>
<span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span><p class="line874">Before reading this tutorial you should know a bit of Python. <span class="anchor" id="line-12"></span>If this is not the case, or if you want to refresh your memory, <span class="anchor" id="line-13"></span>take a look at the <a class="http" href="../../external.html?link=http://docs.python.org/tut/">Python tutorial</a>. <span class="anchor" id="line-14"></span>In particular, you may wish to read up to section 6 (Modules). <span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span><p class="line874">You also need to have some software installed on your computer. <span class="anchor" id="line-17"></span>You need at least <span class="anchor" id="line-18"></span><ul><li><p class="line891"><a class="http" href="../../external.html?link=http://www.python.org/">Python</a> <span class="anchor" id="line-19"></span></li><li><p class="line862">and <a class="nonexistent" href="../NumPy.html">NumPy</a> (It is useful to read the <a href="../Tentative_NumPy_Tutorial.html">Tentative_NumPy_Tutorial</a>) <span class="anchor" id="line-20"></span></li><li><p class="line862">and <a href="../SciPy.html"><strong class="highlight">SciPy</strong></a>, <span class="anchor" id="line-21"></span></li></ul><p class="line874">but there are some other tools that may be useful to you: <span class="anchor" id="line-22"></span><ul><li><p class="line891"><a class="http" href="../../external.html?link=http://ipython.scipy.org/">ipython</a> is an enhanced Interactive Python shell which is very convenient for exploring <strong class="highlight">SciPy</strong>'s features. <span class="anchor" id="line-23"></span></li><li><p class="line891"><a class="http" href="../../external.html?link=http://matplotlib.sourceforge.net/">matplotlib</a> will enable you to plot graphics. <span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span></li></ul><p class="line867">
<h2 id="Basic_matrix_operations">Basic matrix operations</h2>
<span class="anchor" id="line-28"></span><p class="line862">For the basic matrix operations you can make a matrix like an array in the <a class="nonexistent" href="../NumPy.html">NumPy</a> (see the <a href="../Tentative_NumPy_Tutorial.html">Tentative_NumPy_Tutorial</a>): <span class="anchor" id="line-29"></span><span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span><span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span><span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span><span class="anchor" id="line-1-1"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-2ee441a11db456f2e5690944b99985467edb7930" lang="en"><span class="line"><span class="anchor" id="line-1-2"></span><span class="ResWord">from</span> <span class="ID">numpy</span> <span class="ResWord">import</span> <span class="ID">matrix</span></span>
<span class="line"><span class="anchor" id="line-2-1"></span><span class="ResWord">from</span> <span class="ID"><strong class="highlight">scipy</strong>.linalg</span> <span class="ResWord">import</span> <span class="ID">inv</span>, <span class="ID">det</span>, <span class="ID">eig</span></span>
<span class="line"><span class="anchor" id="line-3-1"></span></span>
<span class="line"><span class="anchor" id="line-4-1"></span><span class="ID">A</span>=<span class="ID">matrix</span>([[<span class="Number">1</span>,<span class="Number">1</span>,<span class="Number">1</span>],[<span class="Number">4</span>,<span class="Number">4</span>,<span class="Number">3</span>],[<span class="Number">7</span>,<span class="Number">8</span>,<span class="Number">5</span>]]) <span class="Comment"># 3 lines 3 rows</span></span>
<span class="line"><span class="anchor" id="line-5-1"></span><span class="ID">b</span> = <span class="ID">matrix</span>([<span class="Number">1</span>,<span class="Number">2</span>,<span class="Number">1</span>]).<span class="ID">transpose</span>()     <span class="Comment"># 3 lines 1 rows.</span></span>
<span class="line"><span class="anchor" id="line-6-1"></span></span>
<span class="line"><span class="anchor" id="line-7-1"></span><span class="ResWord">print</span> <span class="ID">det</span>(<span class="ID">A</span>)     <span class="Comment"># We can check, whether the matrix is regular</span></span>
<span class="line"><span class="anchor" id="line-8-1"></span><span class="ResWord">print</span> <span class="ID">inv</span>(<span class="ID">A</span>)*<span class="ID">b</span>   <span class="Comment"># Now we can print the solution of the Ax=b linear equation system.</span></span>
<span class="line"><span class="anchor" id="line-9-1"></span><span class="ResWord">print</span> <span class="ID">eig</span>(<span class="ID">A</span>)</span>
</pre></div></div><span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><p class="line874">When we use numpy.array or numpy.matrix there is a difference. A*x will be in the latter case matrix product, not elementwise product as with array. <span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><p class="line874">We have an other possibility to solve the equation system with <strong class="highlight">scipy</strong>.linalg.solve function (see Example 1). <span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span><p class="line867">
<h2 id="Sparse_matrices">Sparse matrices</h2>
<span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span><p class="line862">The <strong><tt class="backtick"><strong class="highlight">scipy</strong>.sparse</tt></strong> module provides data structures for 2D sparse matrices. There are five available sparse matrix types: <span class="anchor" id="line-48"></span><ol type="1"><li><p class="line891"><strong><tt class="backtick">csc_matrix</tt></strong>: <strong>C</strong>ompressed <strong>S</strong>parse <strong>C</strong>olumn <span class="anchor" id="line-49"></span></li><li><p class="line891"><strong><tt class="backtick">csr_matrix</tt></strong>: <strong>C</strong>ompressed <strong>S</strong>parse <strong>R</strong>ow format <span class="anchor" id="line-50"></span></li><li><p class="line891"><strong><tt class="backtick">lil_matrix</tt></strong>: <strong>Li</strong>st of <strong>L</strong>ists format <span class="anchor" id="line-51"></span></li><li><p class="line891"><strong><tt class="backtick">dok_matrix</tt></strong>: <strong>D</strong>ictionary <strong>o</strong>f <strong>K</strong>eys format <span class="anchor" id="line-52"></span></li><li><p class="line891"><strong><tt class="backtick">coo_matrix</tt></strong>: <strong>Coo</strong>rdinate format <span class="anchor" id="line-53"></span><span class="anchor" id="line-54"></span></li></ol><p class="line862">To construct a matrix efficiently, using either <tt class="backtick">lil_matrix</tt> (recommended) or <tt class="backtick">dok_matrix</tt> is suggested, for convenience; the <tt class="backtick">lil_matrix</tt> class supports basic slicing and fancy indexing with a similar syntax to NumPy arrays, and is adapted to gradually fill your sparse matrix, while compressed formats are not suited to a progressive filling. <span class="anchor" id="line-55"></span><span class="anchor" id="line-56"></span><p class="line862">To perform manipulations such as multiplication or inversion, first convert the matrix to either CSC or CSR format. These formats store the sparse matrix in arrays and allow faster computations than the list or dictionary-based formats. The <tt class="backtick">lil_matrix</tt> format is row-based, so conversion to CSR is efficient, whereas conversion to CSC is less so. <span class="anchor" id="line-57"></span><span class="anchor" id="line-58"></span><p class="line874">Notes: <span class="anchor" id="line-59"></span><ul><li><p class="line891"><strong><tt class="backtick"><strong class="highlight">scipy</strong>.sparse</tt></strong> currently only handles float numbers (both 32 and 64bits, both real and complex). <span class="anchor" id="line-60"></span></li><li><p class="line862">CSC format is also called <a class="http" href="../../external.html?link=http://math.nist.gov/MatrixMarket/formats.html#hb">Harwell-Boeing</a> format, and used in other libraries or software (<a class="http" href="../../external.html?link=http://www.mathworks.com/access/helpdesk/help/techdoc/math/sparse3.html#12993">Matlab</a> for example). <span class="anchor" id="line-61"></span><span class="anchor" id="line-62"></span></li></ul><p class="line867">
<h3 id="Example_1">Example 1</h3>
<span class="anchor" id="line-63"></span><p class="line862">This is a very simple example illustrating basic usage of <tt class="backtick">linsolve</tt>, <tt class="backtick">sparse</tt> <span class="anchor" id="line-64"></span>and some other useful things (use the latest version of linsolve.py). If you <span class="anchor" id="line-65"></span>don't know how to get hold of the latest modules, spend some time in the <span class="anchor" id="line-66"></span><a href="../Developer_Zone.html">Developer_Zone</a> and see the <strong>SOURCE CODE</strong> section. <span class="anchor" id="line-67"></span><span class="anchor" id="line-68"></span><span class="anchor" id="line-69"></span><p class="line862">We're going to solve a trivial case of <tt class="backtick">Ax&nbsp;=&nbsp;b</tt>, where <tt class="backtick">A</tt> is a matrix, <tt class="backtick">b</tt> a <span class="anchor" id="line-70"></span>vector (the RHS) and <tt class="backtick">x</tt> the unknowns. In this example <tt class="backtick">A</tt> refers to the <span class="anchor" id="line-71"></span>'normal' matrix, and <tt class="backtick">Asp</tt> to the <strong>sparse representation</strong> of <tt class="backtick">A</tt>, <tt class="backtick">x</tt> for <span class="anchor" id="line-72"></span>the 'normal' solution and <tt class="backtick">xsp</tt> for the solution arising from using the sparse method. <span class="anchor" id="line-73"></span>(You'll most probably find it useful to use <a class="http" href="../../external.html?link=http://ipython.scipy.org/">IPython</a> <span class="anchor" id="line-74"></span>when going through this example, especially if you're used to Matlab®. The normal <span class="anchor" id="line-75"></span>Python prompt looks like this <tt class="backtick">&gt;&gt;&gt;</tt>, IPython's default prompt (one can change it) <span class="anchor" id="line-76"></span>looks like this <tt class="backtick">In&nbsp;[x]:</tt>, where the <tt class="backtick">x</tt> is a number). <span class="anchor" id="line-77"></span><span class="anchor" id="line-78"></span><p class="line874">Import the necessary commands from the numpy and <strong class="highlight">scipy</strong> modules: <span class="anchor" id="line-79"></span><span class="anchor" id="line-80"></span><span class="anchor" id="line-81"></span><span class="anchor" id="line-82"></span><span class="anchor" id="line-1-3"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-36220915f6c50429f9c562254ca9b34601d6158d" lang="en"><span class="line"><span class="anchor" id="line-1-4"></span><span class="ResWord">from</span> <span class="ID">numpy</span> <span class="ResWord">import</span> <span class="ID">allclose</span>, <span class="ID">arange</span>, <span class="ID">eye</span>, <span class="ID">linalg</span>, <span class="ID">ones</span></span>
<span class="line"><span class="anchor" id="line-2-2"></span><span class="ResWord">from</span> <span class="ID"><strong class="highlight">scipy</strong></span> <span class="ResWord">import</span> <span class="ID">linsolve</span>, <span class="ID">sparse</span></span>
</pre></div></div><span class="anchor" id="line-83"></span><p class="line874">It is of course also possible to import all the commands from the two modules, <span class="anchor" id="line-84"></span>but in that case it might not be a bad idea to do it as follows (note that this is <span class="anchor" id="line-85"></span>just one way of doing it): <span class="anchor" id="line-86"></span><span class="anchor" id="line-87"></span><span class="anchor" id="line-88"></span><span class="anchor" id="line-89"></span><span class="anchor" id="line-1-5"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-00628b144598fb4a2a814fdfd1acc5f284d5c6d3" lang="en"><span class="line"><span class="anchor" id="line-1-6"></span><span class="ResWord">import</span> <span class="ID">numpy</span> <span class="ResWord">as</span> <span class="ID">N</span></span>
<span class="line"><span class="anchor" id="line-2-3"></span><span class="ResWord">import</span> <span class="ID"><strong class="highlight">scipy</strong></span> <span class="ResWord">as</span> <span class="ID">S</span></span>
</pre></div></div><span class="anchor" id="line-90"></span><p class="line862">If you're working in an IPython session, type <tt class="backtick">S.</tt> and press the &lt;TAB&gt; button, <span class="anchor" id="line-91"></span>you'll see all the available commands (attributes). The same goes for <tt class="backtick">N.</tt> <span class="anchor" id="line-92"></span><span class="anchor" id="line-93"></span><p class="line862">Construct an identity 1000x1000 <tt class="backtick">lil_matrix</tt>. There is a couple of ways of <span class="anchor" id="line-94"></span>doing this, one method is slow, the other not. <span class="anchor" id="line-95"></span>A slow method: <span class="anchor" id="line-96"></span><span class="anchor" id="line-97"></span><span class="anchor" id="line-98"></span><span class="anchor" id="line-99"></span><span class="anchor" id="line-1-7"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-23ea3bcd4b57c8e84cc5cb7e97b05db79612904e" lang="en"><span class="line"><span class="anchor" id="line-1-8"></span><span class="ID">A</span> = <span class="ID">eye</span>(<span class="Number">1000</span>)</span>
<span class="line"><span class="anchor" id="line-2-4"></span><span class="ID">Asp</span> = <span class="ID">sparse</span>.<span class="ID">lil_matrix</span>(<span class="ID">A</span>)</span>
</pre></div></div><span class="anchor" id="line-100"></span><p class="line874">A faster method: <span class="anchor" id="line-101"></span><span class="anchor" id="line-102"></span><span class="anchor" id="line-103"></span><span class="anchor" id="line-104"></span><span class="anchor" id="line-1-9"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-6c2f6a7bda2aed3cf4dcc8ac3e683f57fa6b5326" lang="en"><span class="line"><span class="anchor" id="line-1-10"></span><span class="ID">Asp</span> = <span class="ID">sparse</span>.<span class="ID">lil_matrix</span>((<span class="Number">1000</span>,<span class="Number">1000</span>))</span>
<span class="line"><span class="anchor" id="line-2-5"></span><span class="ID">Asp</span>.<span class="ID">setdiag</span>(<span class="ID">ones</span>(<span class="Number">1000</span>))</span>
</pre></div></div><span class="anchor" id="line-105"></span><p class="line862">Note that <tt class="backtick">Asp</tt> is still in <strong>LI</strong>nked <strong>L</strong>ist (<tt class="backtick">lil_matrix</tt>) format - <span class="anchor" id="line-106"></span>leave it like that for now. <span class="anchor" id="line-107"></span><span class="anchor" id="line-108"></span><p class="line862">Now create vector <tt class="backtick">b</tt>; we choose the entries so that we can easily check the (trivial) <span class="anchor" id="line-109"></span>solution: <span class="anchor" id="line-110"></span><span class="anchor" id="line-111"></span><span class="anchor" id="line-112"></span><span class="anchor" id="line-1-11"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-543b7cca583a04f11a11ba297e3b601fc6d235cd" lang="en"><span class="line"><span class="anchor" id="line-1-12"></span><span class="ID">b</span> = <span class="ID">arange</span>(<span class="Number">1</span>,<span class="Number">1001</span>)</span>
</pre></div></div><span class="anchor" id="line-113"></span><p class="line862">To see what <tt class="backtick">b</tt> looks like, type <tt class="backtick">b</tt> or <tt class="backtick">print&nbsp;b</tt> at your prompt. <span class="anchor" id="line-114"></span><span class="anchor" id="line-115"></span><p class="line862">Now let's solve <tt class="backtick">Ax&nbsp;=&nbsp;b</tt>, first using <tt class="backtick">A</tt>... <span class="anchor" id="line-116"></span><span class="anchor" id="line-117"></span><span class="anchor" id="line-118"></span><span class="anchor" id="line-1-13"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-b4bd334e8ce66454d16e3be2145dea3f6e4cc51c" lang="en"><span class="line"><span class="anchor" id="line-1-14"></span><span class="ID">x</span> = <span class="ID">linalg</span>.<span class="ID">solve</span>(<span class="ID">A</span>,<span class="ID">b</span>)</span>
</pre></div></div><span class="anchor" id="line-119"></span><p class="line862">... and now using <tt class="backtick">Asp</tt>: <span class="anchor" id="line-120"></span><span class="anchor" id="line-121"></span><span class="anchor" id="line-122"></span><span class="anchor" id="line-1-15"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-537f6b04f6a18bbed0a3b646e4c7d76a96ee55f6" lang="en"><span class="line"><span class="anchor" id="line-1-16"></span><span class="ID">xsp</span> = <span class="ID">linsolve</span>.<span class="ID">spsolve</span>(<span class="ID">Asp</span>,<span class="ID">b</span>)</span>
</pre></div></div><span class="anchor" id="line-123"></span><p class="line862">Check the result: <tt class="backtick">x</tt> and <tt class="backtick">xsp</tt> should both be equal to <tt class="backtick">b</tt>, as one expects. A convenient <span class="anchor" id="line-124"></span>way of checking this is to make use of <tt class="backtick">allclose()</tt>. In IPython you can type <tt class="backtick">allclose?</tt> <span class="anchor" id="line-125"></span>to get help on it, and at the Python prompt one will type <tt class="backtick">help(allclose)</tt> (this is the <span class="anchor" id="line-126"></span>case for almost all commands, but some might not have a <strong>Docstring</strong>). The input and <span class="anchor" id="line-127"></span>resulting output from the command is shown here: <span class="anchor" id="line-128"></span><span class="anchor" id="line-129"></span><span class="anchor" id="line-130"></span><span class="anchor" id="line-131"></span><span class="anchor" id="line-132"></span><span class="anchor" id="line-133"></span><span class="anchor" id="line-1-17"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-72297ffc20d8e248bff3c0b9ea833063161bb1b9" lang="en"><span class="line"><span class="anchor" id="line-1-18"></span>&gt;&gt;&gt; <span class="ID">allclose</span>(<span class="ID">x</span>,<span class="ID">b</span>)</span>
<span class="line"><span class="anchor" id="line-2-6"></span><span class="ResWord">True</span></span>
<span class="line"><span class="anchor" id="line-3-2"></span>&gt;&gt;&gt; <span class="ID">allclose</span>(<span class="ID">b</span>,<span class="ID">xsp</span>)</span>
<span class="line"><span class="anchor" id="line-4-2"></span><span class="ResWord">True</span></span>
</pre></div></div><span class="anchor" id="line-134"></span><span class="anchor" id="line-135"></span><p class="line874">Let's have a look at the difference in solution time between the two methods. In an <span class="anchor" id="line-136"></span>IPython session, simply type (or scroll back with your arrow keys and just insert <span class="anchor" id="line-137"></span>the <tt class="backtick">time</tt> in front): <span class="anchor" id="line-138"></span><span class="anchor" id="line-139"></span><span class="anchor" id="line-140"></span><span class="anchor" id="line-141"></span><span class="anchor" id="line-1-19"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-c10495bf6c7122430633bf262ea8f1a12e424bd9" lang="en"><span class="line"><span class="anchor" id="line-1-20"></span><span class="ID">time</span> <span class="ID">x</span> = <span class="ID">linalg</span>.<span class="ID">solve</span>(<span class="ID">A</span>,<span class="ID">b</span>)</span>
<span class="line"><span class="anchor" id="line-2-7"></span><span class="ID">Itime</span> <span class="ID">xsp1</span> = <span class="ID">linsolve</span>.<span class="ID">spsolve</span>(<span class="ID">Asp</span>,<span class="ID">b</span>)</span>
</pre></div></div><span class="anchor" id="line-142"></span><p class="line874">You should see a significant difference (roughly 5 to 6 times faster). <span class="anchor" id="line-143"></span><span class="anchor" id="line-144"></span><p class="line874">If you're working in the normal Python shell instead, do the following: <span class="anchor" id="line-145"></span><span class="anchor" id="line-146"></span><span class="anchor" id="line-147"></span><span class="anchor" id="line-148"></span><span class="anchor" id="line-149"></span><span class="anchor" id="line-1-21"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-ece93d04d04240927afe5a9e1acda4e470008e37" lang="en"><span class="line"><span class="anchor" id="line-1-22"></span><span class="ResWord">from</span> <span class="ID">time</span> <span class="ResWord">import</span> <span class="ID">time</span></span>
<span class="line"><span class="anchor" id="line-2-8"></span><span class="ID">t</span>=<span class="ID">time</span>(); <span class="ID">x</span> = <span class="ID">linalg</span>.<span class="ID">solve</span>(<span class="ID">A</span>,<span class="ID">b</span>); <span class="ID">time</span>()-<span class="ID">t</span></span>
<span class="line"><span class="anchor" id="line-3-3"></span><span class="ID">t</span>=<span class="ID">time</span>(); <span class="ID">xsp1</span> = <span class="ID">linsolve</span>.<span class="ID">spsolve</span>(<span class="ID">Asp</span>,<span class="ID">b</span>); <span class="ID">time</span>()-<span class="ID">t</span></span>
</pre></div></div><span class="anchor" id="line-150"></span><span class="anchor" id="line-151"></span><p class="line862">We saw that we can get the solution to <tt class="backtick">Ax&nbsp;=&nbsp;b</tt> even if <tt class="backtick">A</tt> is in <strong>LIL</strong> format. <span class="anchor" id="line-152"></span>We'll now inspect the difference in execution speed for the following (assuming <span class="anchor" id="line-153"></span>that you're using IPython, <tt class="backtick">Out&nbsp;[x]:</tt>'s not shown, and in a new session): <span class="anchor" id="line-154"></span><span class="anchor" id="line-155"></span><span class="anchor" id="line-156"></span><span class="anchor" id="line-157"></span><span class="anchor" id="line-158"></span><span class="anchor" id="line-159"></span><span class="anchor" id="line-160"></span><span class="anchor" id="line-161"></span><span class="anchor" id="line-162"></span><span class="anchor" id="line-163"></span><span class="anchor" id="line-164"></span><span class="anchor" id="line-165"></span><span class="anchor" id="line-166"></span><span class="anchor" id="line-167"></span><span class="anchor" id="line-1-23"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-9ea7641e7937105e7567c4dac713218ab6f41d7a" lang="en"><span class="line"><span class="anchor" id="line-1-24"></span><span class="ResWord">from</span> <span class="ID">numpy</span> <span class="ResWord">import</span> <span class="ID">allclose</span>, <span class="ID">arange</span>, <span class="ID">eye</span>, <span class="ID">linalg</span>, <span class="ID">random</span>, <span class="ID">ones</span></span>
<span class="line"><span class="anchor" id="line-2-9"></span><span class="ResWord">from</span> <span class="ID"><strong class="highlight">scipy</strong></span> <span class="ResWord">import</span> <span class="ID">linsolve</span>, <span class="ID">sparse</span></span>
<span class="line"><span class="anchor" id="line-3-4"></span><span class="ID">Asp</span> = <span class="ID">sparse</span>.<span class="ID">lil_matrix</span>((<span class="Number">50000</span>,<span class="Number">50000</span>))</span>
<span class="line"><span class="anchor" id="line-4-3"></span><span class="ID">Asp</span>.<span class="ID">setdiag</span>(<span class="ID">ones</span>(<span class="Number">50000</span>))</span>
<span class="line"><span class="anchor" id="line-5-2"></span><span class="ID">Asp</span>[<span class="Number">20</span>,<span class="Number">100</span>:<span class="Number">250</span>] = <span class="Number">10</span>*<span class="ID">random</span>.<span class="ID">rand</span>(<span class="Number">150</span>)</span>
<span class="line"><span class="anchor" id="line-6-2"></span><span class="ID">Asp</span>[<span class="Number">200</span>:<span class="Number">250</span>,<span class="Number">30</span>] = <span class="Number">10</span>*<span class="ID">random</span>.<span class="ID">rand</span>(<span class="Number">50</span>)</span>
<span class="line"><span class="anchor" id="line-7-2"></span><span class="ID">b</span> = <span class="ID">arange</span>(<span class="Number">0</span>,<span class="Number">50000</span>)</span>
<span class="line"><span class="anchor" id="line-8-2"></span><span class="ID">time</span> <span class="ID">xsp1</span> = <span class="ID">linsolve</span>.<span class="ID">spsolve</span>(<span class="ID">Asp</span>,<span class="ID">b</span>)</span>
<span class="line"><span class="anchor" id="line-9-2"></span><span class="ID">time</span> <span class="ID">xsp2</span> = <span class="ID">linsolve</span>.<span class="ID">spsolve</span>(<span class="ID">Asp</span>.<span class="ID">tocsc</span>(),<span class="ID">b</span>)</span>
<span class="line"><span class="anchor" id="line-10-1"></span><span class="ID">time</span> <span class="ID">xsp3</span> = <span class="ID">linsolve</span>.<span class="ID">spsolve</span>(<span class="ID">Asp</span>.<span class="ID">tocsr</span>(),<span class="ID">b</span>)</span>
<span class="line"><span class="anchor" id="line-11-1"></span><span class="ID">allclose</span>(<span class="ID">xsp1</span>,<span class="ID">xsp2</span>) <span class="Comment"># Should be True</span></span>
<span class="line"><span class="anchor" id="line-12-1"></span><span class="ID">allclose</span>(<span class="ID">xsp2</span>,<span class="ID">xsp3</span>) <span class="Comment"># Should be True</span></span>
</pre></div></div><span class="anchor" id="line-168"></span><p class="line867"><strong>Note</strong>: the line that returns xsp3 fails if you don't have a recent enough  <span class="anchor" id="line-169"></span>version of <strong class="highlight">scipy</strong>. <span class="anchor" id="line-170"></span><span class="anchor" id="line-171"></span><p class="line862">The time for the last solution (<tt class="backtick">xsp3</tt>) should be the fastest by a factor of <span class="anchor" id="line-172"></span>roughly 1,5 to 2 times compared to the other two solutions (<tt class="backtick">xsp1</tt> and <tt class="backtick">xsp2</tt>). The <span class="anchor" id="line-173"></span>benefit in speed when compared to using 'normal' methods for solving <span class="anchor" id="line-174"></span>sparse systems is obvious. <span class="anchor" id="line-175"></span><span class="anchor" id="line-176"></span><span class="anchor" id="line-177"></span><p class="line867">
<h3 id="Example_2">Example 2</h3>
<span class="anchor" id="line-178"></span><span class="anchor" id="line-179"></span><p class="line862">Construct a 1000x1000 <tt class="backtick">lil_matrix</tt> and add some values to it: <span class="anchor" id="line-180"></span><span class="anchor" id="line-181"></span><span class="anchor" id="line-182"></span><span class="anchor" id="line-183"></span><span class="anchor" id="line-184"></span><span class="anchor" id="line-185"></span><span class="anchor" id="line-186"></span><span class="anchor" id="line-187"></span><span class="anchor" id="line-1-25"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-e0c19044ef79a09946b890c9a752ff5ae0b8ce86" lang="en"><span class="line"><span class="anchor" id="line-1-26"></span><span class="ResWord">from</span> <span class="ID"><strong class="highlight">scipy</strong></span> <span class="ResWord">import</span> <span class="ID">sparse</span>, <span class="ID">linsolve</span></span>
<span class="line"><span class="anchor" id="line-2-10"></span><span class="ResWord">from</span> <span class="ID">numpy</span> <span class="ResWord">import</span> <span class="ID">random</span>, <span class="ID">linalg</span></span>
<span class="line"><span class="anchor" id="line-3-5"></span><span class="ID">A</span> = <span class="ID">sparse</span>.<span class="ID">lil_matrix</span>((<span class="Number">1000</span>, <span class="Number">1000</span>))</span>
<span class="line"><span class="anchor" id="line-4-4"></span><span class="ID">A</span>[<span class="Number">0</span>, :<span class="Number">100</span>] = <span class="ID">random</span>.<span class="ID">rand</span>(<span class="Number">100</span>)</span>
<span class="line"><span class="anchor" id="line-5-3"></span><span class="ID">A</span>[<span class="Number">1</span>, <span class="Number">100</span>:<span class="Number">200</span>] = <span class="ID">A</span>[<span class="Number">0</span>, :<span class="Number">100</span>]</span>
<span class="line"><span class="anchor" id="line-6-3"></span><span class="ID">A</span>.<span class="ID">setdiag</span>(<span class="ID">random</span>.<span class="ID">rand</span>(<span class="Number">1000</span>))</span>
</pre></div></div><span class="anchor" id="line-188"></span><p class="line874">Now convert it to CSR format and solve (A A^T) x = b for x: <span class="anchor" id="line-189"></span><span class="anchor" id="line-190"></span><span class="anchor" id="line-191"></span><span class="anchor" id="line-192"></span><span class="anchor" id="line-193"></span><span class="anchor" id="line-1-27"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-a1083164d6d3d0e12784d297c01b9f5e3eb5f261" lang="en"><span class="line"><span class="anchor" id="line-1-28"></span><span class="ID">A</span> = <span class="ID">A</span>.<span class="ID">tocsr</span>()</span>
<span class="line"><span class="anchor" id="line-2-11"></span><span class="ID">b</span> = <span class="ID">random</span>.<span class="ID">rand</span>(<span class="Number">1000</span>)</span>
<span class="line"><span class="anchor" id="line-3-6"></span><span class="ID">x</span> = <span class="ID">linsolve</span>.<span class="ID">spsolve</span>(<span class="ID">A</span> * <span class="ID">A</span>.<span class="ID">T</span>, <span class="ID">b</span>)</span>
</pre></div></div><span class="anchor" id="line-194"></span><ul><li style="list-style-type:none"><p class="line862">The <tt class="backtick">.T</tt> bit of <tt class="backtick">A.T</tt> above computes the transpose of <tt class="backtick">A</tt>, i.e., it's a shortcut for <tt class="backtick">A.transpose()</tt>. <span class="anchor" id="line-195"></span>It will also work for 'normal' dense (numpy) matrices and currently works for arrays in the latest SVN versions of NumPy. <span class="anchor" id="line-196"></span>Also take note of the differences between matrices and arrays when working with them. If <tt class="backtick">B</tt> is a matrix and <tt class="backtick">C</tt> <span class="anchor" id="line-197"></span>an array, both with the same size and entries, then <tt class="backtick">B*B</tt> is <strong>not</strong> the same as <tt class="backtick">C*C</tt>. <span class="anchor" id="line-198"></span>See <a href="../NumPy_for_Matlab_Users.html">NumPy_for_Matlab_Users</a> for more details. <span class="anchor" id="line-199"></span><span class="anchor" id="line-200"></span></li></ul><p class="line874">Convert it to a dense matrix and solve, and check that the result is the same: <span class="anchor" id="line-201"></span><span class="anchor" id="line-202"></span><span class="anchor" id="line-203"></span><span class="anchor" id="line-204"></span><span class="anchor" id="line-205"></span><span class="anchor" id="line-1-29"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-1462a84cd25265ebae5b932158be1eed84fa0a16" lang="en"><span class="line"><span class="anchor" id="line-1-30"></span><span class="ID">A_</span> = <span class="ID">A</span>.<span class="ID">todense</span>()</span>
<span class="line"><span class="anchor" id="line-2-12"></span><span class="ID">x_</span> = <span class="ID">linalg</span>.<span class="ID">solve</span>(<span class="ID">A_</span> * <span class="ID">A_</span>.<span class="ID">T</span>, <span class="ID">b</span>)</span>
<span class="line"><span class="anchor" id="line-3-7"></span><span class="ID">err</span> = <span class="ID">linalg</span>.<span class="ID">norm</span>(<span class="ID">x</span>-<span class="ID">x_</span>)</span>
</pre></div></div><span class="anchor" id="line-206"></span><p class="line874">Now we can print the error norm with: <span class="anchor" id="line-207"></span><span class="anchor" id="line-208"></span><span class="anchor" id="line-209"></span><span class="anchor" id="line-1-31"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-c4a582625f068ae7c170e4d7bbd2922be975a8ad" lang="en"><span class="line"><span class="anchor" id="line-1-32"></span><span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">Norm error =</span><span class="String">&quot;</span>, <span class="ID">err</span></span>
</pre></div></div><span class="anchor" id="line-210"></span><p class="line862">It should be small <img alt=":)" height="15" src="../moin_static197/modern/img/smile.png" title=":)" width="15" /> <span class="anchor" id="line-211"></span><span class="anchor" id="line-212"></span><span class="anchor" id="line-213"></span><p class="line867">
<h2 id="Numerical_integration">Numerical integration</h2>
<span class="anchor" id="line-214"></span><span class="anchor" id="line-215"></span><p class="line862">Suppose we have a function, f(x), whose integral we want to evaluate. Often it is necessary to do this numerically. <a href="../SciPy.html"><strong class="highlight">SciPy</strong></a> provides tools to do this, in the <strong class="highlight">scipy</strong>.integrate module: <span class="anchor" id="line-216"></span><span class="anchor" id="line-217"></span><span class="anchor" id="line-218"></span><span class="anchor" id="line-219"></span><span class="anchor" id="line-220"></span><span class="anchor" id="line-1-33"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-21dff1467a7e0669c954983c9240ebfe08e9a95b" lang="en"><span class="line"><span class="anchor" id="line-1-34"></span>&gt;&gt;&gt; <span class="ResWord">from</span> <span class="ID"><strong class="highlight">scipy</strong>.integrate</span> <span class="ResWord">import</span> <span class="ID">quad</span></span>
<span class="line"><span class="anchor" id="line-2-13"></span>&gt;&gt;&gt; <span class="ID">quad</span>(<span class="ResWord">lambda</span> <span class="ID">x</span>: <span class="ID">x</span>**<span class="Number">2</span>, <span class="Number">0</span>, <span class="Number">1</span>)</span>
<span class="line"><span class="anchor" id="line-3-8"></span>(<span class="Number">0.33333333333333331</span>, <span class="Number">3.7007434154171879e-15</span>)</span>
</pre></div></div><span class="anchor" id="line-221"></span><p class="line874">The correct answer is of course 1/3. quad returns a tuple consisting of its result and its estimate of the error in its result. In this case we can see that its estimate is pretty good. <span class="anchor" id="line-222"></span><span class="anchor" id="line-223"></span><p class="line874">For a slightly more difficult example, let's integrate a function (related to) the blackbody spectrum: <span class="anchor" id="line-224"></span><span class="anchor" id="line-225"></span><span class="anchor" id="line-226"></span><span class="anchor" id="line-227"></span><span class="anchor" id="line-1-35"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-e13a1a418acc04473c257f7749b8da0dcabb695a" lang="en"><span class="line"><span class="anchor" id="line-1-36"></span>&gt;&gt;&gt; <span class="ID">quad</span>(<span class="ResWord">lambda</span> <span class="ID">x</span>: <span class="ID">x</span>**<span class="Number">3</span>/(<span class="ID">exp</span>(<span class="ID">x</span>)-<span class="Number">1</span>), <span class="Number">0.1</span>, <span class="Number">10</span>)</span>
<span class="line"><span class="anchor" id="line-2-14"></span>(<span class="Number">6.431600896801668</span>, <span class="Number">6.1280827858943929e-09</span>)</span>
</pre></div></div><span class="anchor" id="line-228"></span><p class="line874">Here we see that its error estimate is worse. <span class="anchor" id="line-229"></span><span class="anchor" id="line-230"></span><p class="line874">If we want to carry the integration to infinity, we can use the variable &quot;inf&quot; to indicate this: <span class="anchor" id="line-231"></span><span class="anchor" id="line-232"></span><span class="anchor" id="line-233"></span><span class="anchor" id="line-234"></span><span class="anchor" id="line-235"></span><span class="anchor" id="line-1-37"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-10ccbd1dc25eff02267669c855a02586d326978f" lang="en"><span class="line"><span class="anchor" id="line-1-38"></span>&gt;&gt;&gt; <span class="ResWord">from</span> <span class="ID"><strong class="highlight">scipy</strong>.integrate</span> <span class="ResWord">import</span> <span class="ID">inf</span></span>
<span class="line"><span class="anchor" id="line-2-15"></span>&gt;&gt;&gt; <span class="ID">quad</span>(<span class="ResWord">lambda</span> <span class="ID">x</span>: <span class="ID">x</span>**<span class="Number">3</span>/(<span class="ID">exp</span>(<span class="ID">x</span>)-<span class="Number">1</span>), <span class="Number">0.1</span>, <span class="ID">inf</span>)</span>
<span class="line"><span class="anchor" id="line-3-9"></span>(<span class="Number">6.4936184022866668</span>, <span class="Number">2.3462101939733651e-09</span>)</span>
</pre></div></div><span class="anchor" id="line-236"></span><span class="anchor" id="line-237"></span><p class="line874">The fact that the integrand can't be evaluated at zero doesn't seem to be a problem either: <span class="anchor" id="line-238"></span><span class="anchor" id="line-239"></span><span class="anchor" id="line-240"></span><span class="anchor" id="line-241"></span><span class="anchor" id="line-1-39"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-5b469fc27d772834c2e8f0d172de19fce0d43db5" lang="en"><span class="line"><span class="anchor" id="line-1-40"></span>&gt;&gt;&gt; <span class="ID">quad</span>(<span class="ResWord">lambda</span> <span class="ID">x</span>: <span class="ID">x</span>**<span class="Number">3</span>/(<span class="ID">exp</span>(<span class="ID">x</span>)-<span class="Number">1</span>), <span class="Number">0</span>, <span class="ID">inf</span>)</span>
<span class="line"><span class="anchor" id="line-2-16"></span>(<span class="Number">6.4939394022668298</span>, <span class="Number">2.6284709859300214e-09</span>)</span>
</pre></div></div><span class="anchor" id="line-242"></span><span class="anchor" id="line-243"></span><p class="line874">Under the hood, quad uses a sophisticated method (&quot;Clenshaw-Curtis with Chebyshev moments&quot;) from the FORTRAN package QUADPACK which attempts to efficiently compute which regions contain complicated behaviour and spends more effort evaluating the function there. It can be tricked: <span class="anchor" id="line-244"></span><span class="anchor" id="line-245"></span><span class="anchor" id="line-246"></span><span class="anchor" id="line-247"></span><span class="anchor" id="line-1-41"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-b4661e97166b5e1f51382ba0236dbc252f0245bd" lang="en"><span class="line"><span class="anchor" id="line-1-42"></span>&gt;&gt;&gt; <span class="ID">quad</span>(<span class="ResWord">lambda</span> <span class="ID">t</span>: <span class="Number">1e5</span>*((<span class="Number">1e5</span>*<span class="ID">t</span>)**<span class="Number">3</span>/(<span class="ID">exp</span>(<span class="Number">1e5</span>*<span class="ID">t</span>)-<span class="Number">1</span>)), <span class="Number">0</span>, <span class="ID">inf</span>)</span>
<span class="line"><span class="anchor" id="line-2-17"></span>(<span class="Number">6.043084404980975e-84</span>, <span class="Number">1.1947568723196904e-83</span>)</span>
</pre></div></div><span class="anchor" id="line-248"></span><p class="line874">Here all I have done is a change of variable t=x*1e-5, so the value of the integral should not have changed at all, but unfortunately quad fails to find the peak of the function, so it gives a wildly wrong answer with a wildly wrong error estimate. <span class="anchor" id="line-249"></span><span class="anchor" id="line-250"></span><p class="line867">
<h2 id="Integrating_ODEs">Integrating ODEs</h2>
<span class="anchor" id="line-251"></span><span class="anchor" id="line-252"></span><p class="line874"><strong class="highlight">Scipy</strong> includes several robust ODE solvers. Let's take the simplest possible example and integrate the equation y'=y: <span class="anchor" id="line-253"></span><span class="anchor" id="line-254"></span><span class="anchor" id="line-255"></span><span class="anchor" id="line-256"></span><span class="anchor" id="line-257"></span><span class="anchor" id="line-258"></span><span class="anchor" id="line-1-43"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-ecd25a304f0e89e447f1d6ecbd43922c8298dfa8" lang="en"><span class="line"><span class="anchor" id="line-1-44"></span>&gt;&gt;&gt; <span class="ResWord">from</span> <span class="ID"><strong class="highlight">scipy</strong>.integrate</span> <span class="ResWord">import</span> <span class="ID">odeint</span></span>
<span class="line"><span class="anchor" id="line-2-18"></span>&gt;&gt;&gt; <span class="ID">odeint</span>(<span class="ResWord">lambda</span> <span class="ID">y</span>, <span class="ID">t</span>: <span class="ID">y</span>, <span class="Number">1</span>, [<span class="Number">0</span>, <span class="Number">1</span>])</span>
<span class="line"><span class="anchor" id="line-3-10"></span><span class="ID">array</span>([[ <span class="Number">1.</span>        ],</span>
<span class="line"><span class="anchor" id="line-4-5"></span>       [ <span class="Number">2.71828193</span>]])</span>
</pre></div></div><span class="anchor" id="line-259"></span><p class="line874">Here we provided odeint with a function that computes y' given y and t - in this case we used an anonymous python function, but any function will do. We also provided it with an initial value of y (1) and the initial and final values of t (0 and 1). We then obtained the result evaluated at those times (1 and e, as we would expect). To get more values: <span class="anchor" id="line-260"></span><span class="anchor" id="line-261"></span><span class="anchor" id="line-262"></span><span class="anchor" id="line-263"></span><span class="anchor" id="line-264"></span><span class="anchor" id="line-265"></span><span class="anchor" id="line-266"></span><span class="anchor" id="line-267"></span><span class="anchor" id="line-268"></span><span class="anchor" id="line-269"></span><span class="anchor" id="line-270"></span><span class="anchor" id="line-271"></span><span class="anchor" id="line-272"></span><span class="anchor" id="line-273"></span><span class="anchor" id="line-1-45"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-758ec3b0fcb7c26eda9c94dcc040bd02d74aff22" lang="en"><span class="line"><span class="anchor" id="line-1-46"></span>&gt;&gt;&gt; <span class="ResWord">import</span> <span class="ID">numpy</span> <span class="ResWord">as</span> <span class="ID">N</span></span>
<span class="line"><span class="anchor" id="line-2-19"></span>&gt;&gt;&gt; <span class="ID">odeint</span>(<span class="ResWord">lambda</span> <span class="ID">y</span>, <span class="ID">t</span>: <span class="ID">y</span>, <span class="Number">1</span>, <span class="ID">N</span>.<span class="ID">linspace</span>(<span class="Number">0</span>,<span class="Number">1</span>,<span class="Number">10</span>))</span>
<span class="line"><span class="anchor" id="line-3-11"></span><span class="ID">array</span>([[ <span class="Number">1.</span>        ],</span>
<span class="line"><span class="anchor" id="line-4-6"></span>       [ <span class="Number">1.11751906</span>],</span>
<span class="line"><span class="anchor" id="line-5-4"></span>       [ <span class="Number">1.24884886</span>],</span>
<span class="line"><span class="anchor" id="line-6-4"></span>       [ <span class="Number">1.39561243</span>],</span>
<span class="line"><span class="anchor" id="line-7-3"></span>       [ <span class="Number">1.55962349</span>],</span>
<span class="line"><span class="anchor" id="line-8-3"></span>       [ <span class="Number">1.742909</span>  ],</span>
<span class="line"><span class="anchor" id="line-9-3"></span>       [ <span class="Number">1.94773405</span>],</span>
<span class="line"><span class="anchor" id="line-10-2"></span>       [ <span class="Number">2.17663003</span>],</span>
<span class="line"><span class="anchor" id="line-11-2"></span>       [ <span class="Number">2.43242551</span>],</span>
<span class="line"><span class="anchor" id="line-12-2"></span>       [ <span class="Number">2.7182819</span> ]])</span>
</pre></div></div><span class="anchor" id="line-274"></span><p class="line862">What about second-order differential equations? Well, the standard technique is to rewrite these as coupled first-order differential equations. Let's try integrating y<em>=-y. We begin by introducing a variable yp, so that yp = y'. Then yp' = y</em> = -y. <span class="anchor" id="line-275"></span><span class="anchor" id="line-276"></span><span class="anchor" id="line-277"></span><span class="anchor" id="line-278"></span><span class="anchor" id="line-279"></span><span class="anchor" id="line-280"></span><span class="anchor" id="line-281"></span><span class="anchor" id="line-282"></span><span class="anchor" id="line-283"></span><span class="anchor" id="line-284"></span><span class="anchor" id="line-1-47"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en"><pre dir="ltr" id="CA-94649e8881c47e9e2d2387863272709847430af5" lang="en"><span class="line"><span class="anchor" id="line-1-48"></span>&gt;&gt;&gt; <span class="ResWord">def</span> <span class="ID">deriv</span>(<span class="ID">Y</span>, <span class="ID">t</span>):</span>
<span class="line"><span class="anchor" id="line-2-20"></span>...    <span class="ID">y</span>, <span class="ID">yp</span> = <span class="ID">Y</span></span>
<span class="line"><span class="anchor" id="line-3-12"></span>...    <span class="ResWord">return</span> <span class="ID">yp</span>, -<span class="ID">y</span></span>
<span class="line"><span class="anchor" id="line-4-7"></span>...</span>
<span class="line"><span class="anchor" id="line-5-5"></span>&gt;&gt;&gt; <span class="ID">odeint</span>(<span class="ID">deriv</span>, [<span class="Number">1</span>,<span class="Number">0</span>], [<span class="Number">0</span>,<span class="ID">N</span>.<span class="ID">pi</span>,<span class="Number">2</span>*<span class="ID">N</span>.<span class="ID">pi</span>])</span>
<span class="line"><span class="anchor" id="line-6-5"></span><span class="ID">array</span>([[  <span class="Number">1.00000000e+00</span>,   <span class="Number">0.00000000e+00</span>],</span>
<span class="line"><span class="anchor" id="line-7-4"></span>       [ -<span class="Number">9.99999975e-01</span>,  -<span class="Number">1.26160610e-07</span>],</span>
<span class="line"><span class="anchor" id="line-8-4"></span>       [  <span class="Number">1.00000003e+00</span>,   <span class="Number">1.47819759e-07</span>]])</span>
</pre></div></div><span class="anchor" id="line-285"></span><p class="line874">Here we see that the solution is behaving like cos(t), as we would have hoped. There is a certain amount of error; the error tolerance is one of the many things that can be adjusted with extra parameters to odeint.  <span class="anchor" id="line-286"></span><span class="anchor" id="line-287"></span><p class="line867">
<h1 id="Older_SciPy_Tutorial">Older <strong class="highlight">SciPy</strong> Tutorial</h1>
<span class="anchor" id="line-288"></span><span class="anchor" id="line-289"></span><p class="line874">Seems like people are planning to put a new online tutorial here. <span class="anchor" id="line-290"></span><span class="anchor" id="line-291"></span><p class="line862">Until they do, you can use <a class="http" href="../../external.html?link=http://www.tau.ac.il/~kineret/amit/scipy_tutorial/">this link</a>, which is a direct conversion of Travis Oliphant's original <a class="http" href="../../external.html?link=http://www.lyx.org/">LyX</a> document (usually available in <a class="http" href="../../external.html?link=http://www.scipy.org/Wiki/Documentation?action=AttachFile&amp;do=get&amp;target=scipy_tutorial.pdf">pdf format</a>) to html. <span class="anchor" id="line-292"></span><span class="anchor" id="line-293"></span><p class="line862">This html tutorial was created using a simple <a class="http" href="../../external.html?link=http://www.cse.ohio-state.edu/~gurari/TeX4ht/mn.html">htlatex</a> command in the tutorial source directory of the &quot;old <strong class="highlight">scipy</strong>&quot; branch - available <a class="http" href="../../external.html?link=http://projects.scipy.org/scipy/scipy/browser/branches/oldscipy/tutorial">here</a> <span class="anchor" id="line-294"></span><span class="anchor" id="line-295"></span><p class="line862">The resulting files are available as one archived file: <a class="http" href="../../external.html?link=http://www.tau.ac.il/~kineret/amit/scipy_tutorial.tar.gz"><strong class="highlight">scipy</strong>_tutorial.tar.gz</a>. <span class="anchor" id="line-296"></span><span class="anchor" id="line-297"></span><p class="line862">The original document was written by <a href="../TravisOliphant.html">TravisOliphant</a>. I think it's copyrighted to Enthought under the following <a class="http" href="../../external.html?link=http://www.tau.ac.il/~kineret/amit/scipy_tutorial/LICENSE.txt">license</a>. <span class="anchor" id="line-298"></span><span class="anchor" id="line-299"></span><p class="line874">If you think it's useful, and wish to host it elsewhere, please do, because the current place is temporary and I don't intend to keep it forever. <span class="anchor" id="line-300"></span><span class="anchor" id="line-301"></span><p class="line862">-- <a class="nonexistent" href="../AmitAronovitch.html">AmitAronovitch</a> 2006-02-17 22:58:57 <span class="anchor" id="line-302"></span><span class="anchor" id="bottom"></span></div><p id="pageinfo" class="info" lang="en" dir="ltr">SciPy: Additional_Documentation/New_SciPy_Tutorial  (last edited 2015-10-24 17:48:25 by <span title="">anonymous</span>)</p>

<div id="pagebottom"></div>
</div>


<div id="footer">
<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="New_SciPy_Tutorial37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../../external.html?link=http://localhost:8080/Additional_Documentation/New_SciPy_Tutorial">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

<ul id="credits">
<li><a href="../../external.html?link=http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="../../external.html?link=http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="../../external.html?link=http://moinmo.in/GPL" title="MoinMoin is GPL licensed.">GPL licensed</a></li><li><a href="../../external.html?link=http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li>
</ul>


</div>
</body>

<!-- Mirrored from localhost:8080/Additional_Documentation/New_SciPy_Tutorial?highlight=%28%28SciPy%29%29 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 23:20:10 GMT -->
</html>

