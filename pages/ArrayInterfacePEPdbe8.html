<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<!-- Mirrored from localhost:8080/ArrayInterfacePEP?action=recoverpass by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 23:17:38 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="edit_on_doubleclick" content="/">
<meta name="robots" content="noindex,nofollow">

<title>ArrayInterfacePEP - SciPy wiki dump</title>
<script type="text/javascript" src="moin_static197/common/js/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="moin_static197/modern/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="moin_static197/modern/css/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="moin_static197/modern/css/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="moin_static197/modern/css/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static197/modern/css/msie.css">
<![endif]-->


<link rel="alternate" title="SciPy: ArrayInterfacePEP" href="../external.html?link=http://localhost:8080/ArrayInterfacePEP?diffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=ArrayInterfacePEP&amp;ddiffs=1" type="application/rss+xml">


<link rel="Start" href="AllPages.html">
<link rel="Alternate" title="Wiki Markup" href="../external.html?link=http://localhost:8080/ArrayInterfacePEP?action=raw">
<link rel="Alternate" media="print" title="Print View" href="../external.html?link=http://localhost:8080/ArrayInterfacePEP?action=print">
<link rel="Search" href="FindPage.html">
<link rel="Index" href="TitleIndex.html">
<link rel="Glossary" href="WordIndex.html">
<link rel="Help" href="HelpOnFormatting.html">
</head>

<body  lang="en" dir="ltr"><div style="background: white; padding:2em;">This is an archival dump of old wiki content --- see <a href="http://scipy.org/">scipy.org</a> for current material</div>

<div id="header">


<form id="searchform" method="get" action="../external.html?link=http://localhost:8080/ArrayInterfacePEP">
<div>
<input type="hidden" name="action" value="fullsearch">
<input type="hidden" name="context" value="180">
<label for="searchinput">Search:</label>
<input id="searchinput" type="text" name="value" value="" size="20"
    onfocus="searchFocus(this)" onblur="searchBlur(this)"
    onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search">
<input id="titlesearch" name="titlesearch" type="submit"
    value="Titles" alt="Search Titles">
<input id="fullsearch" name="fullsearch" type="submit"
    value="Text" alt="Search Full Text">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<ul id="username"><li><a href="ArrayInterfacePEP456e.html?action=login" id="login" rel="nofollow">Login</a></li></ul>
<div id="locationline">
<div id="interwiki"><span><a href="AllPages.html" rel="nofollow">SciPy</a></span></div>

<ul id="pagelocation">
<li><a class="backlink" href="AllPagesa4e6.html?action=fullsearch&amp;context=180&amp;value=linkto%3A%22ArrayInterfacePEP%22" rel="nofollow" title="Click to do a full-text search for this title">ArrayInterfacePEP</a></li>
</ul>

</div>


<ul id="navibar">
<li class="wikilink"><a href="RecentChanges.html">RecentChanges</a></li><li class="wikilink"><a class="nonexistent" href="FindPage.html">FindPage</a></li><li class="wikilink"><a class="nonexistent" href="HelpContents.html">HelpContents</a></li><li class="current"><a href="ArrayInterfacePEP.html">ArrayInterfacePEP</a></li>
</ul>

<div id="pageline"><hr style="display:none;"></div>
<div id="message">
<p><div class="warning">This wiki is not enabled for mail processing.
Contact the owner of the wiki, who can enable email.</div></p><a class="clear-link" href="ArrayInterfacePEP.html">Clear message</a>
</div>

<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="ArrayInterfacePEP37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../external.html?link=http://localhost:8080/ArrayInterfacePEP">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

</div>

<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><p class="line867">
<h1 id="The_Array_and_Buffer_interface_PEPs">The Array and Buffer interface PEPs</h1>
<span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><p class="line874">This page is meant to summarize the issues related to the PEPs (Python Enhancement Proposals) which Travis Oliphant has presented to the core Python team for support of a multidimensional array and an enhanced buffer interface in the language. <span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span><p class="line874">The purpose of this page is to present a reasonably organized view of the main points, usage cases and technical issues.  While the mailing lists are an excellent place for back-and-forth arguments, it is time-consuming to get an overview of a topic from a mailing list archive.  This page should provide such organized information in one easy to find location. <span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><p class="line867"><em>This page is currently mostly a placeholder, please contribute by fillng in useful information.</em> <span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><p class="line867">
<h2 id="Overview">Overview</h2>
<span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span><p class="line874">[ Provide a reasonably concise overview of the main idea and its need. ] <span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><p class="line867">
<h2 id="Usage_Cases">Usage Cases</h2>
<span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span><p class="line874">[ Specific examples of problems where this could help ] <span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><span class="anchor" id="line-19"></span><p class="line867">
<h2 id="Technical_Issues">Technical Issues</h2>
<span class="anchor" id="line-20"></span><span class="anchor" id="line-21"></span><p class="line874">[ Summarize here technical points as they get hashed out in the mailing list discussion, so that they don't need to be repeated over and over ] <span class="anchor" id="line-22"></span><span class="anchor" id="line-23"></span><p class="line867">
<h2 id="Resources">Resources</h2>
<span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span><p class="line874">[ Put here relevant links to the PEPs themselves, related projects, mailing list threads, etc. ] <span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span><p class="line874">Here are the threads related to the PEPs in Gmane:  <span class="anchor" id="line-28"></span><a class="http" href="../external.html?link=http://news.gmane.org/group/gmane.comp.python.devel/">http://news.gmane.org/group/gmane.comp.python.devel/</a> <span class="anchor" id="line-29"></span><span class="anchor" id="line-30"></span><p class="line867">
<h3 id="PEP:_Adding_data-type_objects_to_the_standard_library">PEP: Adding data-type objects to the standard library</h3>
<span class="anchor" id="line-31"></span><p class="line862">Author: Travis Oliphant &lt;oliphant &lt;at&gt; ee.byu.edu&gt; <span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span><p class="line874">Status: Draft <span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><p class="line874">Type: Standards Track <span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span><p class="line874">Created: 05-Sep-2006 <span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span><p class="line874">Python-Version: 2.6 <span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><p class="line874">Abstract <span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><ul><li style="list-style-type:none"><p class="line862">This PEP proposes adapting the data-type objects from <a class="nonexistent" href="NumPy.html">NumPy</a> for <span class="anchor" id="line-44"></span>inclusion in standard Python, to provide a consistent and standard <span class="anchor" id="line-45"></span>way to discuss the format of binary data.  <span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span></li></ul><p class="line874">Rationale <span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span><ul><li style="list-style-type:none">There are many situations crossing multiple areas where an <span class="anchor" id="line-50"></span>interpretation is needed of binary data in terms of fundamental <span class="anchor" id="line-51"></span>data-types such as integers, floating-point, and complex <span class="anchor" id="line-52"></span>floating-point values.  Having a common object that carries <span class="anchor" id="line-53"></span>information about binary data would be beneficial to many <span class="anchor" id="line-54"></span><p class="line862">people. The creation of data-type objects in <a class="nonexistent" href="NumPy.html">NumPy</a> to carry the <span class="anchor" id="line-55"></span>load of describing what each element of the array contains <span class="anchor" id="line-56"></span>represents an evolution of a solution that began with the <span class="anchor" id="line-57"></span><a class="nonexistent" href="PyArray.html">PyArray</a>_Descr structure in Python's own array object.  These <span class="anchor" id="line-58"></span>data-type objects can represent arbitrary byte data.  Currently <span class="anchor" id="line-59"></span>such information is usually constructed using strings and <span class="anchor" id="line-60"></span>character codes which is unwieldy when a data-type consists of <span class="anchor" id="line-61"></span>nested structures. <span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span></li></ul><p class="line874">Proposal <span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span><ul><li style="list-style-type:none"><p class="line862">Add a <a class="nonexistent" href="PyDatatypeObject.html">PyDatatypeObject</a> in Python (adapted from <a class="nonexistent" href="NumPy.html">NumPy</a>'s dtype <span class="anchor" id="line-66"></span>object which evolved from the <a class="nonexistent" href="PyArray.html">PyArray</a>_Descr structure in Python's <span class="anchor" id="line-67"></span>array module) that holds information about a data-type.  This object <span class="anchor" id="line-68"></span>will allow packages to exchange information about binary data in <span class="anchor" id="line-69"></span>a uniform way (see the extended buffer protocol PEP for an application <span class="anchor" id="line-70"></span>to exchanging information about array data).  <span class="anchor" id="line-71"></span><span class="anchor" id="line-72"></span></li></ul><p class="line874">Specification <span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span><ul><li style="list-style-type:none">The datatype is an object that specifies how a certain block of <span class="anchor" id="line-75"></span>memory should be interpreted as a basic data-type. In addition to <span class="anchor" id="line-76"></span>being able to describe basic data-types, the data-type object can <span class="anchor" id="line-77"></span>describe a data-type that is itself an array of other data-types <span class="anchor" id="line-78"></span>as well as a data-type that contains arbitrary &quot;fields&quot; (structure <span class="anchor" id="line-79"></span>members) which are located at specific offsets. In its most basic <span class="anchor" id="line-80"></span>form, however, a data-type is of a particular kind (bit, bool, <span class="anchor" id="line-81"></span>int, uint, float, complex, object, string, unicode, void) and size. <span class="anchor" id="line-82"></span><span class="anchor" id="line-83"></span>Datatype objects can be created using either a type-object, a <span class="anchor" id="line-84"></span>string, a tuple, a list, or a dictionary according to the following <span class="anchor" id="line-85"></span>constructors: <span class="anchor" id="line-86"></span><span class="anchor" id="line-87"></span>Type-object:  <span class="anchor" id="line-88"></span><span class="anchor" id="line-89"></span><ul><li style="list-style-type:none">For a select set of type-objects a data-type object describing that <span class="anchor" id="line-90"></span>basic type can be described: <span class="anchor" id="line-91"></span><span class="anchor" id="line-92"></span>Examples:  <span class="anchor" id="line-93"></span><span class="anchor" id="line-94"></span><p class="line891">&gt;&gt;&gt; datatype(float) <span class="anchor" id="line-95"></span>datatype('float64') <span class="anchor" id="line-96"></span><span class="anchor" id="line-97"></span><p class="line891">&gt;&gt;&gt; datatype(int) <span class="anchor" id="line-98"></span>datatype('int32')  # on 32-bit platform (64 if c-long is 64-bits) <span class="anchor" id="line-99"></span><span class="anchor" id="line-100"></span></li></ul>Tuple-object <span class="anchor" id="line-101"></span><span class="anchor" id="line-102"></span><ul><li style="list-style-type:none">A tuple of length 2 can be used to specify a data-type that is <span class="anchor" id="line-103"></span>an array of another kind of basic data-type (this array always <span class="anchor" id="line-104"></span>describes a C-contiguous array). <span class="anchor" id="line-105"></span><span class="anchor" id="line-106"></span>Examples:  <span class="anchor" id="line-107"></span><span class="anchor" id="line-108"></span><p class="line891">&gt;&gt;&gt; datatype((int, 5)) <span class="anchor" id="line-109"></span>datatype(('int32', (5,))) <span class="anchor" id="line-110"></span># describes a 5*4=20-byte block of memory laid out as  <span class="anchor" id="line-111"></span>#  a[0], a[1], a[2], a[3], a[4] <span class="anchor" id="line-112"></span><span class="anchor" id="line-113"></span><p class="line891">&gt;&gt;&gt; datatype((float, (3,2)) <span class="anchor" id="line-114"></span>datatype(('float64', (3,2))    <span class="anchor" id="line-115"></span># describes a 3*2*8=48 byte block of memory that should be <span class="anchor" id="line-116"></span># interpreted as 6 doubles laid out as arr[0,0], arr[0,1], <span class="anchor" id="line-117"></span># ... a[2,0], a[1,2] <span class="anchor" id="line-118"></span><span class="anchor" id="line-119"></span></li></ul>String-object: <span class="anchor" id="line-120"></span><span class="anchor" id="line-121"></span><ul><li style="list-style-type:none">The basic format is '%s%s%s%d' % (endian, shape, kind, itemsize)  <span class="anchor" id="line-122"></span><span class="anchor" id="line-123"></span><ul><li style="list-style-type:none">kind     : one of the basic array kinds given below.  <span class="anchor" id="line-124"></span><span class="anchor" id="line-125"></span>itemsize : the nubmer of bytes (or bits for 't' kind) for  <span class="anchor" id="line-126"></span><ul><li style="list-style-type:none">this data-type.   <span class="anchor" id="line-127"></span><span class="anchor" id="line-128"></span></li></ul><p class="line862">endian   : either <em>, '=' (native), '|' (doesn't matter), <span class="anchor" id="line-129"></span><ul><li style="list-style-type:none"><p class="line862">'&gt;' (big-endian) or '&lt;' (little-endian). <span class="anchor" id="line-130"></span><span class="anchor" id="line-131"></span></li></ul><p class="line862">shape    : either </em>, or a shape-tuple describing a data-type that <span class="anchor" id="line-132"></span><ul><li style="list-style-type:none">is an array of the given shape. <span class="anchor" id="line-133"></span><span class="anchor" id="line-134"></span></li></ul></li></ul>A string can also be a comma-separated sequence of basic <span class="anchor" id="line-135"></span>formats. The result will be a data-type with default field <span class="anchor" id="line-136"></span>names: 'f0', 'f1', ..., 'fn'. <span class="anchor" id="line-137"></span><span class="anchor" id="line-138"></span>Examples:  <span class="anchor" id="line-139"></span><span class="anchor" id="line-140"></span><p class="line891">&gt;&gt;&gt; datatype('u4') <span class="anchor" id="line-141"></span>datatype('uint32') <span class="anchor" id="line-142"></span><span class="anchor" id="line-143"></span><p class="line891">&gt;&gt;&gt; datatype('f4') <span class="anchor" id="line-144"></span>datatype('float32') <span class="anchor" id="line-145"></span><span class="anchor" id="line-146"></span><p class="line891">&gt;&gt;&gt; datatype('(3,2)f4') <span class="anchor" id="line-147"></span>datatype(('float32', (3,2)) <span class="anchor" id="line-148"></span><span class="anchor" id="line-149"></span><p class="line891">&gt;&gt;&gt; datatype('(5,)i4, (3,2)f4, S5') <span class="anchor" id="line-150"></span>datatype([('f0', '&lt;i4', (5,)), ('f1', '&lt;f4', (3, 2)), ('f2', '|S5')]) <span class="anchor" id="line-151"></span><span class="anchor" id="line-152"></span></li></ul>List-object: <span class="anchor" id="line-153"></span><span class="anchor" id="line-154"></span><ul><li style="list-style-type:none">A list should be a list of tuples where each tuple describes a <span class="anchor" id="line-155"></span>field. Each tuple should contain (name, datatype{, shape}) or <span class="anchor" id="line-156"></span>((meta-info, name), datatype{, shape}) in order to specify the <span class="anchor" id="line-157"></span>data-type.  <span class="anchor" id="line-158"></span><span class="anchor" id="line-159"></span>This list must fully specify the data-type (no memory holes). If <span class="anchor" id="line-160"></span>would would like to return a data-type with memory holes where the <span class="anchor" id="line-161"></span>compiler would place them, then pass the keyword align=1 to this <span class="anchor" id="line-162"></span>construction.  This will result in un-named fields of Void kind of <span class="anchor" id="line-163"></span>the correct size interspersed where needed. <span class="anchor" id="line-164"></span><span class="anchor" id="line-165"></span>Examples:  <span class="anchor" id="line-166"></span><span class="anchor" id="line-167"></span>datatype([( ([1,2],'coords'), 'f4', (3,6)), ('address', 'S30')]) <span class="anchor" id="line-168"></span><span class="anchor" id="line-169"></span>A data-type that could represent the structure <span class="anchor" id="line-170"></span><span class="anchor" id="line-171"></span><p class="line862">float coords[3*6]   <span class="comment" style="display:none">Has [1,2] associated with this field</span> <span class="anchor" id="line-172"></span>char  address[30] <span class="anchor" id="line-173"></span><span class="anchor" id="line-174"></span>datatype([( 'simple', 'i4'), ('nested', [('name', 'S30'),  <span class="anchor" id="line-175"></span><ul><li style="list-style-type:none">('addr', 'S45'),     <span class="anchor" id="line-176"></span>('amount', 'i4')])]) <span class="anchor" id="line-177"></span><span class="anchor" id="line-178"></span></li></ul>Can represent the memory layout of  <span class="anchor" id="line-179"></span><span class="anchor" id="line-180"></span>struct { <span class="anchor" id="line-181"></span>int  simple; <span class="anchor" id="line-182"></span>struct nested { <span class="anchor" id="line-183"></span><ul><li style="list-style-type:none">char name[30]; <span class="anchor" id="line-184"></span>char addr[45]; <span class="anchor" id="line-185"></span>int  amount; <span class="anchor" id="line-186"></span></li></ul>} <span class="anchor" id="line-187"></span><span class="anchor" id="line-188"></span>There is no formal limit to the nesting that is possible.  <span class="anchor" id="line-189"></span><span class="anchor" id="line-190"></span><span class="anchor" id="line-191"></span>datatype('i2, i4, i1, f8', align=1) <span class="anchor" id="line-192"></span><p class="line862">datatype([('f0', '&lt;i2'), (<em>, '|V2'), ('f1', '&lt;i4'),  <span class="anchor" id="line-193"></span><ul><li style="list-style-type:none"><p class="line862">('f2', '|i1'), (</em>, '|V3'), ('f3', '&lt;f8')]) <span class="anchor" id="line-194"></span><span class="anchor" id="line-195"></span></li></ul># Notice the padding bytes placed in the structure to make sure <span class="anchor" id="line-196"></span>#  f1 and f8 are aligned correctly for the 32-bit system.  <span class="anchor" id="line-197"></span><span class="anchor" id="line-198"></span></li></ul>Dictionary-object:  <span class="anchor" id="line-199"></span><span class="anchor" id="line-200"></span><ul><li style="list-style-type:none">Sometimes, you are only concerned about a few fields in a larger <span class="anchor" id="line-201"></span>memory structure.  The dictionary object allows specification of   <span class="anchor" id="line-202"></span>a data-type with fields using a dictionary with names as keys and <span class="anchor" id="line-203"></span>tuples as values.  The value tuples are  <span class="anchor" id="line-204"></span>(data-type, offset{, meta-info}).  The offset is the offset in    <span class="anchor" id="line-205"></span>bytes (or bits when data-type is 't') from the beginning of the  <span class="anchor" id="line-206"></span>structure to the field data-type. <span class="anchor" id="line-207"></span><span class="anchor" id="line-208"></span>Example: <span class="anchor" id="line-209"></span><span class="anchor" id="line-210"></span>datatype({'f3' : ('f8', 12), 'f2': ('i1', 8)}) <span class="anchor" id="line-211"></span><p class="line862">type([(<em>, '|V8'), ('f2', '|i1'), (</em>, '|V3'), ('f3', '&lt;f8')]) <span class="anchor" id="line-212"></span><span class="anchor" id="line-213"></span></li></ul></li></ul><ul><li style="list-style-type:none">Attributes <span class="anchor" id="line-214"></span><span class="anchor" id="line-215"></span><ul><li style="list-style-type:none">byteorder --  returns the byte-order of this data-type <span class="anchor" id="line-216"></span><span class="anchor" id="line-217"></span>isnative  --  returns True if this data-type is in correct byte-order <span class="anchor" id="line-218"></span><ul><li style="list-style-type:none">for the platform. <span class="anchor" id="line-219"></span><span class="anchor" id="line-220"></span></li></ul>descr     --  returns an description of this data-type as a list of  <span class="anchor" id="line-221"></span><ul><li style="list-style-type:none">tuples (name or (name, meta), datatype{, shape}) <span class="anchor" id="line-222"></span><span class="anchor" id="line-223"></span></li></ul>itemsize  --  returns the total size of the data-type.  <span class="anchor" id="line-224"></span><span class="anchor" id="line-225"></span>kind      --  returns the basic &quot;kind&quot; of the data-type. The basic kinds <span class="anchor" id="line-226"></span><ul><li style="list-style-type:none">are: <span class="anchor" id="line-227"></span><ul><li style="list-style-type:none">'t' - bit,  <span class="anchor" id="line-228"></span>'b' - bool,  <span class="anchor" id="line-229"></span>'i' - signed integer,  <span class="anchor" id="line-230"></span>'u' - unsigned integer, <span class="anchor" id="line-231"></span>'f' - floating point,                   <span class="anchor" id="line-232"></span>'c' - complex floating point,  <span class="anchor" id="line-233"></span>'S' - string (fixed-length sequence of char), <span class="anchor" id="line-234"></span>'U' - fixed length sequence of UCS4, <span class="anchor" id="line-235"></span><p class="line862">'O' - pointer to <a class="nonexistent" href="PyObject.html">PyObject</a>, <span class="anchor" id="line-236"></span>'V' - Void (anything else). <span class="anchor" id="line-237"></span><span class="anchor" id="line-238"></span></li></ul></li></ul>names     --  returns a list of names (keys to the fields dictionary) in <span class="anchor" id="line-239"></span><ul><li style="list-style-type:none">offset-order. <span class="anchor" id="line-240"></span><span class="anchor" id="line-241"></span></li></ul>fields    --  returns a read-only dictionary indicating the fields or  <span class="anchor" id="line-242"></span><ul><li style="list-style-type:none">None if this data-type has no fields.  The dictionary <span class="anchor" id="line-243"></span>is keyed by the field name and each entry contains <span class="anchor" id="line-244"></span>a tuple of (data-type, offset{, meta-object}). The <span class="anchor" id="line-245"></span>offset indicates the byte-offset (or bit-offset for 't') <span class="anchor" id="line-246"></span>from the beginning of the data-type to the data-type  <span class="anchor" id="line-247"></span>indicated. <span class="anchor" id="line-248"></span><span class="anchor" id="line-249"></span></li></ul>hasobject --  returns True if this data-type is an &quot;object&quot; data-type <span class="anchor" id="line-250"></span><ul><li style="list-style-type:none">or  has &quot;object&quot; fields.  <span class="anchor" id="line-251"></span><span class="anchor" id="line-252"></span></li></ul>name      --  returns a 'name'-bitwidth description of data-type. <span class="anchor" id="line-253"></span><span class="anchor" id="line-254"></span>base      --  returns self unless this data-type is an array of some <span class="anchor" id="line-255"></span><ul><li style="list-style-type:none">other data-type and then it returns that basic <span class="anchor" id="line-256"></span>data-type.                   <span class="anchor" id="line-257"></span><span class="anchor" id="line-258"></span></li></ul>shape     --  returns the shape of this data-type (for data-types <span class="anchor" id="line-259"></span><ul><li style="list-style-type:none">that are arrays of other data-types) or () if there <span class="anchor" id="line-260"></span>is no array.  <span class="anchor" id="line-261"></span><span class="anchor" id="line-262"></span></li></ul>str       --  returns the type-string of this data-type which is the <span class="anchor" id="line-263"></span><ul><li style="list-style-type:none">basic kind followed by the number of bytes (or bits  <span class="anchor" id="line-264"></span>for 't') <span class="anchor" id="line-265"></span><span class="anchor" id="line-266"></span></li></ul>alignment --  returns alignment needed for this data-type on platform <span class="anchor" id="line-267"></span><ul><li style="list-style-type:none">as determined by the compiler.  <span class="anchor" id="line-268"></span><span class="anchor" id="line-269"></span></li></ul></li></ul>Methods <span class="anchor" id="line-270"></span><span class="anchor" id="line-271"></span><ul><li style="list-style-type:none">newbyteorder ({endian}) <span class="anchor" id="line-272"></span><span class="anchor" id="line-273"></span><ul><li style="list-style-type:none">create a new data-type with byte-order changed in any and all <span class="anchor" id="line-274"></span>fields (including deeply nested ones), to {endian}.  If endian is <span class="anchor" id="line-275"></span>not given, then swap all byte-orders. <span class="anchor" id="line-276"></span><span class="anchor" id="line-277"></span></li></ul><p class="line891"><span class="u">len</span>(self)   <span class="anchor" id="line-278"></span><span class="anchor" id="line-279"></span><ul><li style="list-style-type:none">equivalent to len(self.field) <span class="anchor" id="line-280"></span><span class="anchor" id="line-281"></span></li></ul><p class="line891"><span class="u">getitem</span>(self, name) <span class="anchor" id="line-282"></span><span class="anchor" id="line-283"></span><ul><li style="list-style-type:none">get the field named [name].  Equivalent to self.field[name]. <span class="anchor" id="line-284"></span><span class="anchor" id="line-285"></span></li></ul></li></ul>C-functions :  These are function pointers attached in a C-structure <span class="anchor" id="line-286"></span><ul><li style="list-style-type:none">connected with the data-type object that perform specific  <span class="anchor" id="line-287"></span>functions. <span class="anchor" id="line-288"></span><span class="anchor" id="line-289"></span></li></ul><ul><li style="list-style-type:none"><p class="line862">setitem  (<a class="nonexistent" href="PyObject.html">PyObject</a> *datatype, void *data, <a class="nonexistent" href="PyObject.html">PyObject</a> *obj) <span class="anchor" id="line-290"></span><span class="anchor" id="line-291"></span><ul><li style="list-style-type:none">set a Python object into memory of this data-type <span class="anchor" id="line-292"></span><ul><li style="list-style-type:none">at the given memory location. <span class="anchor" id="line-293"></span><span class="anchor" id="line-294"></span></li></ul></li></ul><p class="line862">getitem  (<a class="nonexistent" href="PyObject.html">PyObject</a> *datatype, void *data)  <span class="anchor" id="line-295"></span><span class="anchor" id="line-296"></span><ul><li style="list-style-type:none">get a Python object from memory of this data-type. <span class="anchor" id="line-297"></span><span class="anchor" id="line-298"></span></li></ul></li></ul></li></ul><p class="line874">Implementation <span class="anchor" id="line-299"></span><span class="anchor" id="line-300"></span><ul><li style="list-style-type:none">A reference implementation (with more features than are proposed <span class="anchor" id="line-301"></span><p class="line862">here) is available in <a class="nonexistent" href="NumPy.html">NumPy</a> and will be adapted if this PEP is <span class="anchor" id="line-302"></span>accepted. <span class="anchor" id="line-303"></span><span class="anchor" id="line-304"></span></li></ul><p class="line874">Questions: <span class="anchor" id="line-305"></span><span class="anchor" id="line-306"></span><ul><li style="list-style-type:none">There should probably be a limited C-API so that data-type objects <span class="anchor" id="line-307"></span>can be returned and sent through the extended buffer protocol (see  <span class="anchor" id="line-308"></span>extended buffer protocol PEP).  <span class="anchor" id="line-309"></span><span class="anchor" id="line-310"></span>Should bit-fields be handled by re-interpreting the offsets as <span class="anchor" id="line-311"></span>bit-values, use some other mechanism for handling the offset, or <span class="anchor" id="line-312"></span>should they be unsupported? <span class="anchor" id="line-313"></span><span class="anchor" id="line-314"></span><p class="line891"><a class="nonexistent" href="NumPy.html">NumPy</a> supports &quot;string&quot; and &quot;unicode&quot; data-types.  The unicode <span class="anchor" id="line-315"></span>data-type in <a class="nonexistent" href="NumPy.html">NumPy</a> always means UCS4 (but it is translated <span class="anchor" id="line-316"></span>back-and forth to Python unicode scalars as needed for narrow <span class="anchor" id="line-317"></span>builds).  With Python 3.0 looming, we should probably support <span class="anchor" id="line-318"></span>different encodings as data-types and drop the string type for a <span class="anchor" id="line-319"></span>bytes type.  Some help in understanding what to do here is <span class="anchor" id="line-320"></span>appreciated. <span class="anchor" id="line-321"></span><span class="anchor" id="line-322"></span></li></ul><p class="line874">Copyright <span class="anchor" id="line-323"></span><span class="anchor" id="line-324"></span><ul><li style="list-style-type:none">This PEP is placed in the public domain <span class="anchor" id="line-325"></span><span class="anchor" id="line-326"></span></li></ul><p class="line867">
<h3 id="PEP:_Extending_the_buffer_protocol_to_include_the_array_interface">PEP: Extending the buffer protocol to include the array interface</h3>
<span class="anchor" id="line-327"></span><span class="anchor" id="line-328"></span><p class="line862">Author: Travis Oliphant &lt;<a class="mailto" href="mailto:oliphant@ee.byu.edu">oliphant@ee.byu.edu</a>&gt; <span class="anchor" id="line-329"></span><span class="anchor" id="line-330"></span><p class="line874">Status: Draft <span class="anchor" id="line-331"></span><span class="anchor" id="line-332"></span><p class="line874">Type: Standards Track <span class="anchor" id="line-333"></span><span class="anchor" id="line-334"></span><p class="line874">Created: 28-Aug-2006 <span class="anchor" id="line-335"></span><span class="anchor" id="line-336"></span><p class="line874">Python-Version: 2.6 <span class="anchor" id="line-337"></span><span class="anchor" id="line-338"></span><p class="line874">Abstract <span class="anchor" id="line-339"></span><span class="anchor" id="line-340"></span><ul><li style="list-style-type:none">This PEP proposes extending the tp_as_buffer structure to include  <span class="anchor" id="line-341"></span>function pointers that incorporate information about the intended <span class="anchor" id="line-342"></span>shape and data-format of the provided buffer.  In essence this will <span class="anchor" id="line-343"></span>place something akin to the array interface directly into Python.  <span class="anchor" id="line-344"></span><span class="anchor" id="line-345"></span></li></ul><p class="line874">Rationale <span class="anchor" id="line-346"></span><span class="anchor" id="line-347"></span><ul><li style="list-style-type:none">Several extensions to Python utilize the buffer protocol to share <span class="anchor" id="line-348"></span>the location of a data-buffer that is really an N-dimensional <span class="anchor" id="line-349"></span>array.  However, there is no standard way to exchange the <span class="anchor" id="line-350"></span>additional N-dimensional array information so that the data-buffer <span class="anchor" id="line-351"></span><p class="line862">is interpreted correctly.  The <a class="nonexistent" href="NumPy.html">NumPy</a> project introduced an array <span class="anchor" id="line-352"></span>interface (<a class="http" href="../external.html?link=http://numpy.scipy.org/array_interface.shtml">http://numpy.scipy.org/array_interface.shtml</a>) through a <span class="anchor" id="line-353"></span>set of attributes on the object itself.  While this approach <span class="anchor" id="line-354"></span>works, it requires attribute lookups which can be expensive when <span class="anchor" id="line-355"></span>sharing many small arrays.   <span class="anchor" id="line-356"></span><span class="anchor" id="line-357"></span>One of the key reasons that users often request to place something <span class="anchor" id="line-358"></span><p class="line862">like <a class="nonexistent" href="NumPy.html">NumPy</a> into the standard library is so that it can be used as <span class="anchor" id="line-359"></span>standard for other packages that deal with arrays.  This PEP <span class="anchor" id="line-360"></span>provides a mechanism for extending the buffer protocol (which <span class="anchor" id="line-361"></span>already allows data sharing) to add the additional information <span class="anchor" id="line-362"></span>needed to understand the data.  This should be of benefit to all <span class="anchor" id="line-363"></span>third-party modules that want to share memory through the buffer <span class="anchor" id="line-364"></span>protocol such as GUI toolkits, PIL, <a class="nonexistent" href="PyGame.html">PyGame</a>, CVXOPT, <a class="nonexistent" href="PyVoxel.html">PyVoxel</a>, <span class="anchor" id="line-365"></span><a class="nonexistent" href="PyMedia.html">PyMedia</a>, audio libraries, video libraries etc. <span class="anchor" id="line-366"></span><span class="anchor" id="line-367"></span><span class="anchor" id="line-368"></span></li></ul><p class="line874">Proposal <span class="anchor" id="line-369"></span><span class="anchor" id="line-370"></span><ul><li style="list-style-type:none">Add a bf_getarrayinfo function pointer to the buffer protocol to <span class="anchor" id="line-371"></span>allow objects to share additional information about the returned <span class="anchor" id="line-372"></span>memory pointer.  Add the TP_HAS_EXT_BUFFER flag to types that <span class="anchor" id="line-373"></span>define the extended buffer protocol.  <span class="anchor" id="line-374"></span><span class="anchor" id="line-375"></span></li></ul><p class="line874">Specification: <span class="anchor" id="line-376"></span><span class="anchor" id="line-377"></span><ul><li style="list-style-type:none">static int  <span class="anchor" id="line-378"></span><span class="anchor" id="line-379"></span><p class="line862">bf_getarrayinfo (<a class="nonexistent" href="PyObject.html">PyObject</a> *obj, Py_intptr_t **shape,  <span class="anchor" id="line-380"></span><ul><li style="list-style-type:none"><p class="line862">Py_intptr_t **strides, <a class="nonexistent" href="PyObject.html">PyObject</a> **dataformat) <span class="anchor" id="line-381"></span><span class="anchor" id="line-382"></span></li></ul>Inputs:   <span class="anchor" id="line-383"></span><ul><li style="list-style-type:none">obj -- The Python object being questioned. <span class="anchor" id="line-384"></span><span class="anchor" id="line-385"></span></li></ul>Outputs:  <span class="anchor" id="line-386"></span><span class="anchor" id="line-387"></span><ul><li style="list-style-type:none">[function result] -- the number of dimensions (n) <span class="anchor" id="line-388"></span><span class="anchor" id="line-389"></span></li><li class="gap">shape -- A C-array of 'n' integers indicating the <span class="anchor" id="line-390"></span><ul><li style="list-style-type:none">shape of the array. Can be NULL if n==0. <span class="anchor" id="line-391"></span><span class="anchor" id="line-392"></span></li></ul></li><li class="gap">strides -- A C-array of 'n' integers indicating <span class="anchor" id="line-393"></span><ul><li style="list-style-type:none">the number of bytes to jump to get to the next <span class="anchor" id="line-394"></span>element in each dimension. Can be NULL if the  <span class="anchor" id="line-395"></span>array is C-contiguous (or n==0). <span class="anchor" id="line-396"></span><span class="anchor" id="line-397"></span></li></ul></li><li class="gap">dataformat -- A Python object describing the data-format <span class="anchor" id="line-398"></span><ul><li style="list-style-type:none">each element of the array should be <span class="anchor" id="line-399"></span>interpreted as. <span class="anchor" id="line-400"></span><span class="anchor" id="line-401"></span><span class="anchor" id="line-402"></span></li></ul></li></ul></li></ul><p class="line874">Discussion Questions: <span class="anchor" id="line-403"></span><span class="anchor" id="line-404"></span><ul><li style="list-style-type:none">1) How is data-format information supposed to be shared?  A companion <span class="anchor" id="line-405"></span>proposal suggests returning a data-format object which carries the <span class="anchor" id="line-406"></span>information about the buffer area.  <span class="anchor" id="line-407"></span><span class="anchor" id="line-408"></span>2) Should the single function pointer call be extended into <span class="anchor" id="line-409"></span>multiple calls or should it's arguments be compressed into a structure <span class="anchor" id="line-410"></span>that is filled? <span class="anchor" id="line-411"></span><span class="anchor" id="line-412"></span>3) Should a C-API function(s) be created which wraps calls to this function <span class="anchor" id="line-413"></span>pointer much like is done now with the buffer protocol?  What should <span class="anchor" id="line-414"></span>the interface of this function (or these functions) be. <span class="anchor" id="line-415"></span><span class="anchor" id="line-416"></span>4) Should a mask (for missing values) be shared as well?  <span class="anchor" id="line-417"></span><span class="anchor" id="line-418"></span></li></ul><p class="line874">Reference Implementation <span class="anchor" id="line-419"></span><span class="anchor" id="line-420"></span><ul><li style="list-style-type:none">Supplied when the PEP is accepted.  <span class="anchor" id="line-421"></span><span class="anchor" id="line-422"></span></li></ul><p class="line874">Copyright <span class="anchor" id="line-423"></span><span class="anchor" id="line-424"></span><ul><li style="list-style-type:none">This document is placed in the public domain. <span class="anchor" id="line-425"></span></li></ul><span class="anchor" id="bottom"></span></div>
<div id="pagebottom"></div>
</div>


<div id="footer">
<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="ArrayInterfacePEP37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../external.html?link=http://localhost:8080/ArrayInterfacePEP">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

<ul id="credits">
<li><a href="../external.html?link=http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="../external.html?link=http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="../external.html?link=http://moinmo.in/GPL" title="MoinMoin is GPL licensed.">GPL licensed</a></li><li><a href="../external.html?link=http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li>
</ul>


</div>
</body>

<!-- Mirrored from localhost:8080/ArrayInterfacePEP?action=recoverpass by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 23:17:38 GMT -->
</html>

