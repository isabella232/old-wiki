<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<!-- Mirrored from localhost:8080/Cookbook/DataFrame?action=AttachFile&do=view&target=DataFrame.py by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 20:41:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="robots" content="noindex,nofollow">

<title>attachment:DataFrame.py of Cookbook/DataFrame - SciPy wiki dump</title>
<script type="text/javascript" src="../moin_static197/common/js/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../moin_static197/modern/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="../moin_static197/modern/css/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="../moin_static197/modern/css/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="../moin_static197/modern/css/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static197/modern/css/msie.css">
<![endif]-->


<link rel="alternate" title="SciPy: Cookbook/DataFrame" href="../../external.html?link=http://localhost:8080/Cookbook/DataFrame?diffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=Cookbook%2FDataFrame&amp;ddiffs=1" type="application/rss+xml">


<link rel="Start" href="../AllPages.html">
<link rel="Alternate" title="Wiki Markup" href="../../external.html?link=http://localhost:8080/Cookbook/DataFrame?action=raw">
<link rel="Alternate" media="print" title="Print View" href="../../external.html?link=http://localhost:8080/Cookbook/DataFrame?action=print">
<link rel="Up" href="../Cookbook.html">
<link rel="Appendix" title="CSVSample.csv" href="DataFrame4fd5.html?action=AttachFile&amp;do=view&amp;target=CSVSample.csv">
<link rel="Appendix" title="DataFrame.py" href="DataFrame857d.html?action=AttachFile&amp;do=view&amp;target=DataFrame.py">
<link rel="Appendix" title="SampleCSV.csv" href="DataFrame4dec.html?action=AttachFile&amp;do=view&amp;target=SampleCSV.csv">
<link rel="Search" href="../FindPage.html">
<link rel="Index" href="../TitleIndex.html">
<link rel="Glossary" href="../WordIndex.html">
<link rel="Help" href="../HelpOnFormatting.html">
</head>

<body  lang="en" dir="ltr"><div style="background: white; width:100%; padding:2em;">This is an archival dump of old wiki content --- see <a href="http://scipy.org/">scipy.org</a> for current material</div>

<div id="header">


<form id="searchform" method="get" action="../../external.html?link=http://localhost:8080/Cookbook/DataFrame">
<div>
<input type="hidden" name="action" value="fullsearch">
<input type="hidden" name="context" value="180">
<label for="searchinput">Search:</label>
<input id="searchinput" type="text" name="value" value="" size="20"
    onfocus="searchFocus(this)" onblur="searchBlur(this)"
    onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search">
<input id="titlesearch" name="titlesearch" type="submit"
    value="Titles" alt="Search Titles">
<input id="fullsearch" name="fullsearch" type="submit"
    value="Text" alt="Search Full Text">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<ul id="username"><li><a href="DataFrame456e.html?action=login" id="login" rel="nofollow">Login</a></li></ul>
<div id="locationline">
<div id="interwiki"><span><a href="../AllPages.html" rel="nofollow">SciPy</a></span></div>

<ul id="pagelocation">
<li>attachment:DataFrame.py of Cookbook/DataFrame</li>
</ul>

</div>


<ul id="navibar">
<li class="wikilink"><a href="../RecentChanges.html">RecentChanges</a></li><li class="wikilink"><a class="nonexistent" href="../FindPage.html">FindPage</a></li><li class="wikilink"><a class="nonexistent" href="../HelpContents.html">HelpContents</a></li><li class="current"><a href="DataFrame.html">Cookbook/DataFrame</a></li>
</ul>

<div id="pageline"><hr style="display:none;"></div>

<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="DataFrame37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../../external.html?link=http://localhost:8080/Cookbook/DataFrame">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

</div>

<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<h2>Attachment 'DataFrame.py'</h2><a class="download" href="DataFrame7904.py?action=AttachFile&amp;do=get&amp;target=DataFrame.py">Download</a><br><br><span class="anchor" id="line-1"></span><div class="highlight text"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
function isnumbered(obj) {
  return obj.childNodes.length && obj.firstChild.childNodes.length && obj.firstChild.firstChild.className == 'LineNumber';
}
function nformat(num,chrs,add) {
  var nlen = Math.max(0,chrs-(''+num).length), res = '';
  while (nlen>0) { res += ' '; nlen-- }
  return res+num+add;
}
function addnumber(did, nstart, nstep) {
  var c = document.getElementById(did), l = c.firstChild, n = 1;
  if (!isnumbered(c)) {
    if (typeof nstart == 'undefined') nstart = 1;
    if (typeof nstep  == 'undefined') nstep = 1;
    var n = nstart;
    while (l != null) {
      if (l.tagName == 'SPAN') {
        var s = document.createElement('SPAN');
        var a = document.createElement('A');
        s.className = 'LineNumber';
        a.appendChild(document.createTextNode(nformat(n,4,'')));
        a.href = '#' + did + '_' + n;
        s.appendChild(a);
        s.appendChild(document.createTextNode(' '));
        n += nstep;
        if (l.childNodes.length) {
          l.insertBefore(s, l.firstChild);
        }
        else {
          l.appendChild(s);
        }
      }
      l = l.nextSibling;
    }
  }
  return false;
}
function remnumber(did) {
  var c = document.getElementById(did), l = c.firstChild;
  if (isnumbered(c)) {
    while (l != null) {
      if (l.tagName == 'SPAN' && l.firstChild.className == 'LineNumber') l.removeChild(l.firstChild);
      l = l.nextSibling;
    }
  }
  return false;
}
function togglenumber(did, nstart, nstep) {
  var c = document.getElementById(did);
  if (isnumbered(c)) {
    remnumber(did);
  } else {
    addnumber(did,nstart,nstep);
  }
  return false;
}
</script>

<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-e05facc782df647d7974d1698dd5ffe6e305343a\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_1">   1</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_1"></span><span class="anchor" id="line-1-1"></span><span class="Comment">## Copyright (c) 2001-2006, Andrew Straw. All rights reserved.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_2">   2</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_2"></span><span class="anchor" id="line-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_3">   3</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_3"></span><span class="anchor" id="line-3"></span><span class="Comment">## Redistribution and use in source and binary forms, with or without</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_4">   4</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_4"></span><span class="anchor" id="line-4"></span><span class="Comment">## modification, are permitted provided that the following conditions are</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_5">   5</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_5"></span><span class="anchor" id="line-5"></span><span class="Comment">## met:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_6">   6</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_6"></span><span class="anchor" id="line-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_7">   7</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_7"></span><span class="anchor" id="line-7"></span><span class="Comment">##     * Redistributions of source code must retain the above copyright</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_8">   8</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_8"></span><span class="anchor" id="line-8"></span><span class="Comment">##       notice, this list of conditions and the following disclaimer.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_9">   9</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_9"></span><span class="anchor" id="line-9"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_10">  10</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_10"></span><span class="anchor" id="line-10"></span><span class="Comment">##     * Redistributions in binary form must reproduce the above</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_11">  11</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_11"></span><span class="anchor" id="line-11"></span><span class="Comment">##       copyright notice, this list of conditions and the following</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_12">  12</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_12"></span><span class="anchor" id="line-12"></span><span class="Comment">##       disclaimer in the documentation and/or other materials provided</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_13">  13</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_13"></span><span class="anchor" id="line-13"></span><span class="Comment">##       with the distribution.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_14">  14</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_14"></span><span class="anchor" id="line-14"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_15">  15</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_15"></span><span class="anchor" id="line-15"></span><span class="Comment">##     * Neither the name of the Andrew Straw nor the names of its</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_16">  16</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_16"></span><span class="anchor" id="line-16"></span><span class="Comment">##       contributors may be used to endorse or promote products derived</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_17">  17</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_17"></span><span class="anchor" id="line-17"></span><span class="Comment">##       from this software without specific prior written permission.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_18">  18</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_18"></span><span class="anchor" id="line-18"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_19">  19</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_19"></span><span class="anchor" id="line-19"></span><span class="Comment">## THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_20">  20</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_20"></span><span class="anchor" id="line-20"></span><span class="Comment">## &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_21">  21</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_21"></span><span class="anchor" id="line-21"></span><span class="Comment">## LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_22">  22</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_22"></span><span class="anchor" id="line-22"></span><span class="Comment">## A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_23">  23</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_23"></span><span class="anchor" id="line-23"></span><span class="Comment">## OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_24">  24</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_24"></span><span class="anchor" id="line-24"></span><span class="Comment">## SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_25">  25</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_25"></span><span class="anchor" id="line-25"></span><span class="Comment">## LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_26">  26</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_26"></span><span class="anchor" id="line-26"></span><span class="Comment">## DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_27">  27</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_27"></span><span class="anchor" id="line-27"></span><span class="Comment">## THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_28">  28</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_28"></span><span class="anchor" id="line-28"></span><span class="Comment">## (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_29">  29</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_29"></span><span class="anchor" id="line-29"></span><span class="Comment">## OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_30">  30</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_30"></span><span class="anchor" id="line-30"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_31">  31</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_31"></span><span class="anchor" id="line-31"></span><span class="ResWord">import</span> <span class="ID">math</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_32">  32</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_32"></span><span class="anchor" id="line-32"></span><span class="ResWord">import</span> <span class="ID">sets</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_33">  33</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_33"></span><span class="anchor" id="line-33"></span><span class="ResWord">from</span> <span class="ID">scipy</span> <span class="ResWord">import</span> *</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_34">  34</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_34"></span><span class="anchor" id="line-34"></span><span class="ResWord">import</span> <span class="ID">Numeric</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_35">  35</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_35"></span><span class="anchor" id="line-35"></span><span class="ResWord">import</span> <span class="ID">cStringIO</span> <span class="ResWord">as</span> <span class="ID">StringIO</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_36">  36</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_36"></span><span class="anchor" id="line-36"></span><span class="ResWord">import</span> <span class="ID">csv</span> <span class="Comment"># with Python 2.3</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_37">  37</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_37"></span><span class="anchor" id="line-37"></span><span class="ResWord">class</span> <span class="ID">access2000</span>(<span class="ID">csv</span>.<span class="ID">Dialect</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_38">  38</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_38"></span><span class="anchor" id="line-38"></span>	<span class="String">&quot;&quot;&quot;A dialect to properly interpret Microsoft Access2000 CSV exports for international languages.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_39">  39</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_39"></span><span class="anchor" id="line-39"></span><span class="String">	&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_40">  40</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_40"></span><span class="anchor" id="line-40"></span>	<span class="ID">delimiter</span> = <span class="String">'</span><span class="String">;</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_41">  41</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_41"></span><span class="anchor" id="line-41"></span>	<span class="ID">quotechar</span> = <span class="String">'</span><span class="String">&quot;</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_42">  42</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_42"></span><span class="anchor" id="line-42"></span>	<span class="ID">doublequote</span> = <span class="ResWord">True</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_43">  43</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_43"></span><span class="anchor" id="line-43"></span>	<span class="ID">quoting</span> = <span class="ID">csv</span>.<span class="ID">QUOTE_NONNUMERIC</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_44">  44</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_44"></span><span class="anchor" id="line-44"></span>	<span class="ID">lineterminator</span> = <span class="String">'</span><span class="SPChar">\n</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_45">  45</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_45"></span><span class="anchor" id="line-45"></span>	<span class="ID">skipinitialspace</span> = <span class="ResWord">True</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_46">  46</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_46"></span><span class="anchor" id="line-46"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_47">  47</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_47"></span><span class="anchor" id="line-47"></span><span class="ResWord">class</span> <span class="ID">DataFrame</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_48">  48</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_48"></span><span class="anchor" id="line-48"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">value_dict</span>=<span class="ResWord">None</span>, <span class="ID">fields_order</span>=<span class="ResWord">None</span> ):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_49">  49</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_49"></span><span class="anchor" id="line-49"></span>        <span class="ResWord">if</span> <span class="ID">value_dict</span> <span class="ResWord">is</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_50">  50</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_50"></span><span class="anchor" id="line-50"></span>            <span class="ID">value_dict</span> = {}</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_51">  51</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_51"></span><span class="anchor" id="line-51"></span>        <span class="ResWord">self</span>.<span class="ID">value_dict</span> = <span class="ID">value_dict</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_52">  52</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_52"></span><span class="anchor" id="line-52"></span>        <span class="ID">num_rows</span> = <span class="Number">0</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_53">  53</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_53"></span><span class="anchor" id="line-53"></span>        <span class="ResWord">for</span> <span class="ID">column</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">value_dict</span>.<span class="ID">values</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_54">  54</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_54"></span><span class="anchor" id="line-54"></span>            <span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_55">  55</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_55"></span><span class="anchor" id="line-55"></span>                <span class="ID">num_rows</span> = <span class="ResWord">max</span>(<span class="ID">num_rows</span>,<span class="ResWord">len</span>(<span class="ID">column</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_56">  56</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_56"></span><span class="anchor" id="line-56"></span>            <span class="ResWord">except</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_57">  57</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_57"></span><span class="anchor" id="line-57"></span>                <span class="ResWord">pass</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_58">  58</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_58"></span><span class="anchor" id="line-58"></span>        <span class="ResWord">for</span> <span class="ID">key</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">value_dict</span>.<span class="ID">keys</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_59">  59</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_59"></span><span class="anchor" id="line-59"></span>            <span class="ResWord">if</span> <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">key</span>] <span class="ResWord">is</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_60">  60</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_60"></span><span class="anchor" id="line-60"></span>                <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">key</span>] = (<span class="ResWord">None</span>,)*<span class="ID">num_rows</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_61">  61</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_61"></span><span class="anchor" id="line-61"></span>        <span class="ResWord">for</span> <span class="ID">field</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">value_dict</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_62">  62</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_62"></span><span class="anchor" id="line-62"></span>            <span class="ResWord">if</span> <span class="ResWord">len</span>(<span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field</span>]) != <span class="ID">num_rows</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_63">  63</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_63"></span><span class="anchor" id="line-63"></span>                <span class="ResWord">raise</span> <span class="ID">ValueError</span>(<span class="String">&quot;</span><span class="String">field </span><span class="String">%s</span><span class="String"> has wrong number of rows</span><span class="String">&quot;</span>%<span class="ResWord">str</span>(<span class="ID">field</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_64">  64</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_64"></span><span class="anchor" id="line-64"></span>        <span class="ResWord">self</span>.<span class="ID">num_rows</span> = <span class="ID">num_rows</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_65">  65</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_65"></span><span class="anchor" id="line-65"></span>        <span class="ResWord">if</span> <span class="ID">fields_order</span> <span class="ResWord">is</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_66">  66</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_66"></span><span class="anchor" id="line-66"></span>            <span class="ResWord">self</span>.<span class="ID">fields_order</span> = <span class="ResWord">self</span>.<span class="ID">value_dict</span>.<span class="ID">keys</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_67">  67</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_67"></span><span class="anchor" id="line-67"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_68">  68</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_68"></span><span class="anchor" id="line-68"></span>            <span class="ResWord">for</span> <span class="ID">key</span> <span class="ResWord">in</span> <span class="ID">fields_order</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_69">  69</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_69"></span><span class="anchor" id="line-69"></span>                <span class="ResWord">assert</span> <span class="ResWord">self</span>.<span class="ID">value_dict</span>.<span class="ID">has_key</span>(<span class="ID">key</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_70">  70</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_70"></span><span class="anchor" id="line-70"></span>            <span class="ResWord">self</span>.<span class="ID">fields_order</span> = <span class="ID">fields_order</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_71">  71</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_71"></span><span class="anchor" id="line-71"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_72">  72</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_72"></span><span class="anchor" id="line-72"></span>    <span class="ResWord">def</span> <span class="ID">copy_empty</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_73">  73</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_73"></span><span class="anchor" id="line-73"></span>        <span class="ID">vd</span> = {}</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_74">  74</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_74"></span><span class="anchor" id="line-74"></span>        <span class="ResWord">for</span> <span class="ID">k</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">value_dict</span>.<span class="ID">keys</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_75">  75</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_75"></span><span class="anchor" id="line-75"></span>            <span class="ID">vd</span>[<span class="ID">k</span>] = <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_76">  76</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_76"></span><span class="anchor" id="line-76"></span>        <span class="ResWord">return</span> <span class="ID">DataFrame</span>(<span class="ID">vd</span>,<span class="ResWord">self</span>.<span class="ID">fields_order</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_77">  77</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_77"></span><span class="anchor" id="line-77"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_78">  78</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_78"></span><span class="anchor" id="line-78"></span>    <span class="ResWord">def</span> <span class="ID">__add__</span>(<span class="ResWord">self</span>,<span class="ID">other</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_79">  79</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_79"></span><span class="anchor" id="line-79"></span>        <span class="ID">nd</span> = {}</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_80">  80</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_80"></span><span class="anchor" id="line-80"></span>        <span class="ResWord">for</span> <span class="ID">k</span> <span class="ResWord">in</span> <span class="ID">other</span>.<span class="ID">fields_order</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_81">  81</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_81"></span><span class="anchor" id="line-81"></span>            <span class="ResWord">if</span> <span class="ID">k</span> <span class="ResWord">not</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">fields_order</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_82">  82</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_82"></span><span class="anchor" id="line-82"></span>                <span class="ResWord">raise</span> <span class="ID">NotImplementedError</span>(<span class="String">&quot;</span><span class="String">no fix yet for when not all fields are in both frames</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_83">  83</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_83"></span><span class="anchor" id="line-83"></span>        <span class="ResWord">for</span> <span class="ID">k</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">fields_order</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_84">  84</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_84"></span><span class="anchor" id="line-84"></span>            <span class="ID">nd</span>[<span class="ID">k</span>] = <span class="ResWord">list</span>(<span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">k</span>]) + <span class="ResWord">list</span>(<span class="ID">other</span>.<span class="ID">value_dict</span>[<span class="ID">k</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_85">  85</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_85"></span><span class="anchor" id="line-85"></span>        <span class="ID">res</span> = <span class="ID">DataFrame</span>(<span class="ID">nd</span>,<span class="ResWord">self</span>.<span class="ID">fields_order</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_86">  86</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_86"></span><span class="anchor" id="line-86"></span>        <span class="ResWord">return</span> <span class="ID">res</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_87">  87</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_87"></span><span class="anchor" id="line-87"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_88">  88</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_88"></span><span class="anchor" id="line-88"></span>    <span class="ResWord">def</span> <span class="ID">insert_row</span>(<span class="ResWord">self</span>, <span class="ID">value_dict</span>, <span class="ID">new_fields_ok</span>=<span class="ResWord">False</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_89">  89</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_89"></span><span class="anchor" id="line-89"></span>        <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">new_fields_ok</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_90">  90</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_90"></span><span class="anchor" id="line-90"></span>            <span class="ResWord">for</span> <span class="ID">v</span> <span class="ResWord">in</span> <span class="ID">value_dict</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_91">  91</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_91"></span><span class="anchor" id="line-91"></span>                <span class="ResWord">assert</span>(<span class="ID">v</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">fields_order</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_92">  92</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_92"></span><span class="anchor" id="line-92"></span>            <span class="ResWord">for</span> <span class="ID">v</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">fields_order</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_93">  93</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_93"></span><span class="anchor" id="line-93"></span>                <span class="ResWord">assert</span>(<span class="ID">v</span> <span class="ResWord">in</span> <span class="ID">value_dict</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_94">  94</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_94"></span><span class="anchor" id="line-94"></span>                <span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_95">  95</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_95"></span><span class="anchor" id="line-95"></span>                    <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">v</span>].<span class="ID">append</span>( <span class="ID">value_dict</span>[<span class="ID">v</span>] )</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_96">  96</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_96"></span><span class="anchor" id="line-96"></span>                <span class="ResWord">except</span> <span class="ID">AttributeError</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_97">  97</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_97"></span><span class="anchor" id="line-97"></span>                    <span class="ID">tmp</span> = <span class="ResWord">list</span>(<span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">v</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_98">  98</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_98"></span><span class="anchor" id="line-98"></span>                    <span class="ID">tmp</span>.<span class="ID">append</span>( <span class="ID">value_dict</span>[<span class="ID">v</span>] )</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_99">  99</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_99"></span><span class="anchor" id="line-99"></span>                    <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">v</span>] = <span class="ID">tmp</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_100"> 100</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_100"></span><span class="anchor" id="line-100"></span>            <span class="ResWord">self</span>.<span class="ID">num_rows</span> += <span class="Number">1</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_101"> 101</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_101"></span><span class="anchor" id="line-101"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_102"> 102</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_102"></span><span class="anchor" id="line-102"></span>            <span class="ID">all_fields</span> = <span class="ResWord">list</span>(<span class="ID">sets</span>.<span class="ID">Set</span>(<span class="ResWord">self</span>.<span class="ID">fields_order</span>).<span class="ID">union</span>(<span class="ID">value_dict</span>.<span class="ID">keys</span>()))</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_103"> 103</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_103"></span><span class="anchor" id="line-103"></span>            <span class="ID">all_fields</span>.<span class="ID">sort</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_104"> 104</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_104"></span><span class="anchor" id="line-104"></span>            <span class="ID">all_fields</span>.<span class="ID">reverse</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_105"> 105</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_105"></span><span class="anchor" id="line-105"></span>            <span class="ResWord">for</span> <span class="ID">v</span> <span class="ResWord">in</span> <span class="ID">all_fields</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_106"> 106</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_106"></span><span class="anchor" id="line-106"></span>                <span class="ResWord">if</span> <span class="ID">v</span> <span class="ResWord">in</span> <span class="ID">value_dict</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_107"> 107</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_107"></span><span class="anchor" id="line-107"></span>                    <span class="ResWord">if</span> <span class="ID">v</span> <span class="ResWord">not</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">value_dict</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_108"> 108</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_108"></span><span class="anchor" id="line-108"></span>                        <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">v</span>] = [<span class="ResWord">None</span>]*<span class="ResWord">self</span>.<span class="ID">num_rows</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_109"> 109</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_109"></span><span class="anchor" id="line-109"></span>                    <span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_110"> 110</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_110"></span><span class="anchor" id="line-110"></span>                        <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">v</span>].<span class="ID">append</span>(<span class="ID">value_dict</span>[<span class="ID">v</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_111"> 111</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_111"></span><span class="anchor" id="line-111"></span>                    <span class="ResWord">except</span> <span class="ID">AttributeError</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_112"> 112</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_112"></span><span class="anchor" id="line-112"></span>                        <span class="ID">tmp</span> = <span class="ResWord">list</span>(<span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">v</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_113"> 113</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_113"></span><span class="anchor" id="line-113"></span>                        <span class="ID">tmp</span>.<span class="ID">append</span>( <span class="ID">value_dict</span>[<span class="ID">v</span>] )</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_114"> 114</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_114"></span><span class="anchor" id="line-114"></span>                        <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">v</span>] = <span class="ID">tmp</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_115"> 115</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_115"></span><span class="anchor" id="line-115"></span>                <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_116"> 116</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_116"></span><span class="anchor" id="line-116"></span>                    <span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_117"> 117</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_117"></span><span class="anchor" id="line-117"></span>                        <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">v</span>].<span class="ID">append</span>(<span class="ResWord">None</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_118"> 118</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_118"></span><span class="anchor" id="line-118"></span>                    <span class="ResWord">except</span> <span class="ID">AttributeError</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_119"> 119</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_119"></span><span class="anchor" id="line-119"></span>                        <span class="ID">tmp</span> = <span class="ResWord">list</span>(<span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">v</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_120"> 120</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_120"></span><span class="anchor" id="line-120"></span>                        <span class="ID">tmp</span>.<span class="ID">append</span>( <span class="ResWord">None</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_121"> 121</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_121"></span><span class="anchor" id="line-121"></span>                        <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">v</span>] = <span class="ID">tmp</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_122"> 122</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_122"></span><span class="anchor" id="line-122"></span>            <span class="ResWord">self</span>.<span class="ID">fields_order</span> = <span class="ID">all_fields</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_123"> 123</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_123"></span><span class="anchor" id="line-123"></span>            <span class="ResWord">self</span>.<span class="ID">num_rows</span> += <span class="Number">1</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_124"> 124</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_124"></span><span class="anchor" id="line-124"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_125"> 125</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_125"></span><span class="anchor" id="line-125"></span>    <span class="ResWord">def</span> <span class="ID">insert_column</span>(<span class="ResWord">self</span>, <span class="ID">field_name</span>, <span class="ID">values</span>, <span class="ID">position</span>=<span class="String">'</span><span class="String">last</span><span class="String">'</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_126"> 126</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_126"></span><span class="anchor" id="line-126"></span>        <span class="ResWord">assert</span> <span class="ResWord">len</span>(<span class="ID">values</span>) == <span class="ResWord">self</span>.<span class="ID">num_rows</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_127"> 127</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_127"></span><span class="anchor" id="line-127"></span>        <span class="ResWord">if</span> <span class="ID">position</span> == <span class="String">'</span><span class="String">last</span><span class="String">'</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_128"> 128</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_128"></span><span class="anchor" id="line-128"></span>            <span class="ResWord">self</span>.<span class="ID">fields_order</span>.<span class="ID">append</span>(<span class="ID">field_name</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_129"> 129</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_129"></span><span class="anchor" id="line-129"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_130"> 130</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_130"></span><span class="anchor" id="line-130"></span>            <span class="ResWord">self</span>.<span class="ID">fields_order</span>.<span class="ID">insert</span>(<span class="ID">position</span>,<span class="ID">field_name</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_131"> 131</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_131"></span><span class="anchor" id="line-131"></span>        <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field_name</span>] = <span class="ID">values</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_132"> 132</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_132"></span><span class="anchor" id="line-132"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_133"> 133</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_133"></span><span class="anchor" id="line-133"></span>    <span class="ResWord">def</span> <span class="ID">drop_column</span>(<span class="ResWord">self</span>, <span class="ID">field_name</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_134"> 134</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_134"></span><span class="anchor" id="line-134"></span>        <span class="ResWord">self</span>.<span class="ID">fields_order</span>.<span class="ID">remove</span>(<span class="ID">field_name</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_135"> 135</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_135"></span><span class="anchor" id="line-135"></span>        <span class="ResWord">del</span> <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field_name</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_136"> 136</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_136"></span><span class="anchor" id="line-136"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_137"> 137</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_137"></span><span class="anchor" id="line-137"></span>    <span class="ResWord">def</span> <span class="ID">drop_all_columns_except</span>(<span class="ResWord">self</span>, *<span class="ID">field_names</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_138"> 138</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_138"></span><span class="anchor" id="line-138"></span>        <span class="ID">save_names</span> = <span class="ResWord">list</span>(<span class="ID">field_names</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_139"> 139</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_139"></span><span class="anchor" id="line-139"></span>	<span class="ResWord">for</span> <span class="ID">field_name</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">fields_order</span>[:]:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_140"> 140</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_140"></span><span class="anchor" id="line-140"></span>            <span class="ResWord">if</span> <span class="ID">field_name</span> <span class="ResWord">not</span> <span class="ResWord">in</span> <span class="ID">save_names</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_141"> 141</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_141"></span><span class="anchor" id="line-141"></span>                <span class="ResWord">self</span>.<span class="ID">drop_column</span>( <span class="ID">field_name</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_142"> 142</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_142"></span><span class="anchor" id="line-142"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_143"> 143</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_143"></span><span class="anchor" id="line-143"></span>    <span class="ResWord">def</span> <span class="ID">__str__</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_144"> 144</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_144"></span><span class="anchor" id="line-144"></span>        <span class="ResWord">def</span> <span class="ID">cc</span>(<span class="ID">s</span>,<span class="ID">width</span>=<span class="Number">10</span>,<span class="ID">just</span>=<span class="String">'</span><span class="String">center</span><span class="String">'</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_145"> 145</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_145"></span><span class="anchor" id="line-145"></span>            <span class="ResWord">if</span> <span class="ResWord">len</span>(<span class="ID">s</span>) &gt; <span class="ID">width</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_146"> 146</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_146"></span><span class="anchor" id="line-146"></span>                <span class="ID">s</span> = <span class="ID">s</span>[:<span class="ID">width</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_147"> 147</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_147"></span><span class="anchor" id="line-147"></span>            <span class="ResWord">if</span> <span class="ID">just</span>==<span class="String">'</span><span class="String">center</span><span class="String">'</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_148"> 148</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_148"></span><span class="anchor" id="line-148"></span>                <span class="ResWord">return</span> <span class="ID">s</span>.<span class="ID">center</span>(<span class="ID">width</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_149"> 149</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_149"></span><span class="anchor" id="line-149"></span>            <span class="ResWord">elif</span> <span class="ID">just</span>==<span class="String">'</span><span class="String">left</span><span class="String">'</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_150"> 150</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_150"></span><span class="anchor" id="line-150"></span>                <span class="ResWord">return</span> <span class="ID">s</span>.<span class="ID">ljust</span>(<span class="ID">width</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_151"> 151</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_151"></span><span class="anchor" id="line-151"></span>            <span class="ResWord">elif</span> <span class="ID">just</span>==<span class="String">'</span><span class="String">right</span><span class="String">'</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_152"> 152</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_152"></span><span class="anchor" id="line-152"></span>                <span class="ResWord">return</span> <span class="ID">s</span>.<span class="ID">rjust</span>(<span class="ID">width</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_153"> 153</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_153"></span><span class="anchor" id="line-153"></span>        <span class="ID">buf</span> = <span class="ID">StringIO</span>.<span class="ID">StringIO</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_154"> 154</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_154"></span><span class="anchor" id="line-154"></span>        <span class="ResWord">print</span> &gt;&gt; <span class="ID">buf</span>, <span class="ID">cc</span>(<span class="String">'</span><span class="String">'</span>,<span class="ID">width</span>=<span class="Number">5</span>,<span class="ID">just</span>=<span class="String">'</span><span class="String">right</span><span class="String">'</span>),</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_155"> 155</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_155"></span><span class="anchor" id="line-155"></span>        <span class="ResWord">for</span> <span class="ID">field</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">fields_order</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_156"> 156</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_156"></span><span class="anchor" id="line-156"></span>            <span class="ResWord">print</span> &gt;&gt; <span class="ID">buf</span>, <span class="ID">cc</span>( <span class="ID">field</span>),</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_157"> 157</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_157"></span><span class="anchor" id="line-157"></span>        <span class="ResWord">print</span> &gt;&gt; <span class="ID">buf</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_158"> 158</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_158"></span><span class="anchor" id="line-158"></span>        <span class="ResWord">for</span> <span class="ID">row</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ResWord">self</span>.<span class="ID">num_rows</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_159"> 159</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_159"></span><span class="anchor" id="line-159"></span>            <span class="ResWord">print</span> &gt;&gt; <span class="ID">buf</span>, <span class="ID">cc</span>(<span class="ResWord">str</span>(<span class="ID">row</span>),<span class="ID">width</span>=<span class="Number">5</span>,<span class="ID">just</span>=<span class="String">'</span><span class="String">right</span><span class="String">'</span>), <span class="Comment"># row number</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_160"> 160</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_160"></span><span class="anchor" id="line-160"></span>            <span class="ResWord">for</span> <span class="ID">field</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">fields_order</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_161"> 161</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_161"></span><span class="anchor" id="line-161"></span>                <span class="ID">v</span> = <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field</span>][<span class="ID">row</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_162"> 162</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_162"></span><span class="anchor" id="line-162"></span>                <span class="ResWord">if</span> <span class="ID">v</span> <span class="ResWord">is</span> <span class="ResWord">not</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_163"> 163</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_163"></span><span class="anchor" id="line-163"></span>                    <span class="ID">v_str</span> = <span class="ResWord">str</span>(<span class="ID">v</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_164"> 164</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_164"></span><span class="anchor" id="line-164"></span>                <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_165"> 165</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_165"></span><span class="anchor" id="line-165"></span>                    <span class="ID">v_str</span> = <span class="String">'</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_166"> 166</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_166"></span><span class="anchor" id="line-166"></span>                <span class="ResWord">print</span> &gt;&gt; <span class="ID">buf</span>, <span class="ID">cc</span>( <span class="ID">v_str</span> ),</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_167"> 167</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_167"></span><span class="anchor" id="line-167"></span>            <span class="ResWord">print</span> &gt;&gt; <span class="ID">buf</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_168"> 168</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_168"></span><span class="anchor" id="line-168"></span>        <span class="ID">buf</span>.<span class="ID">seek</span>(<span class="Number">0</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_169"> 169</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_169"></span><span class="anchor" id="line-169"></span>        <span class="ResWord">return</span> <span class="ID">buf</span>.<span class="ID">read</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_170"> 170</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_170"></span><span class="anchor" id="line-170"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_171"> 171</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_171"></span><span class="anchor" id="line-171"></span>    <span class="ResWord">def</span> <span class="ID">get_row_dict</span>(<span class="ResWord">self</span>,<span class="ID">row_idx</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_172"> 172</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_172"></span><span class="anchor" id="line-172"></span>        <span class="ResWord">return</span> <span class="ResWord">self</span>[<span class="ID">row_idx</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_173"> 173</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_173"></span><span class="anchor" id="line-173"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_174"> 174</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_174"></span><span class="anchor" id="line-174"></span>    <span class="ResWord">def</span> <span class="ID">__getitem__</span>(<span class="ResWord">self</span>, <span class="ID">i</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_175"> 175</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_175"></span><span class="anchor" id="line-175"></span>        <span class="ID">result</span> = {}</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_176"> 176</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_176"></span><span class="anchor" id="line-176"></span>        <span class="ResWord">for</span> <span class="ID">field</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">fields_order</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_177"> 177</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_177"></span><span class="anchor" id="line-177"></span>            <span class="ID">result</span>[<span class="ID">field</span>] = <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field</span>][<span class="ID">i</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_178"> 178</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_178"></span><span class="anchor" id="line-178"></span>        <span class="ResWord">return</span> <span class="ID">result</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_179"> 179</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_179"></span><span class="anchor" id="line-179"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_180"> 180</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_180"></span><span class="anchor" id="line-180"></span>    <span class="ResWord">def</span> <span class="ID">__getitems__</span>(<span class="ResWord">self</span>, <span class="ID">idxs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_181"> 181</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_181"></span><span class="anchor" id="line-181"></span>        <span class="ID">result</span> = []</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_182"> 182</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_182"></span><span class="anchor" id="line-182"></span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ID">idxs</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_183"> 183</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_183"></span><span class="anchor" id="line-183"></span>            <span class="ID">result</span>.<span class="ID">append</span>( <span class="ResWord">self</span>[<span class="ID">i</span>] )</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_184"> 184</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_184"></span><span class="anchor" id="line-184"></span>        <span class="ResWord">return</span> <span class="ID">result</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_185"> 185</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_185"></span><span class="anchor" id="line-185"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_186"> 186</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_186"></span><span class="anchor" id="line-186"></span>    <span class="ResWord">def</span> <span class="ID">__len__</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_187"> 187</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_187"></span><span class="anchor" id="line-187"></span>        <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">num_rows</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_188"> 188</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_188"></span><span class="anchor" id="line-188"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_189"> 189</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_189"></span><span class="anchor" id="line-189"></span>    <span class="ResWord">def</span> <span class="ID">__get_row</span>(<span class="ResWord">self</span>,<span class="ID">row_idx</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_190"> 190</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_190"></span><span class="anchor" id="line-190"></span>        <span class="ID">result</span> = []</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_191"> 191</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_191"></span><span class="anchor" id="line-191"></span>        <span class="ResWord">for</span> <span class="ID">field</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">fields_order</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_192"> 192</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_192"></span><span class="anchor" id="line-192"></span>            <span class="ID">result</span>.<span class="ID">append</span>( <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field</span>][<span class="ID">row_idx</span>] )</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_193"> 193</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_193"></span><span class="anchor" id="line-193"></span>        <span class="ResWord">return</span> <span class="ID">result</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_194"> 194</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_194"></span><span class="anchor" id="line-194"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_195"> 195</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_195"></span><span class="anchor" id="line-195"></span>    <span class="ResWord">def</span> <span class="ID">__get_rows</span>(<span class="ResWord">self</span>,<span class="ID">row_idxs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_196"> 196</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_196"></span><span class="anchor" id="line-196"></span>        <span class="ResWord">if</span> <span class="ResWord">len</span>(<span class="ID">row_idxs</span>) == <span class="Number">0</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_197"> 197</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_197"></span><span class="anchor" id="line-197"></span>            <span class="ResWord">return</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_198"> 198</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_198"></span><span class="anchor" id="line-198"></span>        <span class="ID">rows</span> = [<span class="ResWord">self</span>.<span class="ID">__get_row</span>(<span class="ID">row_idx</span>) <span class="ResWord">for</span> <span class="ID">row_idx</span> <span class="ResWord">in</span> <span class="ID">row_idxs</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_199"> 199</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_199"></span><span class="anchor" id="line-199"></span>        <span class="ID">by_col</span> = <span class="ResWord">zip</span>(*<span class="ID">rows</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_200"> 200</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_200"></span><span class="anchor" id="line-200"></span>        <span class="ID">result</span> = {}</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_201"> 201</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_201"></span><span class="anchor" id="line-201"></span>        <span class="ResWord">for</span> <span class="ID">i</span>,<span class="ID">field</span> <span class="ResWord">in</span> <span class="ResWord">enumerate</span>(<span class="ResWord">self</span>.<span class="ID">fields_order</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_202"> 202</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_202"></span><span class="anchor" id="line-202"></span>            <span class="ID">result</span>[<span class="ID">field</span>] = <span class="ID">by_col</span>[<span class="ID">i</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_203"> 203</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_203"></span><span class="anchor" id="line-203"></span>        <span class="ResWord">return</span> <span class="ID">result</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_204"> 204</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_204"></span><span class="anchor" id="line-204"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_205"> 205</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_205"></span><span class="anchor" id="line-205"></span>    <span class="ResWord">def</span> <span class="ID">where_field_cmp</span>(<span class="ResWord">self</span>, <span class="ID">field</span>, <span class="ID">bool_func_of_value</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_206"> 206</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_206"></span><span class="anchor" id="line-206"></span>        <span class="ID">col</span> = <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_207"> 207</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_207"></span><span class="anchor" id="line-207"></span>        <span class="ID">indices</span> = []</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_208"> 208</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_208"></span><span class="anchor" id="line-208"></span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ResWord">len</span>(<span class="ID">col</span>)):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_209"> 209</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_209"></span><span class="anchor" id="line-209"></span>            <span class="ResWord">if</span> <span class="ID">bool_func_of_value</span>(<span class="ID">col</span>[<span class="ID">i</span>]):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_210"> 210</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_210"></span><span class="anchor" id="line-210"></span>                <span class="ID">indices</span>.<span class="ID">append</span>(<span class="ID">i</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_211"> 211</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_211"></span><span class="anchor" id="line-211"></span>        <span class="ID">results</span> = <span class="ResWord">self</span>.<span class="ID">__get_rows</span>(<span class="ID">indices</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_212"> 212</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_212"></span><span class="anchor" id="line-212"></span>        <span class="ResWord">if</span> <span class="ID">results</span> <span class="ResWord">is</span> <span class="ResWord">not</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_213"> 213</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_213"></span><span class="anchor" id="line-213"></span>            <span class="ResWord">return</span> <span class="ID">DataFrame</span>(<span class="ID">results</span>,<span class="ID">fields_order</span>=<span class="ResWord">self</span>.<span class="ID">fields_order</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_214"> 214</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_214"></span><span class="anchor" id="line-214"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_215"> 215</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_215"></span><span class="anchor" id="line-215"></span>            <span class="ResWord">return</span> <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_216"> 216</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_216"></span><span class="anchor" id="line-216"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_217"> 217</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_217"></span><span class="anchor" id="line-217"></span>    <span class="ResWord">def</span> <span class="ID">where_field_equal</span>(<span class="ResWord">self</span>, <span class="ID">field</span>, <span class="ID">value</span>, <span class="ID">eps</span>=<span class="ResWord">None</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_218"> 218</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_218"></span><span class="anchor" id="line-218"></span>        <span class="ID">col</span> = <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_219"> 219</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_219"></span><span class="anchor" id="line-219"></span>        <span class="ID">indices</span> = []</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_220"> 220</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_220"></span><span class="anchor" id="line-220"></span>        <span class="ResWord">if</span> <span class="ID">eps</span> <span class="ResWord">is</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_221"> 221</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_221"></span><span class="anchor" id="line-221"></span>            <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ResWord">len</span>(<span class="ID">col</span>)):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_222"> 222</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_222"></span><span class="anchor" id="line-222"></span>                <span class="ResWord">if</span> <span class="ID">col</span>[<span class="ID">i</span>] == <span class="ID">value</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_223"> 223</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_223"></span><span class="anchor" id="line-223"></span>                    <span class="ID">indices</span>.<span class="ID">append</span>(<span class="ID">i</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_224"> 224</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_224"></span><span class="anchor" id="line-224"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_225"> 225</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_225"></span><span class="anchor" id="line-225"></span>            <span class="Comment"># this is probably faster because it assumes data is numeric</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_226"> 226</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_226"></span><span class="anchor" id="line-226"></span>            <span class="ID">a</span> = <span class="ID">asarray</span>(<span class="ID">col</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_227"> 227</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_227"></span><span class="anchor" id="line-227"></span>            <span class="ID">abs_diff</span> = <span class="ResWord">abs</span>(<span class="ID">a</span>-<span class="ID">value</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_228"> 228</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_228"></span><span class="anchor" id="line-228"></span>            <span class="ID">indices</span> = <span class="ID">nonzero</span>( <span class="ID">less</span>( <span class="ID">abs_diff</span>, <span class="ID">eps</span> ) )</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_229"> 229</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_229"></span><span class="anchor" id="line-229"></span>        <span class="ID">results</span> = <span class="ResWord">self</span>.<span class="ID">__get_rows</span>(<span class="ID">indices</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_230"> 230</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_230"></span><span class="anchor" id="line-230"></span>        <span class="ResWord">if</span> <span class="ID">results</span> <span class="ResWord">is</span> <span class="ResWord">not</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_231"> 231</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_231"></span><span class="anchor" id="line-231"></span>            <span class="ResWord">return</span> <span class="ID">DataFrame</span>(<span class="ID">results</span>,<span class="ID">fields_order</span>=<span class="ResWord">self</span>.<span class="ID">fields_order</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_232"> 232</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_232"></span><span class="anchor" id="line-232"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_233"> 233</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_233"></span><span class="anchor" id="line-233"></span>            <span class="ResWord">return</span> <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_234"> 234</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_234"></span><span class="anchor" id="line-234"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_235"> 235</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_235"></span><span class="anchor" id="line-235"></span>    <span class="ResWord">def</span> <span class="ID">where_field_not_equal</span>(<span class="ResWord">self</span>, <span class="ID">field</span>, <span class="ID">value</span>, <span class="ID">eps</span>=<span class="ResWord">None</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_236"> 236</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_236"></span><span class="anchor" id="line-236"></span>        <span class="ID">col</span> = <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_237"> 237</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_237"></span><span class="anchor" id="line-237"></span>        <span class="ID">indices</span> = []</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_238"> 238</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_238"></span><span class="anchor" id="line-238"></span>        <span class="ResWord">if</span> <span class="ID">eps</span> <span class="ResWord">is</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_239"> 239</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_239"></span><span class="anchor" id="line-239"></span>            <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ResWord">len</span>(<span class="ID">col</span>)):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_240"> 240</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_240"></span><span class="anchor" id="line-240"></span>                <span class="ResWord">if</span> <span class="ID">col</span>[<span class="ID">i</span>] != <span class="ID">value</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_241"> 241</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_241"></span><span class="anchor" id="line-241"></span>                    <span class="ID">indices</span>.<span class="ID">append</span>(<span class="ID">i</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_242"> 242</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_242"></span><span class="anchor" id="line-242"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_243"> 243</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_243"></span><span class="anchor" id="line-243"></span>            <span class="Comment"># this is probably faster because it assumes data is numeric</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_244"> 244</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_244"></span><span class="anchor" id="line-244"></span>            <span class="ID">a</span> = <span class="ID">numpy</span>.<span class="ID">asarray</span>(<span class="ID">col</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_245"> 245</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_245"></span><span class="anchor" id="line-245"></span>            <span class="ID">abs_diff</span> = <span class="ResWord">abs</span>(<span class="ID">a</span>-<span class="ID">value</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_246"> 246</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_246"></span><span class="anchor" id="line-246"></span>            <span class="ID">indices</span> = <span class="ID">numpy</span>.<span class="ID">nonzero</span>( <span class="ID">numpy</span>.<span class="ID">greater_equal</span>( <span class="ID">abs_diff</span>, <span class="ID">eps</span> ) )</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_247"> 247</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_247"></span><span class="anchor" id="line-247"></span>        <span class="ID">results</span> = <span class="ResWord">self</span>.<span class="ID">__get_rows</span>(<span class="ID">indices</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_248"> 248</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_248"></span><span class="anchor" id="line-248"></span>        <span class="ResWord">if</span> <span class="ID">results</span> <span class="ResWord">is</span> <span class="ResWord">not</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_249"> 249</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_249"></span><span class="anchor" id="line-249"></span>            <span class="ResWord">return</span> <span class="ID">DataFrame</span>(<span class="ID">results</span>,<span class="ID">fields_order</span>=<span class="ResWord">self</span>.<span class="ID">fields_order</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_250"> 250</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_250"></span><span class="anchor" id="line-250"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_251"> 251</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_251"></span><span class="anchor" id="line-251"></span>            <span class="ResWord">return</span> <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_252"> 252</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_252"></span><span class="anchor" id="line-252"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_253"> 253</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_253"></span><span class="anchor" id="line-253"></span>    <span class="ResWord">def</span> <span class="ID">where_field_less</span>(<span class="ResWord">self</span>, <span class="ID">field</span>, <span class="ID">value</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_254"> 254</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_254"></span><span class="anchor" id="line-254"></span>        <span class="ID">col</span> = <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_255"> 255</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_255"></span><span class="anchor" id="line-255"></span>        <span class="ID">indices</span> = []</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_256"> 256</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_256"></span><span class="anchor" id="line-256"></span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ResWord">len</span>(<span class="ID">col</span>)):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_257"> 257</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_257"></span><span class="anchor" id="line-257"></span>            <span class="ResWord">if</span> <span class="ID">col</span>[<span class="ID">i</span>] &lt; <span class="ID">value</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_258"> 258</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_258"></span><span class="anchor" id="line-258"></span>                <span class="ID">indices</span>.<span class="ID">append</span>(<span class="ID">i</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_259"> 259</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_259"></span><span class="anchor" id="line-259"></span>        <span class="ID">results</span> = <span class="ResWord">self</span>.<span class="ID">__get_rows</span>(<span class="ID">indices</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_260"> 260</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_260"></span><span class="anchor" id="line-260"></span>        <span class="ResWord">if</span> <span class="ID">results</span> <span class="ResWord">is</span> <span class="ResWord">not</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_261"> 261</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_261"></span><span class="anchor" id="line-261"></span>            <span class="ResWord">return</span> <span class="ID">DataFrame</span>(<span class="ID">results</span>,<span class="ID">fields_order</span>=<span class="ResWord">self</span>.<span class="ID">fields_order</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_262"> 262</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_262"></span><span class="anchor" id="line-262"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_263"> 263</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_263"></span><span class="anchor" id="line-263"></span>            <span class="ResWord">return</span> <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_264"> 264</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_264"></span><span class="anchor" id="line-264"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_265"> 265</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_265"></span><span class="anchor" id="line-265"></span>    <span class="ResWord">def</span> <span class="ID">where_field_lessequal</span>(<span class="ResWord">self</span>, <span class="ID">field</span>, <span class="ID">value</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_266"> 266</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_266"></span><span class="anchor" id="line-266"></span>        <span class="ID">col</span> = <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_267"> 267</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_267"></span><span class="anchor" id="line-267"></span>        <span class="ID">indices</span> = []</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_268"> 268</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_268"></span><span class="anchor" id="line-268"></span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ResWord">len</span>(<span class="ID">col</span>)):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_269"> 269</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_269"></span><span class="anchor" id="line-269"></span>            <span class="ResWord">if</span> <span class="ID">col</span>[<span class="ID">i</span>] &lt;= <span class="ID">value</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_270"> 270</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_270"></span><span class="anchor" id="line-270"></span>                <span class="ID">indices</span>.<span class="ID">append</span>(<span class="ID">i</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_271"> 271</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_271"></span><span class="anchor" id="line-271"></span>        <span class="ID">results</span> = <span class="ResWord">self</span>.<span class="ID">__get_rows</span>(<span class="ID">indices</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_272"> 272</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_272"></span><span class="anchor" id="line-272"></span>        <span class="ResWord">if</span> <span class="ID">results</span> <span class="ResWord">is</span> <span class="ResWord">not</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_273"> 273</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_273"></span><span class="anchor" id="line-273"></span>            <span class="ResWord">return</span> <span class="ID">DataFrame</span>(<span class="ID">results</span>,<span class="ID">fields_order</span>=<span class="ResWord">self</span>.<span class="ID">fields_order</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_274"> 274</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_274"></span><span class="anchor" id="line-274"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_275"> 275</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_275"></span><span class="anchor" id="line-275"></span>            <span class="ResWord">return</span> <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_276"> 276</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_276"></span><span class="anchor" id="line-276"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_277"> 277</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_277"></span><span class="anchor" id="line-277"></span>    <span class="ResWord">def</span> <span class="ID">where_field_greater</span>(<span class="ResWord">self</span>, <span class="ID">field</span>, <span class="ID">value</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_278"> 278</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_278"></span><span class="anchor" id="line-278"></span>        <span class="ID">col</span> = <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_279"> 279</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_279"></span><span class="anchor" id="line-279"></span>        <span class="ID">indices</span> = []</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_280"> 280</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_280"></span><span class="anchor" id="line-280"></span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ResWord">len</span>(<span class="ID">col</span>)):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_281"> 281</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_281"></span><span class="anchor" id="line-281"></span>            <span class="ResWord">if</span> <span class="ID">col</span>[<span class="ID">i</span>] &gt; <span class="ID">value</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_282"> 282</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_282"></span><span class="anchor" id="line-282"></span>                <span class="ID">indices</span>.<span class="ID">append</span>(<span class="ID">i</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_283"> 283</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_283"></span><span class="anchor" id="line-283"></span>        <span class="ID">results</span> = <span class="ResWord">self</span>.<span class="ID">__get_rows</span>(<span class="ID">indices</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_284"> 284</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_284"></span><span class="anchor" id="line-284"></span>        <span class="ResWord">if</span> <span class="ID">results</span> <span class="ResWord">is</span> <span class="ResWord">not</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_285"> 285</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_285"></span><span class="anchor" id="line-285"></span>            <span class="ResWord">return</span> <span class="ID">DataFrame</span>(<span class="ID">results</span>,<span class="ID">fields_order</span>=<span class="ResWord">self</span>.<span class="ID">fields_order</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_286"> 286</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_286"></span><span class="anchor" id="line-286"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_287"> 287</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_287"></span><span class="anchor" id="line-287"></span>            <span class="ResWord">return</span> <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_288"> 288</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_288"></span><span class="anchor" id="line-288"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_289"> 289</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_289"></span><span class="anchor" id="line-289"></span>    <span class="ResWord">def</span> <span class="ID">where_field_greaterequal</span>(<span class="ResWord">self</span>, <span class="ID">field</span>, <span class="ID">value</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_290"> 290</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_290"></span><span class="anchor" id="line-290"></span>        <span class="ID">col</span> = <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_291"> 291</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_291"></span><span class="anchor" id="line-291"></span>        <span class="ID">indices</span> = []</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_292"> 292</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_292"></span><span class="anchor" id="line-292"></span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ResWord">len</span>(<span class="ID">col</span>)):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_293"> 293</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_293"></span><span class="anchor" id="line-293"></span>            <span class="ResWord">if</span> <span class="ID">col</span>[<span class="ID">i</span>] &gt;= <span class="ID">value</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_294"> 294</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_294"></span><span class="anchor" id="line-294"></span>                <span class="ID">indices</span>.<span class="ID">append</span>(<span class="ID">i</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_295"> 295</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_295"></span><span class="anchor" id="line-295"></span>        <span class="ID">results</span> = <span class="ResWord">self</span>.<span class="ID">__get_rows</span>(<span class="ID">indices</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_296"> 296</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_296"></span><span class="anchor" id="line-296"></span>        <span class="ResWord">if</span> <span class="ID">results</span> <span class="ResWord">is</span> <span class="ResWord">not</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_297"> 297</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_297"></span><span class="anchor" id="line-297"></span>            <span class="ResWord">return</span> <span class="ID">DataFrame</span>(<span class="ID">results</span>,<span class="ID">fields_order</span>=<span class="ResWord">self</span>.<span class="ID">fields_order</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_298"> 298</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_298"></span><span class="anchor" id="line-298"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_299"> 299</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_299"></span><span class="anchor" id="line-299"></span>            <span class="ResWord">return</span> <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_300"> 300</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_300"></span><span class="anchor" id="line-300"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_301"> 301</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_301"></span><span class="anchor" id="line-301"></span>    <span class="ResWord">def</span> <span class="ID">where_field_in</span>(<span class="ResWord">self</span>, <span class="ID">field</span>, <span class="ID">values</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_302"> 302</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_302"></span><span class="anchor" id="line-302"></span>        <span class="ID">col</span> = <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_303"> 303</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_303"></span><span class="anchor" id="line-303"></span>        <span class="ID">indices</span> = []</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_304"> 304</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_304"></span><span class="anchor" id="line-304"></span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ResWord">len</span>(<span class="ID">col</span>)):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_305"> 305</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_305"></span><span class="anchor" id="line-305"></span>            <span class="ResWord">if</span> <span class="ID">col</span>[<span class="ID">i</span>] <span class="ResWord">in</span> <span class="ID">values</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_306"> 306</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_306"></span><span class="anchor" id="line-306"></span>                <span class="ID">indices</span>.<span class="ID">append</span>(<span class="ID">i</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_307"> 307</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_307"></span><span class="anchor" id="line-307"></span>        <span class="ID">results</span> = <span class="ResWord">self</span>.<span class="ID">__get_rows</span>(<span class="ID">indices</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_308"> 308</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_308"></span><span class="anchor" id="line-308"></span>        <span class="ResWord">if</span> <span class="ID">results</span> <span class="ResWord">is</span> <span class="ResWord">not</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_309"> 309</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_309"></span><span class="anchor" id="line-309"></span>            <span class="ResWord">return</span> <span class="ID">DataFrame</span>(<span class="ID">results</span>,<span class="ID">fields_order</span>=<span class="ResWord">self</span>.<span class="ID">fields_order</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_310"> 310</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_310"></span><span class="anchor" id="line-310"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_311"> 311</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_311"></span><span class="anchor" id="line-311"></span>            <span class="ResWord">return</span> <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_312"> 312</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_312"></span><span class="anchor" id="line-312"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_313"> 313</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_313"></span><span class="anchor" id="line-313"></span>    <span class="ResWord">def</span> <span class="ID">enumerate_on</span>(<span class="ResWord">self</span>, <span class="ID">field</span>, <span class="ID">cmp_func</span>=<span class="ResWord">None</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_314"> 314</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_314"></span><span class="anchor" id="line-314"></span>        <span class="ID">values</span> = <span class="ResWord">self</span>.<span class="ID">get_unique_values</span>(<span class="ID">field</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_315"> 315</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_315"></span><span class="anchor" id="line-315"></span>        <span class="ID">result_frames</span> = []</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_316"> 316</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_316"></span><span class="anchor" id="line-316"></span>        <span class="ID">values</span>.<span class="ID">sort</span>(<span class="ID">cmp_func</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_317"> 317</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_317"></span><span class="anchor" id="line-317"></span>        <span class="ResWord">for</span> <span class="ID">value</span> <span class="ResWord">in</span> <span class="ID">values</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_318"> 318</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_318"></span><span class="anchor" id="line-318"></span>            <span class="ID">result_frames</span>.<span class="ID">append</span>( (<span class="ID">value</span>, <span class="ResWord">self</span>.<span class="ID">where_field_equal</span>(<span class="ID">field</span>,<span class="ID">value</span>)))</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_319"> 319</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_319"></span><span class="anchor" id="line-319"></span>        <span class="ResWord">return</span> <span class="ResWord">iter</span>(<span class="ID">result_frames</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_320"> 320</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_320"></span><span class="anchor" id="line-320"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_321"> 321</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_321"></span><span class="anchor" id="line-321"></span>    <span class="ResWord">def</span> <span class="ID">enumerate_crude_bins</span>(<span class="ResWord">self</span>, <span class="ID">field</span>, <span class="ID">eps</span>=<span class="ResWord">None</span>, <span class="ID">eps_domain</span>=<span class="String">'</span><span class="String">linear</span><span class="String">'</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_322"> 322</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_322"></span><span class="anchor" id="line-322"></span>        <span class="ResWord">if</span> <span class="ID">eps</span> <span class="ResWord">is</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_323"> 323</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_323"></span><span class="anchor" id="line-323"></span>            <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">enumerate_on</span>(<span class="ID">field</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_324"> 324</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_324"></span><span class="anchor" id="line-324"></span>        <span class="ResWord">if</span> <span class="ID">eps_domain</span> == <span class="String">'</span><span class="String">linear</span><span class="String">'</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_325"> 325</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_325"></span><span class="anchor" id="line-325"></span>            <span class="ResWord">def</span> <span class="ID">filt</span>(<span class="ID">x</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_326"> 326</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_326"></span><span class="anchor" id="line-326"></span>                <span class="ResWord">return</span> <span class="ID">x</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_327"> 327</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_327"></span><span class="anchor" id="line-327"></span>        <span class="ResWord">elif</span> <span class="ID">eps_domain</span> == <span class="String">'</span><span class="String">log10</span><span class="String">'</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_328"> 328</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_328"></span><span class="anchor" id="line-328"></span>            <span class="ResWord">def</span> <span class="ID">filt</span>(<span class="ID">x</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_329"> 329</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_329"></span><span class="anchor" id="line-329"></span>                <span class="ResWord">return</span> <span class="ID">numpy</span>.<span class="ID">log10</span>(<span class="ID">x</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_330"> 330</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_330"></span><span class="anchor" id="line-330"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_331"> 331</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_331"></span><span class="anchor" id="line-331"></span>            <span class="ResWord">raise</span> <span class="ID">NotImplementedError</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_332"> 332</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_332"></span><span class="anchor" id="line-332"></span>        <span class="ID">vs</span> = <span class="ResWord">self</span>.<span class="ID">get_unique_values</span>(<span class="ID">field</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_333"> 333</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_333"></span><span class="anchor" id="line-333"></span>        <span class="ID">vs</span>.<span class="ID">sort</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_334"> 334</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_334"></span><span class="anchor" id="line-334"></span>        <span class="ID">bins</span> = {}</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_335"> 335</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_335"></span><span class="anchor" id="line-335"></span>        <span class="ID">current_starter_v</span> = <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_336"> 336</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_336"></span><span class="anchor" id="line-336"></span>        <span class="ResWord">for</span> <span class="ID">cv</span> <span class="ResWord">in</span> <span class="ID">vs</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_337"> 337</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_337"></span><span class="anchor" id="line-337"></span>            <span class="ResWord">if</span> <span class="ID">current_starter_v</span> <span class="ResWord">is</span> <span class="ResWord">not</span> <span class="ResWord">None</span> <span class="ResWord">and</span> <span class="ResWord">abs</span>(<span class="ID">filt</span>(<span class="ID">cv</span>)-<span class="ID">filt</span>(<span class="ID">current_starter_v</span>))&lt;<span class="ID">eps</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_338"> 338</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_338"></span><span class="anchor" id="line-338"></span>                <span class="ID">bins</span>[<span class="ID">current_starter_v</span>].<span class="ID">append</span>(<span class="ID">cv</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_339"> 339</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_339"></span><span class="anchor" id="line-339"></span>            <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_340"> 340</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_340"></span><span class="anchor" id="line-340"></span>                <span class="ID">bins</span>.<span class="ID">setdefault</span>(<span class="ID">cv</span>,[]).<span class="ID">append</span>(<span class="ID">cv</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_341"> 341</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_341"></span><span class="anchor" id="line-341"></span>                <span class="ID">current_starter_v</span> = <span class="ID">cv</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_342"> 342</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_342"></span><span class="anchor" id="line-342"></span>        <span class="ID">results</span> = []</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_343"> 343</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_343"></span><span class="anchor" id="line-343"></span>        <span class="ID">keys</span> = <span class="ID">bins</span>.<span class="ID">keys</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_344"> 344</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_344"></span><span class="anchor" id="line-344"></span>        <span class="ID">keys</span>.<span class="ID">sort</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_345"> 345</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_345"></span><span class="anchor" id="line-345"></span>        <span class="ResWord">for</span> <span class="ID">close_v</span> <span class="ResWord">in</span> <span class="ID">keys</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_346"> 346</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_346"></span><span class="anchor" id="line-346"></span>            <span class="ID">running_sum</span> = <span class="Number">0</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_347"> 347</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_347"></span><span class="anchor" id="line-347"></span>            <span class="ID">running_n</span> = <span class="Number">0</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_348"> 348</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_348"></span><span class="anchor" id="line-348"></span>            <span class="ID">accum</span> = <span class="ResWord">self</span>.<span class="ID">copy_empty</span>() <span class="Comment"># new DataFrame with same fields</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_349"> 349</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_349"></span><span class="anchor" id="line-349"></span>            <span class="ResWord">for</span> <span class="ID">v</span> <span class="ResWord">in</span> <span class="ID">bins</span>[<span class="ID">close_v</span>]:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_350"> 350</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_350"></span><span class="anchor" id="line-350"></span>                <span class="ID">add_frame</span> = <span class="ResWord">self</span>.<span class="ID">where_field_equal</span>(<span class="ID">field</span>,<span class="ID">v</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_351"> 351</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_351"></span><span class="anchor" id="line-351"></span>                <span class="ID">n</span> = <span class="ID">add_frame</span>.<span class="ID">num_rows</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_352"> 352</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_352"></span><span class="anchor" id="line-352"></span>                <span class="ID">running_sum</span> += (<span class="ID">v</span>*<span class="ID">n</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_353"> 353</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_353"></span><span class="anchor" id="line-353"></span>                <span class="ID">running_n</span> += <span class="ID">n</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_354"> 354</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_354"></span><span class="anchor" id="line-354"></span>                <span class="ID">accum</span> = <span class="ID">accum</span> + <span class="ID">add_frame</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_355"> 355</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_355"></span><span class="anchor" id="line-355"></span>            <span class="ID">avg_value</span> = <span class="ID">running_sum</span>/<span class="ResWord">float</span>(<span class="ID">running_n</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_356"> 356</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_356"></span><span class="anchor" id="line-356"></span>            <span class="ID">results</span>.<span class="ID">append</span>(( <span class="ID">avg_value</span>, <span class="ID">accum</span> ))</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_357"> 357</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_357"></span><span class="anchor" id="line-357"></span>        <span class="ResWord">return</span> <span class="ResWord">iter</span>(<span class="ID">results</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_358"> 358</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_358"></span><span class="anchor" id="line-358"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_359"> 359</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_359"></span><span class="anchor" id="line-359"></span>    <span class="ResWord">def</span> <span class="ID">enumerate_crude_2_dims</span>(<span class="ResWord">self</span>, <span class="ID">field1</span>, <span class="ID">field2</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_360"> 360</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_360"></span><span class="anchor" id="line-360"></span>                               <span class="ID">eps1</span>=<span class="ResWord">None</span>, <span class="ID">eps2</span>=<span class="ResWord">None</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_361"> 361</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_361"></span><span class="anchor" id="line-361"></span>                               <span class="ID">eps1_domain</span>=<span class="String">'</span><span class="String">linear</span><span class="String">'</span>, <span class="ID">eps2_domain</span>=<span class="String">'</span><span class="String">linear</span><span class="String">'</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_362"> 362</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_362"></span><span class="anchor" id="line-362"></span>        <span class="ID">axis1_vs</span> = {}</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_363"> 363</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_363"></span><span class="anchor" id="line-363"></span>        <span class="ResWord">for</span> <span class="ID">v</span>,<span class="ID">vf</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">enumerate_crude_bins</span>(<span class="ID">field1</span>,<span class="ID">eps</span>=<span class="ID">eps1</span>,<span class="ID">eps_domain</span>=<span class="ID">eps1_domain</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_364"> 364</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_364"></span><span class="anchor" id="line-364"></span>            <span class="ID">axis1_vs</span>[<span class="ID">v</span>] = <span class="ID">vf</span>.<span class="ID">get_unique_values</span>(<span class="ID">field1</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_365"> 365</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_365"></span><span class="anchor" id="line-365"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_366"> 366</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_366"></span><span class="anchor" id="line-366"></span>        <span class="ID">axis2_vs</span> = {}</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_367"> 367</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_367"></span><span class="anchor" id="line-367"></span>        <span class="ResWord">for</span> <span class="ID">v</span>,<span class="ID">vf</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">enumerate_crude_bins</span>(<span class="ID">field2</span>,<span class="ID">eps</span>=<span class="ID">eps2</span>,<span class="ID">eps_domain</span>=<span class="ID">eps2_domain</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_368"> 368</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_368"></span><span class="anchor" id="line-368"></span>            <span class="ID">axis2_vs</span>[<span class="ID">v</span>] = <span class="ID">vf</span>.<span class="ID">get_unique_values</span>(<span class="ID">field2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_369"> 369</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_369"></span><span class="anchor" id="line-369"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_370"> 370</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_370"></span><span class="anchor" id="line-370"></span>        <span class="ID">results</span> = []</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_371"> 371</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_371"></span><span class="anchor" id="line-371"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_372"> 372</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_372"></span><span class="anchor" id="line-372"></span>        <span class="ID">v1s</span> = <span class="ID">axis1_vs</span>.<span class="ID">keys</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_373"> 373</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_373"></span><span class="anchor" id="line-373"></span>        <span class="ID">v1s</span>.<span class="ID">sort</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_374"> 374</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_374"></span><span class="anchor" id="line-374"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_375"> 375</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_375"></span><span class="anchor" id="line-375"></span>        <span class="ID">v2s</span> = <span class="ID">axis2_vs</span>.<span class="ID">keys</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_376"> 376</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_376"></span><span class="anchor" id="line-376"></span>        <span class="ID">v2s</span>.<span class="ID">sort</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_377"> 377</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_377"></span><span class="anchor" id="line-377"></span>        <span class="ResWord">for</span> <span class="ID">v1</span> <span class="ResWord">in</span> <span class="ID">v1s</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_378"> 378</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_378"></span><span class="anchor" id="line-378"></span>            <span class="ResWord">for</span> <span class="ID">v2</span> <span class="ResWord">in</span> <span class="ID">v2s</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_379"> 379</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_379"></span><span class="anchor" id="line-379"></span>                <span class="ID">this_result</span> = <span class="ResWord">self</span>.<span class="ID">copy_empty</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_380"> 380</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_380"></span><span class="anchor" id="line-380"></span>                <span class="ResWord">for</span> <span class="ID">v1r</span> <span class="ResWord">in</span> <span class="ID">axis1_vs</span>[<span class="ID">v1</span>]:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_381"> 381</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_381"></span><span class="anchor" id="line-381"></span>                    <span class="ResWord">for</span> <span class="ID">v2r</span> <span class="ResWord">in</span> <span class="ID">axis2_vs</span>[<span class="ID">v2</span>]:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_382"> 382</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_382"></span><span class="anchor" id="line-382"></span>                        <span class="ID">tmp1</span> = <span class="ResWord">self</span>.<span class="ID">where_field_equal</span>(<span class="ID">field1</span>,<span class="ID">v1r</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_383"> 383</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_383"></span><span class="anchor" id="line-383"></span>                        <span class="ResWord">if</span> <span class="ID">tmp1</span> <span class="ResWord">is</span> <span class="ResWord">not</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_384"> 384</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_384"></span><span class="anchor" id="line-384"></span>                            <span class="ID">tmp2</span> = <span class="ID">tmp1</span>.<span class="ID">where_field_equal</span>(<span class="ID">field2</span>,<span class="ID">v2r</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_385"> 385</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_385"></span><span class="anchor" id="line-385"></span>                            <span class="ResWord">if</span> <span class="ID">tmp2</span> <span class="ResWord">is</span> <span class="ResWord">not</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_386"> 386</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_386"></span><span class="anchor" id="line-386"></span>                                <span class="ID">this_result</span> = <span class="ID">this_result</span> + <span class="ID">tmp2</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_387"> 387</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_387"></span><span class="anchor" id="line-387"></span>                <span class="ResWord">if</span> <span class="ID">this_result</span>.<span class="ID">num_rows</span> &gt; <span class="Number">0</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_388"> 388</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_388"></span><span class="anchor" id="line-388"></span>                    <span class="ID">results</span>.<span class="ID">append</span>((<span class="ID">v1</span>,<span class="ID">v2</span>,<span class="ID">this_result</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_389"> 389</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_389"></span><span class="anchor" id="line-389"></span>        <span class="ResWord">return</span> <span class="ResWord">iter</span>(<span class="ID">results</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_390"> 390</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_390"></span><span class="anchor" id="line-390"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_391"> 391</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_391"></span><span class="anchor" id="line-391"></span>    <span class="ResWord">def</span> <span class="ID">mean</span>(<span class="ResWord">self</span>, <span class="ID">field</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_392"> 392</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_392"></span><span class="anchor" id="line-392"></span>        <span class="ResWord">return</span> <span class="ID">mean</span>(<span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_393"> 393</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_393"></span><span class="anchor" id="line-393"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_394"> 394</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_394"></span><span class="anchor" id="line-394"></span>    <span class="ResWord">def</span> <span class="ID">mean_and_std</span>(<span class="ResWord">self</span>, <span class="ID">field</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_395"> 395</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_395"></span><span class="anchor" id="line-395"></span>        <span class="ID">values</span> = <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_396"> 396</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_396"></span><span class="anchor" id="line-396"></span>        <span class="ResWord">return</span> <span class="ID">mean</span>(<span class="ID">values</span>), <span class="ID">std</span>(<span class="ID">values</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_397"> 397</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_397"></span><span class="anchor" id="line-397"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_398"> 398</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_398"></span><span class="anchor" id="line-398"></span>    <span class="ResWord">def</span> <span class="ID">mean_and_sem</span>(<span class="ResWord">self</span>, <span class="ID">field</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_399"> 399</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_399"></span><span class="anchor" id="line-399"></span>        <span class="ID">values</span> = <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_400"> 400</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_400"></span><span class="anchor" id="line-400"></span>        <span class="ID">n</span> = <span class="ResWord">len</span>(<span class="ID">values</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_401"> 401</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_401"></span><span class="anchor" id="line-401"></span>        <span class="ResWord">return</span> <span class="ID">mean</span>(<span class="ID">values</span>), <span class="ID">std</span>(<span class="ID">values</span>)/<span class="ResWord">float</span>(<span class="ID">numpy</span>.<span class="ID">sqrt</span>(<span class="ID">n</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_402"> 402</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_402"></span><span class="anchor" id="line-402"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_403"> 403</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_403"></span><span class="anchor" id="line-403"></span>    <span class="ResWord">def</span> <span class="ID">get_fields</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_404"> 404</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_404"></span><span class="anchor" id="line-404"></span>        <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">fields_order</span>[:] <span class="Comment"># return copy</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_405"> 405</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_405"></span><span class="anchor" id="line-405"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_406"> 406</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_406"></span><span class="anchor" id="line-406"></span>    <span class="ResWord">def</span> <span class="ID">sort_by</span>(<span class="ResWord">self</span>,<span class="ID">field</span>,<span class="ID">ascending</span>=<span class="ResWord">True</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_407"> 407</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_407"></span><span class="anchor" id="line-407"></span>        <span class="ID">orig</span> = <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_408"> 408</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_408"></span><span class="anchor" id="line-408"></span>        <span class="ResWord">sorted</span> = <span class="ResWord">list</span>(<span class="ID">orig</span>[:]) <span class="Comment"># play with copy</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_409"> 409</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_409"></span><span class="anchor" id="line-409"></span>        <span class="ResWord">sorted</span>.<span class="ID">sort</span>() <span class="Comment"># make it sorted</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_410"> 410</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_410"></span><span class="anchor" id="line-410"></span>        <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">ascending</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_411"> 411</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_411"></span><span class="anchor" id="line-411"></span>            <span class="ResWord">sorted</span>.<span class="ID">reverse</span>() <span class="Comment"># make it sorted</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_412"> 412</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_412"></span><span class="anchor" id="line-412"></span>        <span class="ID">my_copy</span> = <span class="ResWord">list</span>(<span class="ID">orig</span>[:]) <span class="Comment"># play with copy</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_413"> 413</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_413"></span><span class="anchor" id="line-413"></span>        <span class="ID">new_order</span> = []</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_414"> 414</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_414"></span><span class="anchor" id="line-414"></span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ResWord">len</span>(<span class="ResWord">sorted</span>)):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_415"> 415</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_415"></span><span class="anchor" id="line-415"></span>            <span class="ID">sorted_value</span> = <span class="ResWord">sorted</span>[<span class="ID">i</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_416"> 416</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_416"></span><span class="anchor" id="line-416"></span>            <span class="ID">index</span> = <span class="ID">my_copy</span>.<span class="ID">index</span>( <span class="ID">sorted_value</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_417"> 417</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_417"></span><span class="anchor" id="line-417"></span>            <span class="ID">new_order</span>.<span class="ID">append</span>( <span class="ID">index</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_418"> 418</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_418"></span><span class="anchor" id="line-418"></span>            <span class="ID">my_copy</span>[<span class="ID">index</span>] = <span class="ResWord">int</span> <span class="Comment"># just set it equal to anything that can't be in list so it won't match again</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_419"> 419</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_419"></span><span class="anchor" id="line-419"></span>        <span class="ResWord">for</span> <span class="ID">field</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">fields_order</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_420"> 420</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_420"></span><span class="anchor" id="line-420"></span>            <span class="ID">orig_list</span> = <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_421"> 421</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_421"></span><span class="anchor" id="line-421"></span>            <span class="ID">new_list</span> = []</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_422"> 422</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_422"></span><span class="anchor" id="line-422"></span>            <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ID">new_order</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_423"> 423</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_423"></span><span class="anchor" id="line-423"></span>                <span class="ID">new_list</span>.<span class="ID">append</span>( <span class="ID">orig_list</span>[<span class="ID">i</span>] )</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_424"> 424</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_424"></span><span class="anchor" id="line-424"></span>            <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field</span>] = <span class="ID">new_list</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_425"> 425</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_425"></span><span class="anchor" id="line-425"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_426"> 426</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_426"></span><span class="anchor" id="line-426"></span>    <span class="ResWord">def</span> <span class="ID">sorted</span>(<span class="ResWord">self</span>,<span class="ID">field</span>,<span class="ID">ascending</span>=<span class="ResWord">True</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_427"> 427</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_427"></span><span class="anchor" id="line-427"></span>        <span class="ID">result</span> = <span class="ID">DataFrame</span>(<span class="ResWord">self</span>.<span class="ID">value_dict</span>, <span class="ResWord">self</span>.<span class="ID">fields_order</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_428"> 428</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_428"></span><span class="anchor" id="line-428"></span>        <span class="ID">result</span>.<span class="ID">sort_by</span>(<span class="ID">field</span>,<span class="ID">ascending</span>=<span class="ID">ascending</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_429"> 429</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_429"></span><span class="anchor" id="line-429"></span>        <span class="ResWord">return</span> <span class="ID">result</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_430"> 430</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_430"></span><span class="anchor" id="line-430"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_431"> 431</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_431"></span><span class="anchor" id="line-431"></span>    <span class="ResWord">def</span> <span class="ID">get_unique_values</span>(<span class="ResWord">self</span>, <span class="ID">field</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_432"> 432</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_432"></span><span class="anchor" id="line-432"></span>        <span class="ID">unique_values</span> = <span class="ResWord">list</span>(<span class="ID">sets</span>.<span class="ID">Set</span>(<span class="ResWord">self</span>.<span class="ID">get_all_values</span>(<span class="ID">field</span>)))</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_433"> 433</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_433"></span><span class="anchor" id="line-433"></span>        <span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_434"> 434</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_434"></span><span class="anchor" id="line-434"></span>            <span class="ID">unique_values</span>.<span class="ID">sort</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_435"> 435</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_435"></span><span class="anchor" id="line-435"></span>        <span class="ResWord">except</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_436"> 436</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_436"></span><span class="anchor" id="line-436"></span>            <span class="ResWord">pass</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_437"> 437</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_437"></span><span class="anchor" id="line-437"></span>        <span class="ResWord">return</span> <span class="ID">unique_values</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_438"> 438</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_438"></span><span class="anchor" id="line-438"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_439"> 439</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_439"></span><span class="anchor" id="line-439"></span>    <span class="ResWord">def</span> <span class="ID">get_all_values</span>(<span class="ResWord">self</span>, <span class="ID">field</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_440"> 440</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_440"></span><span class="anchor" id="line-440"></span>        <span class="ID">values</span> = [ <span class="ID">v</span> <span class="ResWord">for</span> <span class="ID">v</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">value_dict</span>[<span class="ID">field</span>] ]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_441"> 441</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_441"></span><span class="anchor" id="line-441"></span>        <span class="ResWord">return</span> <span class="ID">values</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_442"> 442</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_442"></span><span class="anchor" id="line-442"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_443"> 443</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_443"></span><span class="anchor" id="line-443"></span>    <span class="ResWord">def</span> <span class="ID">write_csv</span>(<span class="ResWord">self</span>,<span class="ID">filename</span>,<span class="ID">dialect</span>=<span class="String">'</span><span class="String">excel</span><span class="String">'</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_444"> 444</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_444"></span><span class="anchor" id="line-444"></span>        <span class="ID">writer</span> = <span class="ID">csv</span>.<span class="ID">writer</span>(<span class="ResWord">open</span>(<span class="ID">filename</span>,<span class="String">'</span><span class="String">w</span><span class="String">'</span>),<span class="ID">dialect</span>=<span class="ID">dialect</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_445"> 445</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_445"></span><span class="anchor" id="line-445"></span>        <span class="ID">writer</span>.<span class="ID">writerow</span>( <span class="ResWord">self</span>.<span class="ID">fields_order</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_446"> 446</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_446"></span><span class="anchor" id="line-446"></span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ResWord">self</span>.<span class="ID">num_rows</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_447"> 447</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_447"></span><span class="anchor" id="line-447"></span>            <span class="ID">writer</span>.<span class="ID">writerow</span>( <span class="ResWord">self</span>.<span class="ID">__get_row</span>(<span class="ID">i</span>) )</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_448"> 448</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_448"></span><span class="anchor" id="line-448"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_449"> 449</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_449"></span><span class="anchor" id="line-449"></span><span class="ResWord">def</span> <span class="ID">read_csv</span>(<span class="ResWord">file</span>,<span class="ID">header</span>=<span class="ResWord">True</span>,<span class="ID">dialect</span>=<span class="String">'</span><span class="String">excel</span><span class="String">'</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_450"> 450</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_450"></span><span class="anchor" id="line-450"></span>    <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ResWord">hasattr</span>(<span class="ResWord">file</span>,<span class="String">'</span><span class="String">readlines</span><span class="String">'</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_451"> 451</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_451"></span><span class="anchor" id="line-451"></span>        <span class="Comment"># inspired by R's read.csv</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_452"> 452</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_452"></span><span class="anchor" id="line-452"></span>        <span class="ID">reader</span> = <span class="ID">csv</span>.<span class="ID">reader</span>(<span class="ResWord">open</span>(<span class="ResWord">file</span>,<span class="String">&quot;</span><span class="String">r</span><span class="String">&quot;</span>),<span class="ID">dialect</span>=<span class="ID">dialect</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_453"> 453</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_453"></span><span class="anchor" id="line-453"></span>    <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_454"> 454</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_454"></span><span class="anchor" id="line-454"></span>        <span class="ID">reader</span> = <span class="ID">csv</span>.<span class="ID">reader</span>(<span class="ResWord">file</span>,<span class="ID">dialect</span>=<span class="ID">dialect</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_455"> 455</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_455"></span><span class="anchor" id="line-455"></span>    <span class="ID">split_lines</span> = [ <span class="ID">row</span> <span class="ResWord">for</span> <span class="ID">row</span> <span class="ResWord">in</span> <span class="ID">reader</span> ] <span class="Comment"># newline problems sometimes happen here - de-Macify...</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_456"> 456</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_456"></span><span class="anchor" id="line-456"></span>    <span class="ResWord">if</span> <span class="ID">header</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_457"> 457</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_457"></span><span class="anchor" id="line-457"></span>        <span class="ID">fields</span> = <span class="ID">split_lines</span>.<span class="ID">pop</span>(<span class="Number">0</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_458"> 458</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_458"></span><span class="anchor" id="line-458"></span>    <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_459"> 459</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_459"></span><span class="anchor" id="line-459"></span>        <span class="ID">num_fields</span> = <span class="ResWord">len</span>(<span class="ID">split_lines</span>[<span class="Number">0</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_460"> 460</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_460"></span><span class="anchor" id="line-460"></span>        <span class="ID">num_chars</span> = <span class="ResWord">int</span>(<span class="ID">math</span>.<span class="ID">ceil</span>(<span class="ID">math</span>.<span class="ID">log10</span>(<span class="ID">num_fields</span>)))</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_461"> 461</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_461"></span><span class="anchor" id="line-461"></span>        <span class="ID">name_string</span> = <span class="String">&quot;</span><span class="String">column</span><span class="String">%</span><span class="String">0</span><span class="String">&quot;</span>+<span class="ResWord">str</span>(<span class="ID">num_chars</span>)+<span class="String">&quot;</span><span class="String">d</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_462"> 462</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_462"></span><span class="anchor" id="line-462"></span>        <span class="ID">fields</span> = [ <span class="ID">name_string</span>%(<span class="ID">i</span>+<span class="Number">1</span>) <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ResWord">len</span>(<span class="ID">split_lines</span>[<span class="Number">0</span>])) ]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_463"> 463</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_463"></span><span class="anchor" id="line-463"></span>    <span class="Comment"># check/convert values</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_464"> 464</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_464"></span><span class="anchor" id="line-464"></span>    <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ResWord">len</span>(<span class="ID">split_lines</span>)):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_465"> 465</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_465"></span><span class="anchor" id="line-465"></span>        <span class="ID">split_line</span> = <span class="ID">split_lines</span>[<span class="ID">i</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_466"> 466</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_466"></span><span class="anchor" id="line-466"></span>        <span class="ResWord">for</span> <span class="ID">j</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ResWord">len</span>(<span class="ID">split_line</span>)):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_467"> 467</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_467"></span><span class="anchor" id="line-467"></span>            <span class="ID">value</span> = <span class="ID">split_line</span>[<span class="ID">j</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_468"> 468</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_468"></span><span class="anchor" id="line-468"></span>            <span class="ResWord">if</span> <span class="ID">value</span> == <span class="String">'</span><span class="String">'</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_469"> 469</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_469"></span><span class="anchor" id="line-469"></span>                <span class="ID">converted_value</span> = <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_470"> 470</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_470"></span><span class="anchor" id="line-470"></span>            <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_471"> 471</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_471"></span><span class="anchor" id="line-471"></span>                <span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_472"> 472</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_472"></span><span class="anchor" id="line-472"></span>                    <span class="ID">converted_value</span> = <span class="ResWord">int</span>(<span class="ID">value</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_473"> 473</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_473"></span><span class="anchor" id="line-473"></span>                <span class="ResWord">except</span> <span class="ID">ValueError</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_474"> 474</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_474"></span><span class="anchor" id="line-474"></span>                    <span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_475"> 475</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_475"></span><span class="anchor" id="line-475"></span>                        <span class="ID">converted_value</span> = <span class="ResWord">float</span>(<span class="ID">value</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_476"> 476</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_476"></span><span class="anchor" id="line-476"></span>                    <span class="ResWord">except</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_477"> 477</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_477"></span><span class="anchor" id="line-477"></span>                        <span class="ID">converted_value</span> = <span class="ID">value</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_478"> 478</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_478"></span><span class="anchor" id="line-478"></span>            <span class="ID">split_line</span>[<span class="ID">j</span>] = <span class="ID">converted_value</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_479"> 479</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_479"></span><span class="anchor" id="line-479"></span>        <span class="ID">split_lines</span>[<span class="ID">i</span>] = <span class="ID">split_line</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_480"> 480</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_480"></span><span class="anchor" id="line-480"></span>    <span class="ID">columns</span> = <span class="ResWord">zip</span>(*<span class="ID">split_lines</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_481"> 481</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_481"></span><span class="anchor" id="line-481"></span>    <span class="ID">results</span> = {}</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_482"> 482</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_482"></span><span class="anchor" id="line-482"></span>    <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ResWord">len</span>(<span class="ID">fields</span>)):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_483"> 483</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_483"></span><span class="anchor" id="line-483"></span>        <span class="ID">field</span> = <span class="ID">fields</span>[<span class="ID">i</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_484"> 484</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_484"></span><span class="anchor" id="line-484"></span>        <span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_485"> 485</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_485"></span><span class="anchor" id="line-485"></span>            <span class="ID">results</span>[<span class="ID">field</span>] = <span class="ResWord">list</span>(<span class="ID">columns</span>[<span class="ID">i</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_486"> 486</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_486"></span><span class="anchor" id="line-486"></span>        <span class="ResWord">except</span> <span class="ID">IndexError</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_487"> 487</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_487"></span><span class="anchor" id="line-487"></span>            <span class="ID">results</span>[<span class="ID">field</span>] = <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_488"> 488</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_488"></span><span class="anchor" id="line-488"></span><span class="Comment">#        print i, field, results[field], columns[i]</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e05facc782df647d7974d1698dd5ffe6e305343a_489"> 489</a> </span><span class="LineAnchor" id="CA-e05facc782df647d7974d1698dd5ffe6e305343a_489"></span><span class="anchor" id="line-489"></span>    <span class="ResWord">return</span> <span class="ID">DataFrame</span>( <span class="ID">results</span>, <span class="ID">fields_order</span>=<span class="ID">fields</span> )</span>
</pre></div></div><h2>New Attachment</h2>
<form action="../../external.html?link=http://localhost:8080/Cookbook/DataFrame" method="POST" enctype="multipart/form-data">
<dl>
<dt>File to upload</dt>
<dd><input type="file" name="file" size="50"></dd>
<dt>Rename to</dt>
<dd><input type="text" name="target" size="50" value="DataFrame.py"></dd>
<dt>Overwrite existing attachment of same name</dt>
<dd><input type="checkbox" name="overwrite" value="1" ></dd>
</dl>

<p>
<input type="hidden" name="action" value="AttachFile">
<input type="hidden" name="do" value="upload">
<input type="hidden" name="ticket" value="0056327c53.fcc18a70fcaac25f6e932eb0c8738c1cd3bb9483">
<input type="submit" value="Upload">
</p>
</form>
<h2>Attached Files</h2>To refer to attachments on a page, use <strong><tt>attachment:filename</tt></strong>,  as shown below in the list of files.  Do <strong>NOT</strong> use the URL of the <tt>[get]</tt> link,  since this is subject to change and can break easily.<ul><li>[<a href="CSVSampleb202.csv?action=AttachFile&amp;do=get&amp;target=CSVSample.csv">get</a>&nbsp;| <a href="DataFrame4fd5.html?action=AttachFile&amp;do=view&amp;target=CSVSample.csv">view</a>] (2006-09-13 12:20:03, 2.9 KB) [[attachment:CSVSample.csv]]</li><li>[<a href="DataFrame7904.py?action=AttachFile&amp;do=get&amp;target=DataFrame.py">get</a>&nbsp;| <a href="DataFrame857d.html?action=AttachFile&amp;do=view&amp;target=DataFrame.py">view</a>] (2006-09-13 07:57:52, 17.3 KB) [[attachment:DataFrame.py]]</li><li>[<a href="SampleCSVcb86.csv?action=AttachFile&amp;do=get&amp;target=SampleCSV.csv">get</a>&nbsp;| <a href="DataFrame4dec.html?action=AttachFile&amp;do=view&amp;target=SampleCSV.csv">view</a>] (2006-09-13 12:12:09, 25.1 KB) [[attachment:SampleCSV.csv]]</li></ul><span class="anchor" id="bottom"></span></div>
<div id="pagebottom"></div>
</div>


<div id="footer">
<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="DataFrame37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../../external.html?link=http://localhost:8080/Cookbook/DataFrame">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

<ul id="credits">
<li><a href="../../external.html?link=http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="../../external.html?link=http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="../../external.html?link=http://moinmo.in/GPL" title="MoinMoin is GPL licensed.">GPL licensed</a></li><li><a href="../../external.html?link=http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li>
</ul>


</div>
</body>

<!-- Mirrored from localhost:8080/Cookbook/DataFrame?action=AttachFile&do=view&target=DataFrame.py by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 20:41:35 GMT -->
</html>

