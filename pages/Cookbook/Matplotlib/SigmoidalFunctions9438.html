<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<!-- Mirrored from localhost:8080/Cookbook/Matplotlib/SigmoidalFunctions?highlight=%28%28CategoryCookbook%29%29 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 23:34:10 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="edit_on_doubleclick" content="/">
<meta name="robots" content="noindex,nofollow">

<title>Cookbook/Matplotlib/SigmoidalFunctions - SciPy wiki dump</title>
<script type="text/javascript" src="../../moin_static197/common/js/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../../moin_static197/modern/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="../../moin_static197/modern/css/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="../../moin_static197/modern/css/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="../../moin_static197/modern/css/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static197/modern/css/msie.css">
<![endif]-->


<link rel="alternate" title="SciPy: Cookbook/Matplotlib/SigmoidalFunctions" href="../../../external.html?link=http://localhost:8080/Cookbook/Matplotlib/SigmoidalFunctions?diffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=Cookbook%2FMatplotlib%2FSigmoidalFunctions&amp;ddiffs=1" type="application/rss+xml">


<link rel="Start" href="../../AllPages.html">
<link rel="Alternate" title="Wiki Markup" href="../../../external.html?link=http://localhost:8080/Cookbook/Matplotlib/SigmoidalFunctions?action=raw">
<link rel="Alternate" media="print" title="Print View" href="../../../external.html?link=http://localhost:8080/Cookbook/Matplotlib/SigmoidalFunctions?action=print">
<link rel="Up" href="../Matplotlib.html">
<link rel="Appendix" title="sigmoids.png" href="SigmoidalFunctions89ad.html?action=AttachFile&amp;do=view&amp;target=sigmoids.png">
<link rel="Appendix" title="sigmoids2.png" href="SigmoidalFunctions0c94.html?action=AttachFile&amp;do=view&amp;target=sigmoids2.png">
<link rel="Search" href="../../FindPage.html">
<link rel="Index" href="../../TitleIndex.html">
<link rel="Glossary" href="../../WordIndex.html">
<link rel="Help" href="../../HelpOnFormatting.html">
</head>

<body  lang="en" dir="ltr"><div style="background: white; padding:2em;">This is an archival dump of old wiki content --- see <a href="http://scipy.org/">scipy.org</a> for current material</div>

<div id="header">


<form id="searchform" method="get" action="../../../external.html?link=http://localhost:8080/Cookbook/Matplotlib/SigmoidalFunctions">
<div>
<input type="hidden" name="action" value="fullsearch">
<input type="hidden" name="context" value="180">
<label for="searchinput">Search:</label>
<input id="searchinput" type="text" name="value" value="" size="20"
    onfocus="searchFocus(this)" onblur="searchBlur(this)"
    onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search">
<input id="titlesearch" name="titlesearch" type="submit"
    value="Titles" alt="Search Titles">
<input id="fullsearch" name="fullsearch" type="submit"
    value="Text" alt="Search Full Text">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<ul id="username"><li><a href="SigmoidalFunctions456e.html?action=login" id="login" rel="nofollow">Login</a></li></ul>
<div id="locationline">
<div id="interwiki"><span><a href="../../AllPages.html" rel="nofollow">SciPy</a></span></div>

<ul id="pagelocation">
<li><a href="../../Cookbook.html">Cookbook</a></li><li><a href="../Matplotlib.html">Matplotlib</a></li><li><a class="backlink" href="SigmoidalFunctions2de4.html?action=fullsearch&amp;context=180&amp;value=linkto%3A%22Cookbook%2FMatplotlib%2FSigmoidalFunctions%22" rel="nofollow" title="Click to do a full-text search for this title">SigmoidalFunctions</a></li>
</ul>

</div>


<ul id="navibar">
<li class="wikilink"><a href="../../RecentChanges.html">RecentChanges</a></li><li class="wikilink"><a class="nonexistent" href="../../FindPage.html">FindPage</a></li><li class="wikilink"><a class="nonexistent" href="../../HelpContents.html">HelpContents</a></li><li class="current"><a href="SigmoidalFunctions.html">SigmoidalFunctions</a></li>
</ul>

<div id="pageline"><hr style="display:none;"></div>

<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="SigmoidalFunctions37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../../../external.html?link=http://localhost:8080/Cookbook/Matplotlib/SigmoidalFunctions">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

</div>

<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><p class="line874">matplotlib's approach to plotting functions requires you to compute <span class="anchor" id="line-2"></span>the x and y vertices of the curves you want to plot and then pass it <span class="anchor" id="line-3"></span>off to plot.  Eg for a normal pdf, matplotlib.mlab provides such a <span class="anchor" id="line-4"></span>function: <span class="anchor" id="line-5"></span><span class="anchor" id="line-6"></span><p class="line867"><span class="anchor" id="line-7"></span><span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span><span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><span class="anchor" id="line-15"></span><span class="anchor" id="line-1-1"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
function isnumbered(obj) {
  return obj.childNodes.length && obj.firstChild.childNodes.length && obj.firstChild.firstChild.className == 'LineNumber';
}
function nformat(num,chrs,add) {
  var nlen = Math.max(0,chrs-(''+num).length), res = '';
  while (nlen>0) { res += ' '; nlen-- }
  return res+num+add;
}
function addnumber(did, nstart, nstep) {
  var c = document.getElementById(did), l = c.firstChild, n = 1;
  if (!isnumbered(c)) {
    if (typeof nstart == 'undefined') nstart = 1;
    if (typeof nstep  == 'undefined') nstep = 1;
    var n = nstart;
    while (l != null) {
      if (l.tagName == 'SPAN') {
        var s = document.createElement('SPAN');
        var a = document.createElement('A');
        s.className = 'LineNumber';
        a.appendChild(document.createTextNode(nformat(n,4,'')));
        a.href = '#' + did + '_' + n;
        s.appendChild(a);
        s.appendChild(document.createTextNode(' '));
        n += nstep;
        if (l.childNodes.length) {
          l.insertBefore(s, l.firstChild);
        }
        else {
          l.appendChild(s);
        }
      }
      l = l.nextSibling;
    }
  }
  return false;
}
function remnumber(did) {
  var c = document.getElementById(did), l = c.firstChild;
  if (isnumbered(c)) {
    while (l != null) {
      if (l.tagName == 'SPAN' && l.firstChild.className == 'LineNumber') l.removeChild(l.firstChild);
      l = l.nextSibling;
    }
  }
  return false;
}
function togglenumber(did, nstart, nstep) {
  var c = document.getElementById(did);
  if (isnumbered(c)) {
    remnumber(did);
  } else {
    addnumber(did,nstart,nstep);
  }
  return false;
}
</script>

<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-f525fd56716b1b542821fb73621586da064f4f73\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-f525fd56716b1b542821fb73621586da064f4f73" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-f525fd56716b1b542821fb73621586da064f4f73_1">   1</a> </span><span class="LineAnchor" id="CA-f525fd56716b1b542821fb73621586da064f4f73_1"></span><span class="anchor" id="line-1-2"></span><span class="ResWord">from</span> <span class="ID">matplotlib.mlab</span> <span class="ResWord">import</span> <span class="ID">normpdf</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f525fd56716b1b542821fb73621586da064f4f73_2">   2</a> </span><span class="LineAnchor" id="CA-f525fd56716b1b542821fb73621586da064f4f73_2"></span><span class="anchor" id="line-2-1"></span><span class="ResWord">import</span> <span class="ID">matplotlib.numerix</span> <span class="ResWord">as</span> <span class="ID">nx</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f525fd56716b1b542821fb73621586da064f4f73_3">   3</a> </span><span class="LineAnchor" id="CA-f525fd56716b1b542821fb73621586da064f4f73_3"></span><span class="anchor" id="line-3-1"></span><span class="ResWord">import</span> <span class="ID">pylab</span> <span class="ResWord">as</span> <span class="ID">p</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f525fd56716b1b542821fb73621586da064f4f73_4">   4</a> </span><span class="LineAnchor" id="CA-f525fd56716b1b542821fb73621586da064f4f73_4"></span><span class="anchor" id="line-4-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f525fd56716b1b542821fb73621586da064f4f73_5">   5</a> </span><span class="LineAnchor" id="CA-f525fd56716b1b542821fb73621586da064f4f73_5"></span><span class="anchor" id="line-5-1"></span><span class="ID">x</span> = <span class="ID">nx</span>.<span class="ID">arange</span>(-<span class="Number">4</span>, <span class="Number">4</span>, <span class="Number">0.01</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-f525fd56716b1b542821fb73621586da064f4f73_6">   6</a> </span><span class="LineAnchor" id="CA-f525fd56716b1b542821fb73621586da064f4f73_6"></span><span class="anchor" id="line-6-1"></span><span class="ID">y</span> = <span class="ID">normpdf</span>(<span class="ID">x</span>, <span class="Number">0</span>, <span class="Number">1</span>) <span class="Comment"># unit normal</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f525fd56716b1b542821fb73621586da064f4f73_7">   7</a> </span><span class="LineAnchor" id="CA-f525fd56716b1b542821fb73621586da064f4f73_7"></span><span class="anchor" id="line-7-1"></span><span class="ID">p</span>.<span class="ID">plot</span>(<span class="ID">x</span>,<span class="ID">y</span>, <span class="ID">color</span>=<span class="String">'</span><span class="String">red</span><span class="String">'</span>, <span class="ID">lw</span>=<span class="Number">2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-f525fd56716b1b542821fb73621586da064f4f73_8">   8</a> </span><span class="LineAnchor" id="CA-f525fd56716b1b542821fb73621586da064f4f73_8"></span><span class="anchor" id="line-8-1"></span><span class="ID">p</span>.<span class="ID">show</span>()</span>
</pre></div></div><span class="anchor" id="line-16"></span><span class="anchor" id="line-17"></span><p class="line874">Of course, some curves do not have closed form expressions and are not <span class="anchor" id="line-18"></span>amenable for such treatment.  Some of the matplotlib backends have the <span class="anchor" id="line-19"></span>capability to draw arbitrary paths with splines (cubic and quartic) <span class="anchor" id="line-20"></span>but this functionality hasn't been exposed to the user yet (as of <span class="anchor" id="line-21"></span>0.83).  If you need this, please post to the <a class="http" href="../../../external.html?link=http://sourceforge.net/mail/?group_id=80706">mailing list</a> or submit a <span class="anchor" id="line-22"></span>sourceforge <a class="http" href="../../../external.html?link=http://sourceforge.net/tracker/?group_id=80706&amp;atid=560721">support request</a>. <span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span><p class="line874">Rich Shepard was interested in plotting &quot;S curves&quot; and &quot;Z curves&quot;, and <span class="anchor" id="line-26"></span>a little bit of googling suggests that the S curve is a sigmoid and <span class="anchor" id="line-27"></span>the Z curve is simply 1.0-sigmoid.  There are many simple forms for <span class="anchor" id="line-28"></span>sigmoids: eg, the hill, boltzman, and arc tangent functions.  Here is <span class="anchor" id="line-29"></span>an example of the boltzman function: <span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span><p class="line867"><span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span><span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span><span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span><span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span><span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span><span class="anchor" id="line-1-3"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-e950aa09c560616e9961fe844aa3147fa1add55f\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-e950aa09c560616e9961fe844aa3147fa1add55f" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-e950aa09c560616e9961fe844aa3147fa1add55f_1">   1</a> </span><span class="LineAnchor" id="CA-e950aa09c560616e9961fe844aa3147fa1add55f_1"></span><span class="anchor" id="line-1-4"></span><span class="ResWord">import</span> <span class="ID">matplotlib.numerix</span> <span class="ResWord">as</span> <span class="ID">nx</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e950aa09c560616e9961fe844aa3147fa1add55f_2">   2</a> </span><span class="LineAnchor" id="CA-e950aa09c560616e9961fe844aa3147fa1add55f_2"></span><span class="anchor" id="line-2-2"></span><span class="ResWord">import</span> <span class="ID">pylab</span> <span class="ResWord">as</span> <span class="ID">p</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e950aa09c560616e9961fe844aa3147fa1add55f_3">   3</a> </span><span class="LineAnchor" id="CA-e950aa09c560616e9961fe844aa3147fa1add55f_3"></span><span class="anchor" id="line-3-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e950aa09c560616e9961fe844aa3147fa1add55f_4">   4</a> </span><span class="LineAnchor" id="CA-e950aa09c560616e9961fe844aa3147fa1add55f_4"></span><span class="anchor" id="line-4-2"></span><span class="ResWord">def</span> <span class="ID">boltzman</span>(<span class="ID">x</span>, <span class="ID">xmid</span>, <span class="ID">tau</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e950aa09c560616e9961fe844aa3147fa1add55f_5">   5</a> </span><span class="LineAnchor" id="CA-e950aa09c560616e9961fe844aa3147fa1add55f_5"></span><span class="anchor" id="line-5-2"></span>    <span class="String">&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e950aa09c560616e9961fe844aa3147fa1add55f_6">   6</a> </span><span class="LineAnchor" id="CA-e950aa09c560616e9961fe844aa3147fa1add55f_6"></span><span class="anchor" id="line-6-2"></span><span class="String">    evaluate the boltzman function with midpoint xmid and time constant tau</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e950aa09c560616e9961fe844aa3147fa1add55f_7">   7</a> </span><span class="LineAnchor" id="CA-e950aa09c560616e9961fe844aa3147fa1add55f_7"></span><span class="anchor" id="line-7-2"></span><span class="String">    over x</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e950aa09c560616e9961fe844aa3147fa1add55f_8">   8</a> </span><span class="LineAnchor" id="CA-e950aa09c560616e9961fe844aa3147fa1add55f_8"></span><span class="anchor" id="line-8-2"></span><span class="String">    &quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e950aa09c560616e9961fe844aa3147fa1add55f_9">   9</a> </span><span class="LineAnchor" id="CA-e950aa09c560616e9961fe844aa3147fa1add55f_9"></span><span class="anchor" id="line-9-1"></span>    <span class="ResWord">return</span> <span class="Number">1.</span> / (<span class="Number">1.</span> + <span class="ID">nx</span>.<span class="ID">exp</span>(-(<span class="ID">x</span>-<span class="ID">xmid</span>)/<span class="ID">tau</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-e950aa09c560616e9961fe844aa3147fa1add55f_10">  10</a> </span><span class="LineAnchor" id="CA-e950aa09c560616e9961fe844aa3147fa1add55f_10"></span><span class="anchor" id="line-10-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e950aa09c560616e9961fe844aa3147fa1add55f_11">  11</a> </span><span class="LineAnchor" id="CA-e950aa09c560616e9961fe844aa3147fa1add55f_11"></span><span class="anchor" id="line-11-1"></span><span class="ID">x</span> = <span class="ID">nx</span>.<span class="ID">arange</span>(-<span class="Number">6</span>, <span class="Number">6</span>, .<span class="Number">01</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e950aa09c560616e9961fe844aa3147fa1add55f_12">  12</a> </span><span class="LineAnchor" id="CA-e950aa09c560616e9961fe844aa3147fa1add55f_12"></span><span class="anchor" id="line-12-1"></span><span class="ID">S</span> = <span class="ID">boltzman</span>(<span class="ID">x</span>, <span class="Number">0</span>, <span class="Number">1</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e950aa09c560616e9961fe844aa3147fa1add55f_13">  13</a> </span><span class="LineAnchor" id="CA-e950aa09c560616e9961fe844aa3147fa1add55f_13"></span><span class="anchor" id="line-13-1"></span><span class="ID">Z</span> = <span class="Number">1</span>-<span class="ID">boltzman</span>(<span class="ID">x</span>, <span class="Number">0.5</span>, <span class="Number">1</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e950aa09c560616e9961fe844aa3147fa1add55f_14">  14</a> </span><span class="LineAnchor" id="CA-e950aa09c560616e9961fe844aa3147fa1add55f_14"></span><span class="anchor" id="line-14-1"></span><span class="ID">p</span>.<span class="ID">plot</span>(<span class="ID">x</span>, <span class="ID">S</span>, <span class="ID">x</span>, <span class="ID">Z</span>, <span class="ID">color</span>=<span class="String">'</span><span class="String">red</span><span class="String">'</span>, <span class="ID">lw</span>=<span class="Number">2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e950aa09c560616e9961fe844aa3147fa1add55f_15">  15</a> </span><span class="LineAnchor" id="CA-e950aa09c560616e9961fe844aa3147fa1add55f_15"></span><span class="anchor" id="line-15-1"></span><span class="ID">p</span>.<span class="ID">show</span>()</span>
</pre></div></div><span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span><p class="line862">See also <a class="http" href="../../../external.html?link=http://mathworld.wolfram.com/SigmoidFunction.html">sigmoids at mathworld</a>. <span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span><p class="line862">People often want to shade an area under these curves, eg <a class="http" href="../../../external.html?link=http://www.appl-ecosys.com/newstuff.html">under their intersection</a>, which you can do with the magic of numerix and the matplotlib <a class="http" href="../../../external.html?link=http://matplotlib.sourceforge.net/matplotlib.pylab.html#-fill">fill</a> function: <span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span><p class="line867"><span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span><span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span><span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span><span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span><span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span><span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span><span class="anchor" id="line-66"></span><span class="anchor" id="line-67"></span><span class="anchor" id="line-68"></span><span class="anchor" id="line-69"></span><span class="anchor" id="line-70"></span><span class="anchor" id="line-71"></span><span class="anchor" id="line-72"></span><span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span><span class="anchor" id="line-75"></span><span class="anchor" id="line-76"></span><span class="anchor" id="line-77"></span><span class="anchor" id="line-78"></span><span class="anchor" id="line-79"></span><span class="anchor" id="line-80"></span><span class="anchor" id="line-81"></span><span class="anchor" id="line-82"></span><span class="anchor" id="line-1-5"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_1">   1</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_1"></span><span class="anchor" id="line-1-6"></span><span class="ResWord">import</span> <span class="ID">matplotlib.numerix</span> <span class="ResWord">as</span> <span class="ID">nx</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_2">   2</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_2"></span><span class="anchor" id="line-2-3"></span><span class="ResWord">import</span> <span class="ID">pylab</span> <span class="ResWord">as</span> <span class="ID">p</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_3">   3</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_3"></span><span class="anchor" id="line-3-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_4">   4</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_4"></span><span class="anchor" id="line-4-3"></span><span class="ResWord">def</span> <span class="ID">boltzman</span>(<span class="ID">x</span>, <span class="ID">xmid</span>, <span class="ID">tau</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_5">   5</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_5"></span><span class="anchor" id="line-5-3"></span>    <span class="String">&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_6">   6</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_6"></span><span class="anchor" id="line-6-3"></span><span class="String">    evaluate the boltzman function with midpoint xmid and time constant tau</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_7">   7</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_7"></span><span class="anchor" id="line-7-3"></span><span class="String">    over x</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_8">   8</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_8"></span><span class="anchor" id="line-8-3"></span><span class="String">    &quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_9">   9</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_9"></span><span class="anchor" id="line-9-2"></span>    <span class="ResWord">return</span> <span class="Number">1.</span> / (<span class="Number">1.</span> + <span class="ID">nx</span>.<span class="ID">exp</span>(-(<span class="ID">x</span>-<span class="ID">xmid</span>)/<span class="ID">tau</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_10">  10</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_10"></span><span class="anchor" id="line-10-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_11">  11</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_11"></span><span class="anchor" id="line-11-2"></span><span class="ResWord">def</span> <span class="ID">fill_below_intersection</span>(<span class="ID">x</span>, <span class="ID">S</span>, <span class="ID">Z</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_12">  12</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_12"></span><span class="anchor" id="line-12-2"></span>    <span class="String">&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_13">  13</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_13"></span><span class="anchor" id="line-13-2"></span><span class="String">    fill the region below the intersection of S and Z</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_14">  14</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_14"></span><span class="anchor" id="line-14-2"></span><span class="String">    &quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_15">  15</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_15"></span><span class="anchor" id="line-15-2"></span>    <span class="Comment">#find the intersection point</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_16">  16</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_16"></span><span class="anchor" id="line-16-1"></span>    <span class="ID">ind</span> = <span class="ID">nx</span>.<span class="ID">nonzero</span>( <span class="ID">nx</span>.<span class="ID">absolute</span>(<span class="ID">S</span>-<span class="ID">Z</span>)==<span class="ResWord">min</span>(<span class="ID">nx</span>.<span class="ID">absolute</span>(<span class="ID">S</span>-<span class="ID">Z</span>)))[<span class="Number">0</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_17">  17</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_17"></span><span class="anchor" id="line-17-1"></span>    <span class="Comment"># compute a new curve which we will fill below</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_18">  18</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_18"></span><span class="anchor" id="line-18-1"></span>    <span class="ID">Y</span> = <span class="ID">nx</span>.<span class="ID">zeros</span>(<span class="ID">S</span>.<span class="ID">shape</span>, <span class="ID">typecode</span>=<span class="ID">nx</span>.<span class="ID">Float</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_19">  19</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_19"></span><span class="anchor" id="line-19-1"></span>    <span class="ID">Y</span>[:<span class="ID">ind</span>] = <span class="ID">S</span>[:<span class="ID">ind</span>]  <span class="Comment"># Y is S up to the intersection</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_20">  20</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_20"></span><span class="anchor" id="line-20-1"></span>    <span class="ID">Y</span>[<span class="ID">ind</span>:] = <span class="ID">Z</span>[<span class="ID">ind</span>:]  <span class="Comment"># and Z beyond it</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_21">  21</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_21"></span><span class="anchor" id="line-21-1"></span>    <span class="ID">p</span>.<span class="ID">fill</span>(<span class="ID">x</span>, <span class="ID">Y</span>, <span class="ID">facecolor</span>=<span class="String">'</span><span class="String">blue</span><span class="String">'</span>, <span class="ID">alpha</span>=<span class="Number">0.5</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_22">  22</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_22"></span><span class="anchor" id="line-22-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_23">  23</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_23"></span><span class="anchor" id="line-23-1"></span><span class="ID">x</span> = <span class="ID">nx</span>.<span class="ID">arange</span>(-<span class="Number">6</span>, <span class="Number">6</span>, .<span class="Number">01</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_24">  24</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_24"></span><span class="anchor" id="line-24-1"></span><span class="ID">S</span> = <span class="ID">boltzman</span>(<span class="ID">x</span>, <span class="Number">0</span>, <span class="Number">1</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_25">  25</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_25"></span><span class="anchor" id="line-25-1"></span><span class="ID">Z</span> = <span class="Number">1</span>-<span class="ID">boltzman</span>(<span class="ID">x</span>, <span class="Number">0.5</span>, <span class="Number">1</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_26">  26</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_26"></span><span class="anchor" id="line-26-1"></span><span class="ID">p</span>.<span class="ID">plot</span>(<span class="ID">x</span>, <span class="ID">S</span>, <span class="ID">x</span>, <span class="ID">Z</span>, <span class="ID">color</span>=<span class="String">'</span><span class="String">red</span><span class="String">'</span>, <span class="ID">lw</span>=<span class="Number">2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_27">  27</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_27"></span><span class="anchor" id="line-27-1"></span><span class="ID">fill_below_intersection</span>(<span class="ID">x</span>, <span class="ID">S</span>, <span class="ID">Z</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_28">  28</a> </span><span class="LineAnchor" id="CA-ed2adfacef634b3ccdfcd4dd277fbefd026dda29_28"></span><span class="anchor" id="line-28-1"></span><span class="ID">p</span>.<span class="ID">show</span>()</span>
</pre></div></div><span class="anchor" id="line-83"></span><span class="anchor" id="line-84"></span><p class="line874">As these examples illustrate, matplotlib doesn't come with helper functions for all the kinds of curves people want to plot, but along with numerix and python, provides the basic tools to enable you to build them yourself. <span class="anchor" id="line-85"></span><span class="anchor" id="line-86"></span><p class="line867"><img alt="sigmoids2.png" class="attachment" src="sigmoids2f970.png?action=AttachFile&amp;do=get&amp;target=sigmoids2.png" title="sigmoids2.png" /> <span class="anchor" id="line-87"></span><span class="anchor" id="line-88"></span><p class="line867"><hr /><p class="line874"> <span class="anchor" id="line-89"></span><a href="../../CategoryCookbookMatplotlib.html"><strong class="highlight">CategoryCookbook</strong>Matplotlib</a> <span class="anchor" id="line-90"></span><span class="anchor" id="bottom"></span></div><p id="pageinfo" class="info" lang="en" dir="ltr">SciPy: Cookbook/Matplotlib/SigmoidalFunctions  (last edited 2015-10-24 17:48:23 by <span title="">anonymous</span>)</p>

<div id="pagebottom"></div>
</div>


<div id="footer">
<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="SigmoidalFunctions37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../../../external.html?link=http://localhost:8080/Cookbook/Matplotlib/SigmoidalFunctions">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

<ul id="credits">
<li><a href="../../../external.html?link=http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="../../../external.html?link=http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="../../../external.html?link=http://moinmo.in/GPL" title="MoinMoin is GPL licensed.">GPL licensed</a></li><li><a href="../../../external.html?link=http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li>
</ul>


</div>
</body>

<!-- Mirrored from localhost:8080/Cookbook/Matplotlib/SigmoidalFunctions?highlight=%28%28CategoryCookbook%29%29 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 23:34:10 GMT -->
</html>

