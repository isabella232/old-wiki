<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<!-- Mirrored from localhost:8080/Cookbook/Rebinning by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 20:22:12 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="edit_on_doubleclick" content="/">
<meta name="robots" content="index,nofollow">

<title>Cookbook/Rebinning - SciPy wiki dump</title>
<script type="text/javascript" src="../moin_static197/common/js/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../moin_static197/modern/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="../moin_static197/modern/css/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="../moin_static197/modern/css/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="../moin_static197/modern/css/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static197/modern/css/msie.css">
<![endif]-->


<link rel="alternate" title="SciPy: Cookbook/Rebinning" href="../../external.html?link=http://localhost:8080/Cookbook/Rebinning?diffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=Cookbook%2FRebinning&amp;ddiffs=1" type="application/rss+xml">


<link rel="Start" href="../AllPages.html">
<link rel="Alternate" title="Wiki Markup" href="../../external.html?link=http://localhost:8080/Cookbook/Rebinning?action=raw">
<link rel="Alternate" media="print" title="Print View" href="../../external.html?link=http://localhost:8080/Cookbook/Rebinning?action=print">
<link rel="Up" href="../Cookbook.html">
<link rel="Search" href="../FindPage.html">
<link rel="Index" href="../TitleIndex.html">
<link rel="Glossary" href="../WordIndex.html">
<link rel="Help" href="../HelpOnFormatting.html">
</head>

<body  lang="en" dir="ltr"><div style="background: white; padding:2em;">This is an archival dump of old wiki content --- see <a href="http://scipy.org/">scipy.org</a> for current material</div>

<div id="header">


<form id="searchform" method="get" action="../../external.html?link=http://localhost:8080/Cookbook/Rebinning">
<div>
<input type="hidden" name="action" value="fullsearch">
<input type="hidden" name="context" value="180">
<label for="searchinput">Search:</label>
<input id="searchinput" type="text" name="value" value="" size="20"
    onfocus="searchFocus(this)" onblur="searchBlur(this)"
    onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search">
<input id="titlesearch" name="titlesearch" type="submit"
    value="Titles" alt="Search Titles">
<input id="fullsearch" name="fullsearch" type="submit"
    value="Text" alt="Search Full Text">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<ul id="username"><li><a href="Rebinning456e.html?action=login" id="login" rel="nofollow">Login</a></li></ul>
<div id="locationline">
<div id="interwiki"><span><a href="../AllPages.html" rel="nofollow">SciPy</a></span></div>

<ul id="pagelocation">
<li><a href="../Cookbook.html">Cookbook</a></li><li><a class="backlink" href="Rebinning3521.html?action=fullsearch&amp;context=180&amp;value=linkto%3A%22Cookbook%2FRebinning%22" rel="nofollow" title="Click to do a full-text search for this title">Rebinning</a></li>
</ul>

</div>


<ul id="navibar">
<li class="wikilink"><a href="../RecentChanges.html">RecentChanges</a></li><li class="wikilink"><a class="nonexistent" href="../FindPage.html">FindPage</a></li><li class="wikilink"><a class="nonexistent" href="../HelpContents.html">HelpContents</a></li><li class="current"><a href="Rebinning.html">Cookbook/Rebinning</a></li>
</ul>

<div id="pageline"><hr style="display:none;"></div>

<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="Rebinning37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../../external.html?link=http://localhost:8080/Cookbook/Rebinning">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

</div>

<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><p class="line874">Examples showing how to rebin data to produce a smaller or bigger array without (and with) using interpolation.  <span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><p class="line867">
<h2 id="Example_1">Example 1</h2>
<span class="anchor" id="line-4"></span><p class="line874">Here we deal with the simplest case where any desired new shape is valid and no interpolation is done on the data to determine the new values. <span class="anchor" id="line-5"></span><ul><li>First, floating slices objects are created for each dimension. <span class="anchor" id="line-6"></span></li><li>Second, the coordinates of the new bins are computed from the slices using mgrid. <span class="anchor" id="line-7"></span></li><li>Then, coordinates are transformed to integer indices. <span class="anchor" id="line-8"></span></li><li>And, finally, 'fancy indexing' is used to evaluate the original array at the desired indices. <span class="anchor" id="line-9"></span><span class="anchor" id="line-10"></span></li></ul><p class="line867"><span class="anchor" id="line-11"></span><span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span><span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span><span class="anchor" id="line-1-1"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
function isnumbered(obj) {
  return obj.childNodes.length && obj.firstChild.childNodes.length && obj.firstChild.firstChild.className == 'LineNumber';
}
function nformat(num,chrs,add) {
  var nlen = Math.max(0,chrs-(''+num).length), res = '';
  while (nlen>0) { res += ' '; nlen-- }
  return res+num+add;
}
function addnumber(did, nstart, nstep) {
  var c = document.getElementById(did), l = c.firstChild, n = 1;
  if (!isnumbered(c)) {
    if (typeof nstart == 'undefined') nstart = 1;
    if (typeof nstep  == 'undefined') nstep = 1;
    var n = nstart;
    while (l != null) {
      if (l.tagName == 'SPAN') {
        var s = document.createElement('SPAN');
        var a = document.createElement('A');
        s.className = 'LineNumber';
        a.appendChild(document.createTextNode(nformat(n,4,'')));
        a.href = '#' + did + '_' + n;
        s.appendChild(a);
        s.appendChild(document.createTextNode(' '));
        n += nstep;
        if (l.childNodes.length) {
          l.insertBefore(s, l.firstChild);
        }
        else {
          l.appendChild(s);
        }
      }
      l = l.nextSibling;
    }
  }
  return false;
}
function remnumber(did) {
  var c = document.getElementById(did), l = c.firstChild;
  if (isnumbered(c)) {
    while (l != null) {
      if (l.tagName == 'SPAN' && l.firstChild.className == 'LineNumber') l.removeChild(l.firstChild);
      l = l.nextSibling;
    }
  }
  return false;
}
function togglenumber(did, nstart, nstep) {
  var c = document.getElementById(did);
  if (isnumbered(c)) {
    remnumber(did);
  } else {
    addnumber(did,nstart,nstep);
  }
  return false;
}
</script>

<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa_1">   1</a> </span><span class="LineAnchor" id="CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa_1"></span><span class="anchor" id="line-1-2"></span><span class="ResWord">def</span> <span class="ID">rebin</span>( <span class="ID">a</span>, <span class="ID">newshape</span> ):</span>
<span class="line"><span class="LineNumber"><a href="#CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa_2">   2</a> </span><span class="LineAnchor" id="CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa_2"></span><span class="anchor" id="line-2-1"></span>        <span class="String">'''Rebin an array to a new shape.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa_3">   3</a> </span><span class="LineAnchor" id="CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa_3"></span><span class="anchor" id="line-3-1"></span><span class="String">        '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa_4">   4</a> </span><span class="LineAnchor" id="CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa_4"></span><span class="anchor" id="line-4-1"></span>        <span class="ResWord">assert</span> <span class="ResWord">len</span>(<span class="ID">a</span>.<span class="ID">shape</span>) == <span class="ResWord">len</span>(<span class="ID">newshape</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa_5">   5</a> </span><span class="LineAnchor" id="CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa_5"></span><span class="anchor" id="line-5-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa_6">   6</a> </span><span class="LineAnchor" id="CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa_6"></span><span class="anchor" id="line-6-1"></span>        <span class="ID">slices</span> = [ <span class="ResWord">slice</span>(<span class="Number">0</span>,<span class="ID">old</span>, <span class="ResWord">float</span>(<span class="ID">old</span>)/<span class="ID">new</span>) <span class="ResWord">for</span> <span class="ID">old</span>,<span class="ID">new</span> <span class="ResWord">in</span> <span class="ResWord">zip</span>(<span class="ID">a</span>.<span class="ID">shape</span>,<span class="ID">newshape</span>) ]</span>
<span class="line"><span class="LineNumber"><a href="#CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa_7">   7</a> </span><span class="LineAnchor" id="CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa_7"></span><span class="anchor" id="line-7-1"></span>        <span class="ID">coordinates</span> = <span class="ID">mgrid</span>[<span class="ID">slices</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa_8">   8</a> </span><span class="LineAnchor" id="CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa_8"></span><span class="anchor" id="line-8-1"></span>        <span class="ID">indices</span> = <span class="ID">coordinates</span>.<span class="ID">astype</span>(<span class="String">'</span><span class="String">i</span><span class="String">'</span>)   <span class="Comment">#choose the biggest smaller integer index</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa_9">   9</a> </span><span class="LineAnchor" id="CA-dfa610404ef32836baa6bdae8c2eb6fdcbfb8cfa_9"></span><span class="anchor" id="line-9-1"></span>        <span class="ResWord">return</span> <span class="ID">a</span>[<span class="ResWord">tuple</span>(<span class="ID">indices</span>)]</span>
</pre></div></div><span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span><p class="line874">If we were only interested in reducing the sizes by some integer factor then we could use: <span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span><span class="anchor" id="line-29"></span><span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span><span class="anchor" id="line-1-3"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-48c8e57a666a711afc7aa9a9d500d711232483e1\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-48c8e57a666a711afc7aa9a9d500d711232483e1" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-48c8e57a666a711afc7aa9a9d500d711232483e1_1">   1</a> </span><span class="LineAnchor" id="CA-48c8e57a666a711afc7aa9a9d500d711232483e1_1"></span><span class="anchor" id="line-1-4"></span><span class="ResWord">def</span> <span class="ID">rebin_factor</span>( <span class="ID">a</span>, <span class="ID">newshape</span> ):</span>
<span class="line"><span class="LineNumber"><a href="#CA-48c8e57a666a711afc7aa9a9d500d711232483e1_2">   2</a> </span><span class="LineAnchor" id="CA-48c8e57a666a711afc7aa9a9d500d711232483e1_2"></span><span class="anchor" id="line-2-2"></span>        <span class="String">'''Rebin an array to a new shape.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-48c8e57a666a711afc7aa9a9d500d711232483e1_3">   3</a> </span><span class="LineAnchor" id="CA-48c8e57a666a711afc7aa9a9d500d711232483e1_3"></span><span class="anchor" id="line-3-2"></span><span class="String">        newshape must be a factor of a.shape.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-48c8e57a666a711afc7aa9a9d500d711232483e1_4">   4</a> </span><span class="LineAnchor" id="CA-48c8e57a666a711afc7aa9a9d500d711232483e1_4"></span><span class="anchor" id="line-4-2"></span><span class="String">        '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-48c8e57a666a711afc7aa9a9d500d711232483e1_5">   5</a> </span><span class="LineAnchor" id="CA-48c8e57a666a711afc7aa9a9d500d711232483e1_5"></span><span class="anchor" id="line-5-2"></span>        <span class="ResWord">assert</span> <span class="ResWord">len</span>(<span class="ID">a</span>.<span class="ID">shape</span>) == <span class="ResWord">len</span>(<span class="ID">newshape</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-48c8e57a666a711afc7aa9a9d500d711232483e1_6">   6</a> </span><span class="LineAnchor" id="CA-48c8e57a666a711afc7aa9a9d500d711232483e1_6"></span><span class="anchor" id="line-6-2"></span>        <span class="ResWord">assert</span> <span class="ResWord">not</span> <span class="ID">sometrue</span>(<span class="ID">mod</span>( <span class="ID">a</span>.<span class="ID">shape</span>, <span class="ID">newshape</span> ))</span>
<span class="line"><span class="LineNumber"><a href="#CA-48c8e57a666a711afc7aa9a9d500d711232483e1_7">   7</a> </span><span class="LineAnchor" id="CA-48c8e57a666a711afc7aa9a9d500d711232483e1_7"></span><span class="anchor" id="line-7-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-48c8e57a666a711afc7aa9a9d500d711232483e1_8">   8</a> </span><span class="LineAnchor" id="CA-48c8e57a666a711afc7aa9a9d500d711232483e1_8"></span><span class="anchor" id="line-8-2"></span>        <span class="ID">slices</span> = [ <span class="ResWord">slice</span>(<span class="ResWord">None</span>,<span class="ResWord">None</span>, <span class="ID">old</span>/<span class="ID">new</span>) <span class="ResWord">for</span> <span class="ID">old</span>,<span class="ID">new</span> <span class="ResWord">in</span> <span class="ResWord">zip</span>(<span class="ID">a</span>.<span class="ID">shape</span>,<span class="ID">newshape</span>) ]</span>
<span class="line"><span class="LineNumber"><a href="#CA-48c8e57a666a711afc7aa9a9d500d711232483e1_9">   9</a> </span><span class="LineAnchor" id="CA-48c8e57a666a711afc7aa9a9d500d711232483e1_9"></span><span class="anchor" id="line-9-2"></span>        <span class="ResWord">return</span> <span class="ID">a</span>[<span class="ID">slices</span>]</span>
</pre></div></div><span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><p class="line867">
<h2 id="Example_2">Example 2</h2>
<span class="anchor" id="line-36"></span><p class="line874">Here is an other way to deal with the reducing case for ndarrays. This acts identically to IDL's rebin command where all values in the original array are summed and divided amongst the entries in the new array. As in IDL, the new shape must be a factor of the old one. <span class="anchor" id="line-37"></span>The ugly 'evList trick' builds and executes a python command of the form <span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span><p class="line874">a.reshape(args[0],factor[0],).sum(1)/factor[0] <span class="anchor" id="line-40"></span>a.reshape(args[0],factor[0],args[1],factor[1],).sum(1).sum(2)/factor[0]/factor[1] <span class="anchor" id="line-41"></span><span class="anchor" id="line-42"></span><p class="line874">etc. <span class="anchor" id="line-43"></span>This general form is extended to cover the number of required dimensions. <span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span><p class="line867"><span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span><span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span><span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span><span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span><span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span><span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span><span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span><span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span><span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span><span class="anchor" id="line-1-5"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-46627714723b0fd620f3920e0dfa404e42f8777b\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-46627714723b0fd620f3920e0dfa404e42f8777b" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-46627714723b0fd620f3920e0dfa404e42f8777b_1">   1</a> </span><span class="LineAnchor" id="CA-46627714723b0fd620f3920e0dfa404e42f8777b_1"></span><span class="anchor" id="line-1-6"></span><span class="ResWord">def</span> <span class="ID">rebin</span>(<span class="ID">a</span>, *<span class="ID">args</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-46627714723b0fd620f3920e0dfa404e42f8777b_2">   2</a> </span><span class="LineAnchor" id="CA-46627714723b0fd620f3920e0dfa404e42f8777b_2"></span><span class="anchor" id="line-2-3"></span>    <span class="String">'''rebin ndarray data into a smaller ndarray of the same rank whose dimensions</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-46627714723b0fd620f3920e0dfa404e42f8777b_3">   3</a> </span><span class="LineAnchor" id="CA-46627714723b0fd620f3920e0dfa404e42f8777b_3"></span><span class="anchor" id="line-3-3"></span><span class="String">    are factors of the original dimensions. eg. An array with 6 columns and 4 rows</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-46627714723b0fd620f3920e0dfa404e42f8777b_4">   4</a> </span><span class="LineAnchor" id="CA-46627714723b0fd620f3920e0dfa404e42f8777b_4"></span><span class="anchor" id="line-4-3"></span><span class="String">    can be reduced to have 6,3,2 or 1 columns and 4,2 or 1 rows.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-46627714723b0fd620f3920e0dfa404e42f8777b_5">   5</a> </span><span class="LineAnchor" id="CA-46627714723b0fd620f3920e0dfa404e42f8777b_5"></span><span class="anchor" id="line-5-3"></span><span class="String">    example usages:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-46627714723b0fd620f3920e0dfa404e42f8777b_6">   6</a> </span><span class="LineAnchor" id="CA-46627714723b0fd620f3920e0dfa404e42f8777b_6"></span><span class="anchor" id="line-6-3"></span><span class="String">    &gt;&gt;&gt; a=rand(6,4); b=rebin(a,3,2)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-46627714723b0fd620f3920e0dfa404e42f8777b_7">   7</a> </span><span class="LineAnchor" id="CA-46627714723b0fd620f3920e0dfa404e42f8777b_7"></span><span class="anchor" id="line-7-3"></span><span class="String">    &gt;&gt;&gt; a=rand(6); b=rebin(a,2)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-46627714723b0fd620f3920e0dfa404e42f8777b_8">   8</a> </span><span class="LineAnchor" id="CA-46627714723b0fd620f3920e0dfa404e42f8777b_8"></span><span class="anchor" id="line-8-3"></span><span class="String">    '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-46627714723b0fd620f3920e0dfa404e42f8777b_9">   9</a> </span><span class="LineAnchor" id="CA-46627714723b0fd620f3920e0dfa404e42f8777b_9"></span><span class="anchor" id="line-9-3"></span>    <span class="ID">shape</span> = <span class="ID">a</span>.<span class="ID">shape</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-46627714723b0fd620f3920e0dfa404e42f8777b_10">  10</a> </span><span class="LineAnchor" id="CA-46627714723b0fd620f3920e0dfa404e42f8777b_10"></span><span class="anchor" id="line-10-1"></span>    <span class="ID">lenShape</span> = <span class="ResWord">len</span>(<span class="ID">shape</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-46627714723b0fd620f3920e0dfa404e42f8777b_11">  11</a> </span><span class="LineAnchor" id="CA-46627714723b0fd620f3920e0dfa404e42f8777b_11"></span><span class="anchor" id="line-11-1"></span>    <span class="ID">factor</span> = <span class="ID">asarray</span>(<span class="ID">shape</span>)/<span class="ID">asarray</span>(<span class="ID">args</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-46627714723b0fd620f3920e0dfa404e42f8777b_12">  12</a> </span><span class="LineAnchor" id="CA-46627714723b0fd620f3920e0dfa404e42f8777b_12"></span><span class="anchor" id="line-12-1"></span>    <span class="ID">evList</span> = [<span class="String">'</span><span class="String">a.reshape(</span><span class="String">'</span>] + \</span>
<span class="line"><span class="LineNumber"><a href="#CA-46627714723b0fd620f3920e0dfa404e42f8777b_13">  13</a> </span><span class="LineAnchor" id="CA-46627714723b0fd620f3920e0dfa404e42f8777b_13"></span><span class="anchor" id="line-13-1"></span>             [<span class="String">'</span><span class="String">args[</span><span class="String">%d</span><span class="String">],factor[</span><span class="String">%d</span><span class="String">],</span><span class="String">'</span>%(<span class="ID">i</span>,<span class="ID">i</span>) <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ID">lenShape</span>)] + \</span>
<span class="line"><span class="LineNumber"><a href="#CA-46627714723b0fd620f3920e0dfa404e42f8777b_14">  14</a> </span><span class="LineAnchor" id="CA-46627714723b0fd620f3920e0dfa404e42f8777b_14"></span><span class="anchor" id="line-14-1"></span>             [<span class="String">'</span><span class="String">)</span><span class="String">'</span>] + [<span class="String">'</span><span class="String">.sum(</span><span class="String">%d</span><span class="String">)</span><span class="String">'</span>%(<span class="ID">i</span>+<span class="Number">1</span>) <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ID">lenShape</span>)] + \</span>
<span class="line"><span class="LineNumber"><a href="#CA-46627714723b0fd620f3920e0dfa404e42f8777b_15">  15</a> </span><span class="LineAnchor" id="CA-46627714723b0fd620f3920e0dfa404e42f8777b_15"></span><span class="anchor" id="line-15-1"></span>             [<span class="String">'</span><span class="String">/factor[</span><span class="String">%d</span><span class="String">]</span><span class="String">'</span>%<span class="ID">i</span> <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ID">lenShape</span>)]</span>
<span class="line"><span class="LineNumber"><a href="#CA-46627714723b0fd620f3920e0dfa404e42f8777b_16">  16</a> </span><span class="LineAnchor" id="CA-46627714723b0fd620f3920e0dfa404e42f8777b_16"></span><span class="anchor" id="line-16-1"></span>    <span class="ResWord">print</span> <span class="String">'</span><span class="String">'</span>.<span class="ID">join</span>(<span class="ID">evList</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-46627714723b0fd620f3920e0dfa404e42f8777b_17">  17</a> </span><span class="LineAnchor" id="CA-46627714723b0fd620f3920e0dfa404e42f8777b_17"></span><span class="anchor" id="line-17-1"></span>    <span class="ResWord">return</span> <span class="ResWord">eval</span>(<span class="String">'</span><span class="String">'</span>.<span class="ID">join</span>(<span class="ID">evList</span>))</span>
</pre></div></div><span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span><p class="line874">The above code returns an array of the same type as the input array. If the input is an integer array, the output values will be rounded down. If you want a float array which correctly averages the input values without rounding, you can do the following instead. <span class="anchor" id="line-66"></span><span class="anchor" id="line-67"></span><p class="line862">a.reshape(args[0],factor[0],).mean(1) <br>
 <span class="anchor" id="line-68"></span>a.reshape(args[0],factor[0],args[1],factor[1],).mean(1).mean(2) <span class="anchor" id="line-69"></span><span class="anchor" id="line-70"></span><p class="line867"><span class="anchor" id="line-71"></span><span class="anchor" id="line-72"></span><span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span><span class="anchor" id="line-75"></span><span class="anchor" id="line-76"></span><span class="anchor" id="line-77"></span><span class="anchor" id="line-78"></span><span class="anchor" id="line-79"></span><span class="anchor" id="line-80"></span><span class="anchor" id="line-1-7"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a_1">   1</a> </span><span class="LineAnchor" id="CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a_1"></span><span class="anchor" id="line-1-8"></span><span class="ResWord">def</span> <span class="ID">rebin</span>(<span class="ID">a</span>, *<span class="ID">args</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a_2">   2</a> </span><span class="LineAnchor" id="CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a_2"></span><span class="anchor" id="line-2-4"></span>    <span class="ID">shape</span> = <span class="ID">a</span>.<span class="ID">shape</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a_3">   3</a> </span><span class="LineAnchor" id="CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a_3"></span><span class="anchor" id="line-3-4"></span>    <span class="ID">lenShape</span> = <span class="ResWord">len</span>(<span class="ID">shape</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a_4">   4</a> </span><span class="LineAnchor" id="CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a_4"></span><span class="anchor" id="line-4-4"></span>    <span class="ID">factor</span> = <span class="ID">asarray</span>(<span class="ID">shape</span>)/<span class="ID">asarray</span>(<span class="ID">args</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a_5">   5</a> </span><span class="LineAnchor" id="CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a_5"></span><span class="anchor" id="line-5-4"></span>    <span class="ID">evList</span> = [<span class="String">'</span><span class="String">a.reshape(</span><span class="String">'</span>] + \</span>
<span class="line"><span class="LineNumber"><a href="#CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a_6">   6</a> </span><span class="LineAnchor" id="CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a_6"></span><span class="anchor" id="line-6-4"></span>             [<span class="String">'</span><span class="String">args[</span><span class="String">%d</span><span class="String">],factor[</span><span class="String">%d</span><span class="String">],</span><span class="String">'</span>%(<span class="ID">i</span>,<span class="ID">i</span>) <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ID">lenShape</span>)] + \</span>
<span class="line"><span class="LineNumber"><a href="#CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a_7">   7</a> </span><span class="LineAnchor" id="CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a_7"></span><span class="anchor" id="line-7-4"></span>             [<span class="String">'</span><span class="String">)</span><span class="String">'</span>] + [<span class="String">'</span><span class="String">.mean(</span><span class="String">%d</span><span class="String">)</span><span class="String">'</span>%(<span class="ID">i</span>+<span class="Number">1</span>) <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ID">lenShape</span>)]</span>
<span class="line"><span class="LineNumber"><a href="#CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a_8">   8</a> </span><span class="LineAnchor" id="CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a_8"></span><span class="anchor" id="line-8-4"></span>    <span class="ResWord">print</span> <span class="String">'</span><span class="String">'</span>.<span class="ID">join</span>(<span class="ID">evList</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a_9">   9</a> </span><span class="LineAnchor" id="CA-7c5b212eccfdfffe54c3c0e5ed67c22ae5d12d2a_9"></span><span class="anchor" id="line-9-4"></span>    <span class="ResWord">return</span> <span class="ResWord">eval</span>(<span class="String">'</span><span class="String">'</span>.<span class="ID">join</span>(<span class="ID">evList</span>))</span>
</pre></div></div><span class="anchor" id="line-81"></span><span class="anchor" id="line-82"></span><p class="line874">Some test cases: <span class="anchor" id="line-83"></span><span class="anchor" id="line-84"></span><span class="anchor" id="line-85"></span><span class="anchor" id="line-86"></span><span class="anchor" id="line-87"></span><span class="anchor" id="line-88"></span><span class="anchor" id="line-89"></span><span class="anchor" id="line-90"></span><span class="anchor" id="line-91"></span><span class="anchor" id="line-92"></span><span class="anchor" id="line-93"></span><span class="anchor" id="line-94"></span><span class="anchor" id="line-95"></span><span class="anchor" id="line-96"></span><span class="anchor" id="line-97"></span><span class="anchor" id="line-98"></span><span class="anchor" id="line-99"></span><span class="anchor" id="line-100"></span><span class="anchor" id="line-101"></span><span class="anchor" id="line-102"></span><span class="anchor" id="line-103"></span><span class="anchor" id="line-104"></span><span class="anchor" id="line-105"></span><span class="anchor" id="line-1-9"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-998a287785194b6cf814932ac20fd9b011e5b22c\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_1">   1</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_1"></span><span class="anchor" id="line-1-10"></span><span class="Comment"># 2-D case</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_2">   2</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_2"></span><span class="anchor" id="line-2-5"></span><span class="ID">a</span>=<span class="ID">rand</span>(<span class="Number">6</span>,<span class="Number">4</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_3">   3</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_3"></span><span class="anchor" id="line-3-5"></span><span class="ResWord">print</span> <span class="ID">a</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_4">   4</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_4"></span><span class="anchor" id="line-4-5"></span><span class="ID">b</span>=<span class="ID">rebin</span>(<span class="ID">a</span>,<span class="Number">6</span>,<span class="Number">4</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_5">   5</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_5"></span><span class="anchor" id="line-5-5"></span><span class="ResWord">print</span> <span class="ID">b</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_6">   6</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_6"></span><span class="anchor" id="line-6-5"></span><span class="ID">b</span>=<span class="ID">rebin</span>(<span class="ID">a</span>,<span class="Number">6</span>,<span class="Number">2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_7">   7</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_7"></span><span class="anchor" id="line-7-5"></span><span class="ResWord">print</span> <span class="ID">b</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_8">   8</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_8"></span><span class="anchor" id="line-8-5"></span><span class="ID">b</span>=<span class="ID">rebin</span>(<span class="ID">a</span>,<span class="Number">3</span>,<span class="Number">2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_9">   9</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_9"></span><span class="anchor" id="line-9-5"></span><span class="ResWord">print</span> <span class="ID">b</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_10">  10</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_10"></span><span class="anchor" id="line-10-2"></span><span class="ID">b</span>=<span class="ID">rebin</span>(<span class="ID">a</span>,<span class="Number">1</span>,<span class="Number">1</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_11">  11</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_11"></span><span class="anchor" id="line-11-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_12">  12</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_12"></span><span class="anchor" id="line-12-2"></span><span class="Comment"># 1-D case</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_13">  13</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_13"></span><span class="anchor" id="line-13-2"></span><span class="ResWord">print</span> <span class="ID">b</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_14">  14</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_14"></span><span class="anchor" id="line-14-2"></span><span class="ID">a</span>=<span class="ID">rand</span>(<span class="Number">4</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_15">  15</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_15"></span><span class="anchor" id="line-15-2"></span><span class="ResWord">print</span> <span class="ID">a</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_16">  16</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_16"></span><span class="anchor" id="line-16-2"></span><span class="ID">b</span>=<span class="ID">rebin</span>(<span class="ID">a</span>,<span class="Number">4</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_17">  17</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_17"></span><span class="anchor" id="line-17-2"></span><span class="ResWord">print</span> <span class="ID">b</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_18">  18</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_18"></span><span class="anchor" id="line-18-1"></span><span class="ID">b</span>=<span class="ID">rebin</span>(<span class="ID">a</span>,<span class="Number">2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_19">  19</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_19"></span><span class="anchor" id="line-19-1"></span><span class="ResWord">print</span> <span class="ID">b</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_20">  20</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_20"></span><span class="anchor" id="line-20-1"></span><span class="ID">b</span>=<span class="ID">rebin</span>(<span class="ID">a</span>,<span class="Number">1</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-998a287785194b6cf814932ac20fd9b011e5b22c_21">  21</a> </span><span class="LineAnchor" id="CA-998a287785194b6cf814932ac20fd9b011e5b22c_21"></span><span class="anchor" id="line-21-1"></span><span class="ResWord">print</span> <span class="ID">b</span></span>
</pre></div></div><span class="anchor" id="line-106"></span><span class="anchor" id="line-107"></span><span class="anchor" id="line-108"></span><p class="line867">
<h2 id="Example_3">Example 3</h2>
<span class="anchor" id="line-109"></span><p class="line874">A python version of congrid, used in IDL, for resampling of data to arbitrary sizes, using a variety of nearest-neighbour and interpolation routines. <span class="anchor" id="line-110"></span><span class="anchor" id="line-111"></span><p class="line867"><span class="anchor" id="line-112"></span><span class="anchor" id="line-113"></span><span class="anchor" id="line-114"></span><span class="anchor" id="line-115"></span><span class="anchor" id="line-116"></span><span class="anchor" id="line-117"></span><span class="anchor" id="line-118"></span><span class="anchor" id="line-119"></span><span class="anchor" id="line-120"></span><span class="anchor" id="line-121"></span><span class="anchor" id="line-122"></span><span class="anchor" id="line-123"></span><span class="anchor" id="line-124"></span><span class="anchor" id="line-125"></span><span class="anchor" id="line-126"></span><span class="anchor" id="line-127"></span><span class="anchor" id="line-128"></span><span class="anchor" id="line-129"></span><span class="anchor" id="line-130"></span><span class="anchor" id="line-131"></span><span class="anchor" id="line-132"></span><span class="anchor" id="line-133"></span><span class="anchor" id="line-134"></span><span class="anchor" id="line-135"></span><span class="anchor" id="line-136"></span><span class="anchor" id="line-137"></span><span class="anchor" id="line-138"></span><span class="anchor" id="line-139"></span><span class="anchor" id="line-140"></span><span class="anchor" id="line-141"></span><span class="anchor" id="line-142"></span><span class="anchor" id="line-143"></span><span class="anchor" id="line-144"></span><span class="anchor" id="line-145"></span><span class="anchor" id="line-146"></span><span class="anchor" id="line-147"></span><span class="anchor" id="line-148"></span><span class="anchor" id="line-149"></span><span class="anchor" id="line-150"></span><span class="anchor" id="line-151"></span><span class="anchor" id="line-152"></span><span class="anchor" id="line-153"></span><span class="anchor" id="line-154"></span><span class="anchor" id="line-155"></span><span class="anchor" id="line-156"></span><span class="anchor" id="line-157"></span><span class="anchor" id="line-158"></span><span class="anchor" id="line-159"></span><span class="anchor" id="line-160"></span><span class="anchor" id="line-161"></span><span class="anchor" id="line-162"></span><span class="anchor" id="line-163"></span><span class="anchor" id="line-164"></span><span class="anchor" id="line-165"></span><span class="anchor" id="line-166"></span><span class="anchor" id="line-167"></span><span class="anchor" id="line-168"></span><span class="anchor" id="line-169"></span><span class="anchor" id="line-170"></span><span class="anchor" id="line-171"></span><span class="anchor" id="line-172"></span><span class="anchor" id="line-173"></span><span class="anchor" id="line-174"></span><span class="anchor" id="line-175"></span><span class="anchor" id="line-176"></span><span class="anchor" id="line-177"></span><span class="anchor" id="line-178"></span><span class="anchor" id="line-179"></span><span class="anchor" id="line-180"></span><span class="anchor" id="line-181"></span><span class="anchor" id="line-182"></span><span class="anchor" id="line-183"></span><span class="anchor" id="line-184"></span><span class="anchor" id="line-185"></span><span class="anchor" id="line-186"></span><span class="anchor" id="line-187"></span><span class="anchor" id="line-188"></span><span class="anchor" id="line-189"></span><span class="anchor" id="line-190"></span><span class="anchor" id="line-191"></span><span class="anchor" id="line-192"></span><span class="anchor" id="line-193"></span><span class="anchor" id="line-194"></span><span class="anchor" id="line-195"></span><span class="anchor" id="line-196"></span><span class="anchor" id="line-197"></span><span class="anchor" id="line-198"></span><span class="anchor" id="line-199"></span><span class="anchor" id="line-200"></span><span class="anchor" id="line-201"></span><span class="anchor" id="line-202"></span><span class="anchor" id="line-203"></span><span class="anchor" id="line-204"></span><span class="anchor" id="line-205"></span><span class="anchor" id="line-206"></span><span class="anchor" id="line-207"></span><span class="anchor" id="line-208"></span><span class="anchor" id="line-209"></span><span class="anchor" id="line-210"></span><span class="anchor" id="line-211"></span><span class="anchor" id="line-212"></span><span class="anchor" id="line-213"></span><span class="anchor" id="line-214"></span><span class="anchor" id="line-215"></span><span class="anchor" id="line-216"></span><span class="anchor" id="line-217"></span><span class="anchor" id="line-1-11"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_1">   1</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_1"></span><span class="anchor" id="line-1-12"></span><span class="ResWord">import</span> <span class="ID">numpy</span> <span class="ResWord">as</span> <span class="ID">n</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_2">   2</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_2"></span><span class="anchor" id="line-2-6"></span><span class="ResWord">import</span> <span class="ID">scipy.interpolate</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_3">   3</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_3"></span><span class="anchor" id="line-3-6"></span><span class="ResWord">import</span> <span class="ID">scipy.ndimage</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_4">   4</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_4"></span><span class="anchor" id="line-4-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_5">   5</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_5"></span><span class="anchor" id="line-5-6"></span><span class="ResWord">def</span> <span class="ID">congrid</span>(<span class="ID">a</span>, <span class="ID">newdims</span>, <span class="ID">method</span>=<span class="String">'</span><span class="String">linear</span><span class="String">'</span>, <span class="ID">centre</span>=<span class="ResWord">False</span>, <span class="ID">minusone</span>=<span class="ResWord">False</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_6">   6</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_6"></span><span class="anchor" id="line-6-6"></span>    <span class="String">'''Arbitrary resampling of source array to new dimension sizes.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_7">   7</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_7"></span><span class="anchor" id="line-7-6"></span><span class="String">    Currently only supports maintaining the same number of dimensions.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_8">   8</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_8"></span><span class="anchor" id="line-8-6"></span><span class="String">    To use 1-D arrays, first promote them to shape (x,1).</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_9">   9</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_9"></span><span class="anchor" id="line-9-6"></span><span class="String">    </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_10">  10</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_10"></span><span class="anchor" id="line-10-3"></span><span class="String">    Uses the same parameters and creates the same co-ordinate lookup points</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_11">  11</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_11"></span><span class="anchor" id="line-11-3"></span><span class="String">    as IDL''s congrid routine, which apparently originally came from a VAX/VMS</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_12">  12</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_12"></span><span class="anchor" id="line-12-3"></span><span class="String">    routine of the same name.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_13">  13</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_13"></span><span class="anchor" id="line-13-3"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_14">  14</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_14"></span><span class="anchor" id="line-14-3"></span><span class="String">    method:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_15">  15</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_15"></span><span class="anchor" id="line-15-3"></span><span class="String">    neighbour - closest value from original data</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_16">  16</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_16"></span><span class="anchor" id="line-16-3"></span><span class="String">    nearest and linear - uses n x 1-D interpolations using</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_17">  17</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_17"></span><span class="anchor" id="line-17-3"></span><span class="String">                         scipy.interpolate.interp1d</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_18">  18</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_18"></span><span class="anchor" id="line-18-2"></span><span class="String">    (see Numerical Recipes for validity of use of n 1-D interpolations)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_19">  19</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_19"></span><span class="anchor" id="line-19-2"></span><span class="String">    spline - uses ndimage.map_coordinates</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_20">  20</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_20"></span><span class="anchor" id="line-20-2"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_21">  21</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_21"></span><span class="anchor" id="line-21-2"></span><span class="String">    centre:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_22">  22</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_22"></span><span class="anchor" id="line-22-1"></span><span class="String">    True - interpolation points are at the centres of the bins</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_23">  23</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_23"></span><span class="anchor" id="line-23-1"></span><span class="String">    False - points are at the front edge of the bin</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_24">  24</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_24"></span><span class="anchor" id="line-24-1"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_25">  25</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_25"></span><span class="anchor" id="line-25-1"></span><span class="String">    minusone:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_26">  26</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_26"></span><span class="anchor" id="line-26-1"></span><span class="String">    For example- inarray.shape = (i,j) &amp; new dimensions = (x,y)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_27">  27</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_27"></span><span class="anchor" id="line-27-1"></span><span class="String">    False - inarray is resampled by factors of (i/x) * (j/y)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_28">  28</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_28"></span><span class="anchor" id="line-28-1"></span><span class="String">    True - inarray is resampled by(i-1)/(x-1) * (j-1)/(y-1)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_29">  29</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_29"></span><span class="anchor" id="line-29-1"></span><span class="String">    This prevents extrapolation one element beyond bounds of input array.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_30">  30</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_30"></span><span class="anchor" id="line-30-1"></span><span class="String">    '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_31">  31</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_31"></span><span class="anchor" id="line-31-1"></span>    <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">a</span>.<span class="ID">dtype</span> <span class="ResWord">in</span> [<span class="ID">n</span>.<span class="ID">float64</span>, <span class="ID">n</span>.<span class="ID">float32</span>]:</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_32">  32</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_32"></span><span class="anchor" id="line-32-1"></span>        <span class="ID">a</span> = <span class="ID">n</span>.<span class="ID">cast</span>[<span class="ResWord">float</span>](<span class="ID">a</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_33">  33</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_33"></span><span class="anchor" id="line-33-1"></span>    </span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_34">  34</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_34"></span><span class="anchor" id="line-34-1"></span>    <span class="ID">m1</span> = <span class="ID">n</span>.<span class="ID">cast</span>[<span class="ResWord">int</span>](<span class="ID">minusone</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_35">  35</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_35"></span><span class="anchor" id="line-35-1"></span>    <span class="ID">ofs</span> = <span class="ID">n</span>.<span class="ID">cast</span>[<span class="ResWord">int</span>](<span class="ID">centre</span>) * <span class="Number">0.5</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_36">  36</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_36"></span><span class="anchor" id="line-36-1"></span>    <span class="ID">old</span> = <span class="ID">n</span>.<span class="ID">array</span>( <span class="ID">a</span>.<span class="ID">shape</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_37">  37</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_37"></span><span class="anchor" id="line-37-1"></span>    <span class="ID">ndims</span> = <span class="ResWord">len</span>( <span class="ID">a</span>.<span class="ID">shape</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_38">  38</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_38"></span><span class="anchor" id="line-38-1"></span>    <span class="ResWord">if</span> <span class="ResWord">len</span>( <span class="ID">newdims</span> ) != <span class="ID">ndims</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_39">  39</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_39"></span><span class="anchor" id="line-39-1"></span>        <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">[congrid] dimensions error. </span><span class="String">&quot;</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_40">  40</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_40"></span><span class="anchor" id="line-40-1"></span>              <span class="String">&quot;</span><span class="String">This routine currently only support </span><span class="String">&quot;</span> \</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_41">  41</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_41"></span><span class="anchor" id="line-41-1"></span>              <span class="String">&quot;</span><span class="String">rebinning to the same number of dimensions.</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_42">  42</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_42"></span><span class="anchor" id="line-42-1"></span>        <span class="ResWord">return</span> <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_43">  43</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_43"></span><span class="anchor" id="line-43-1"></span>    <span class="ID">newdims</span> = <span class="ID">n</span>.<span class="ID">asarray</span>( <span class="ID">newdims</span>, <span class="ID">dtype</span>=<span class="ResWord">float</span> )    </span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_44">  44</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_44"></span><span class="anchor" id="line-44-1"></span>    <span class="ID">dimlist</span> = []</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_45">  45</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_45"></span><span class="anchor" id="line-45-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_46">  46</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_46"></span><span class="anchor" id="line-46-1"></span>    <span class="ResWord">if</span> <span class="ID">method</span> == <span class="String">'</span><span class="String">neighbour</span><span class="String">'</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_47">  47</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_47"></span><span class="anchor" id="line-47-1"></span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>( <span class="ID">ndims</span> ):</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_48">  48</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_48"></span><span class="anchor" id="line-48-1"></span>            <span class="ID">base</span> = <span class="ID">n</span>.<span class="ID">indices</span>(<span class="ID">newdims</span>)[<span class="ID">i</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_49">  49</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_49"></span><span class="anchor" id="line-49-1"></span>            <span class="ID">dimlist</span>.<span class="ID">append</span>( (<span class="ID">old</span>[<span class="ID">i</span>] - <span class="ID">m1</span>) / (<span class="ID">newdims</span>[<span class="ID">i</span>] - <span class="ID">m1</span>) \</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_50">  50</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_50"></span><span class="anchor" id="line-50-1"></span>                            * (<span class="ID">base</span> + <span class="ID">ofs</span>) - <span class="ID">ofs</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_51">  51</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_51"></span><span class="anchor" id="line-51-1"></span>        <span class="ID">cd</span> = <span class="ID">n</span>.<span class="ID">array</span>( <span class="ID">dimlist</span> ).<span class="ID">round</span>().<span class="ID">astype</span>(<span class="ResWord">int</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_52">  52</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_52"></span><span class="anchor" id="line-52-1"></span>        <span class="ID">newa</span> = <span class="ID">a</span>[<span class="ResWord">list</span>( <span class="ID">cd</span> )]</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_53">  53</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_53"></span><span class="anchor" id="line-53-1"></span>        <span class="ResWord">return</span> <span class="ID">newa</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_54">  54</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_54"></span><span class="anchor" id="line-54-1"></span>    </span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_55">  55</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_55"></span><span class="anchor" id="line-55-1"></span>    <span class="ResWord">elif</span> <span class="ID">method</span> <span class="ResWord">in</span> [<span class="String">'</span><span class="String">nearest</span><span class="String">'</span>,<span class="String">'</span><span class="String">linear</span><span class="String">'</span>]:</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_56">  56</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_56"></span><span class="anchor" id="line-56-1"></span>        <span class="Comment"># calculate new dims</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_57">  57</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_57"></span><span class="anchor" id="line-57-1"></span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>( <span class="ID">ndims</span> ):</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_58">  58</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_58"></span><span class="anchor" id="line-58-1"></span>            <span class="ID">base</span> = <span class="ID">n</span>.<span class="ID">arange</span>( <span class="ID">newdims</span>[<span class="ID">i</span>] )</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_59">  59</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_59"></span><span class="anchor" id="line-59-1"></span>            <span class="ID">dimlist</span>.<span class="ID">append</span>( (<span class="ID">old</span>[<span class="ID">i</span>] - <span class="ID">m1</span>) / (<span class="ID">newdims</span>[<span class="ID">i</span>] - <span class="ID">m1</span>) \</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_60">  60</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_60"></span><span class="anchor" id="line-60-1"></span>                            * (<span class="ID">base</span> + <span class="ID">ofs</span>) - <span class="ID">ofs</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_61">  61</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_61"></span><span class="anchor" id="line-61-1"></span>        <span class="Comment"># specify old dims</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_62">  62</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_62"></span><span class="anchor" id="line-62-1"></span>        <span class="ID">olddims</span> = [<span class="ID">n</span>.<span class="ID">arange</span>(<span class="ID">i</span>, <span class="ID">dtype</span> = <span class="ID">n</span>.<span class="ID">float</span>) <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">list</span>( <span class="ID">a</span>.<span class="ID">shape</span> )]</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_63">  63</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_63"></span><span class="anchor" id="line-63-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_64">  64</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_64"></span><span class="anchor" id="line-64-1"></span>        <span class="Comment"># first interpolation - for ndims = any</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_65">  65</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_65"></span><span class="anchor" id="line-65-1"></span>        <span class="ID">mint</span> = <span class="ID">scipy</span>.<span class="ID">interpolate</span>.<span class="ID">interp1d</span>( <span class="ID">olddims</span>[-<span class="Number">1</span>], <span class="ID">a</span>, <span class="ID">kind</span>=<span class="ID">method</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_66">  66</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_66"></span><span class="anchor" id="line-66-1"></span>        <span class="ID">newa</span> = <span class="ID">mint</span>( <span class="ID">dimlist</span>[-<span class="Number">1</span>] )</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_67">  67</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_67"></span><span class="anchor" id="line-67-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_68">  68</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_68"></span><span class="anchor" id="line-68-1"></span>        <span class="ID">trorder</span> = [<span class="ID">ndims</span> - <span class="Number">1</span>] + <span class="ResWord">range</span>( <span class="ID">ndims</span> - <span class="Number">1</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_69">  69</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_69"></span><span class="anchor" id="line-69-1"></span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>( <span class="ID">ndims</span> - <span class="Number">2</span>, -<span class="Number">1</span>, -<span class="Number">1</span> ):</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_70">  70</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_70"></span><span class="anchor" id="line-70-1"></span>            <span class="ID">newa</span> = <span class="ID">newa</span>.<span class="ID">transpose</span>( <span class="ID">trorder</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_71">  71</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_71"></span><span class="anchor" id="line-71-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_72">  72</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_72"></span><span class="anchor" id="line-72-1"></span>            <span class="ID">mint</span> = <span class="ID">scipy</span>.<span class="ID">interpolate</span>.<span class="ID">interp1d</span>( <span class="ID">olddims</span>[<span class="ID">i</span>], <span class="ID">newa</span>, <span class="ID">kind</span>=<span class="ID">method</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_73">  73</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_73"></span><span class="anchor" id="line-73-1"></span>            <span class="ID">newa</span> = <span class="ID">mint</span>( <span class="ID">dimlist</span>[<span class="ID">i</span>] )</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_74">  74</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_74"></span><span class="anchor" id="line-74-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_75">  75</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_75"></span><span class="anchor" id="line-75-1"></span>        <span class="ResWord">if</span> <span class="ID">ndims</span> &gt; <span class="Number">1</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_76">  76</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_76"></span><span class="anchor" id="line-76-1"></span>            <span class="Comment"># need one more transpose to return to original dimensions</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_77">  77</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_77"></span><span class="anchor" id="line-77-1"></span>            <span class="ID">newa</span> = <span class="ID">newa</span>.<span class="ID">transpose</span>( <span class="ID">trorder</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_78">  78</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_78"></span><span class="anchor" id="line-78-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_79">  79</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_79"></span><span class="anchor" id="line-79-1"></span>        <span class="ResWord">return</span> <span class="ID">newa</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_80">  80</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_80"></span><span class="anchor" id="line-80-1"></span>    <span class="ResWord">elif</span> <span class="ID">method</span> <span class="ResWord">in</span> [<span class="String">'</span><span class="String">spline</span><span class="String">'</span>]:</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_81">  81</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_81"></span><span class="anchor" id="line-81-1"></span>        <span class="ID">oslices</span> = [ <span class="ResWord">slice</span>(<span class="Number">0</span>,<span class="ID">j</span>) <span class="ResWord">for</span> <span class="ID">j</span> <span class="ResWord">in</span> <span class="ID">old</span> ]</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_82">  82</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_82"></span><span class="anchor" id="line-82-1"></span>        <span class="ID">oldcoords</span> = <span class="ID">n</span>.<span class="ID">ogrid</span>[<span class="ID">oslices</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_83">  83</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_83"></span><span class="anchor" id="line-83-1"></span>        <span class="ID">nslices</span> = [ <span class="ResWord">slice</span>(<span class="Number">0</span>,<span class="ID">j</span>) <span class="ResWord">for</span> <span class="ID">j</span> <span class="ResWord">in</span> <span class="ResWord">list</span>(<span class="ID">newdims</span>) ]</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_84">  84</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_84"></span><span class="anchor" id="line-84-1"></span>        <span class="ID">newcoords</span> = <span class="ID">n</span>.<span class="ID">mgrid</span>[<span class="ID">nslices</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_85">  85</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_85"></span><span class="anchor" id="line-85-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_86">  86</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_86"></span><span class="anchor" id="line-86-1"></span>        <span class="ID">newcoords_dims</span> = <span class="ResWord">range</span>(<span class="ID">n</span>.<span class="ID">rank</span>(<span class="ID">newcoords</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_87">  87</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_87"></span><span class="anchor" id="line-87-1"></span>        <span class="Comment">#make first index last</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_88">  88</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_88"></span><span class="anchor" id="line-88-1"></span>        <span class="ID">newcoords_dims</span>.<span class="ID">append</span>(<span class="ID">newcoords_dims</span>.<span class="ID">pop</span>(<span class="Number">0</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_89">  89</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_89"></span><span class="anchor" id="line-89-1"></span>        <span class="ID">newcoords_tr</span> = <span class="ID">newcoords</span>.<span class="ID">transpose</span>(<span class="ID">newcoords_dims</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_90">  90</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_90"></span><span class="anchor" id="line-90-1"></span>        <span class="Comment"># makes a view that affects newcoords</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_91">  91</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_91"></span><span class="anchor" id="line-91-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_92">  92</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_92"></span><span class="anchor" id="line-92-1"></span>        <span class="ID">newcoords_tr</span> += <span class="ID">ofs</span>        </span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_93">  93</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_93"></span><span class="anchor" id="line-93-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_94">  94</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_94"></span><span class="anchor" id="line-94-1"></span>        <span class="ID">deltas</span> = (<span class="ID">n</span>.<span class="ID">asarray</span>(<span class="ID">old</span>) - <span class="ID">m1</span>) / (<span class="ID">newdims</span> - <span class="ID">m1</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_95">  95</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_95"></span><span class="anchor" id="line-95-1"></span>        <span class="ID">newcoords_tr</span> *= <span class="ID">deltas</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_96">  96</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_96"></span><span class="anchor" id="line-96-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_97">  97</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_97"></span><span class="anchor" id="line-97-1"></span>        <span class="ID">newcoords_tr</span> -= <span class="ID">ofs</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_98">  98</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_98"></span><span class="anchor" id="line-98-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_99">  99</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_99"></span><span class="anchor" id="line-99-1"></span>        <span class="ID">newa</span> = <span class="ID">scipy</span>.<span class="ID">ndimage</span>.<span class="ID">map_coordinates</span>(<span class="ID">a</span>, <span class="ID">newcoords</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_100"> 100</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_100"></span><span class="anchor" id="line-100-1"></span>        <span class="ResWord">return</span> <span class="ID">newa</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_101"> 101</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_101"></span><span class="anchor" id="line-101-1"></span>    <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_102"> 102</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_102"></span><span class="anchor" id="line-102-1"></span>        <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">Congrid error: Unrecognized interpolation type.</span><span class="SPChar">\n</span><span class="String">&quot;</span>, \</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_103"> 103</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_103"></span><span class="anchor" id="line-103-1"></span>              <span class="String">&quot;</span><span class="String">Currently only </span><span class="SPChar">\'</span><span class="String">neighbour</span><span class="SPChar">\'</span><span class="String">, </span><span class="SPChar">\'</span><span class="String">nearest</span><span class="SPChar">\'</span><span class="String">,</span><span class="SPChar">\'</span><span class="String">linear</span><span class="SPChar">\'</span><span class="String">,</span><span class="String">&quot;</span>, \</span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_104"> 104</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_104"></span><span class="anchor" id="line-104-1"></span>              <span class="String">&quot;</span><span class="String">and </span><span class="SPChar">\'</span><span class="String">spline</span><span class="SPChar">\'</span><span class="String"> are supported.</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_105"> 105</a> </span><span class="LineAnchor" id="CA-df17909c1d3b3dd76894d74aa7682a802e0ee1d4_105"></span><span class="anchor" id="line-105-1"></span>        <span class="ResWord">return</span> <span class="ResWord">None</span> </span>
</pre></div></div><span class="anchor" id="line-218"></span><p class="line867"><hr /><p class="line874"> <span class="anchor" id="line-219"></span><a href="../CategoryCookbook.html">CategoryCookbook</a> <span class="anchor" id="line-220"></span><span class="anchor" id="bottom"></span></div><p id="pageinfo" class="info" lang="en" dir="ltr">SciPy: Cookbook/Rebinning  (last edited 2015-10-24 17:48:24 by <span title="">anonymous</span>)</p>

<div id="pagebottom"></div>
</div>


<div id="footer">
<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="Rebinning37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../../external.html?link=http://localhost:8080/Cookbook/Rebinning">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

<ul id="credits">
<li><a href="../../external.html?link=http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="../../external.html?link=http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="../../external.html?link=http://moinmo.in/GPL" title="MoinMoin is GPL licensed.">GPL licensed</a></li><li><a href="../../external.html?link=http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li>
</ul>


</div>
</body>

<!-- Mirrored from localhost:8080/Cookbook/Rebinning by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 20:22:13 GMT -->
</html>

