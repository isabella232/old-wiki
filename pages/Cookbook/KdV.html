<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<!-- Mirrored from localhost:8080/Cookbook/KdV by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 20:08:55 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="edit_on_doubleclick" content="/">
<meta name="robots" content="index,nofollow">

<title>Cookbook/KdV - SciPy wiki dump</title>
<script type="text/javascript" src="../moin_static197/common/js/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../moin_static197/modern/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="../moin_static197/modern/css/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="../moin_static197/modern/css/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="../moin_static197/modern/css/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static197/modern/css/msie.css">
<![endif]-->


<link rel="alternate" title="SciPy: Cookbook/KdV" href="../../external.html?link=http://localhost:8080/Cookbook/KdV?diffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=Cookbook%2FKdV&amp;ddiffs=1" type="application/rss+xml">


<link rel="Start" href="../AllPages.html">
<link rel="Alternate" title="Wiki Markup" href="../../external.html?link=http://localhost:8080/Cookbook/KdV?action=raw">
<link rel="Alternate" media="print" title="Print View" href="../../external.html?link=http://localhost:8080/Cookbook/KdV?action=print">
<link rel="Up" href="../Cookbook.html">
<link rel="Appendix" title="kdv.png" href="KdV0a69.html?action=AttachFile&amp;do=view&amp;target=kdv.png">
<link rel="Appendix" title="kdv2.png" href="KdV7921.html?action=AttachFile&amp;do=view&amp;target=kdv2.png">
<link rel="Search" href="../FindPage.html">
<link rel="Index" href="../TitleIndex.html">
<link rel="Glossary" href="../WordIndex.html">
<link rel="Help" href="../HelpOnFormatting.html">
</head>

<body  lang="en" dir="ltr"><div style="background: white; padding:2em;">This is an archival dump of old wiki content --- see <a href="http://scipy.org/">scipy.org</a> for current material.<br>Please see <a href="http://scipy-cookbook.readthedocs.org/">http://scipy-cookbook.readthedocs.org/</a></div>

<div id="header">


<form id="searchform" method="get" action="../../external.html?link=http://localhost:8080/Cookbook/KdV">
<div>
<input type="hidden" name="action" value="fullsearch">
<input type="hidden" name="context" value="180">
<label for="searchinput">Search:</label>
<input id="searchinput" type="text" name="value" value="" size="20"
    onfocus="searchFocus(this)" onblur="searchBlur(this)"
    onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search">
<input id="titlesearch" name="titlesearch" type="submit"
    value="Titles" alt="Search Titles">
<input id="fullsearch" name="fullsearch" type="submit"
    value="Text" alt="Search Full Text">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<ul id="username"><li><a href="KdV456e.html?action=login" id="login" rel="nofollow">Login</a></li></ul>
<div id="locationline">
<div id="interwiki"><span><a href="../AllPages.html" rel="nofollow">SciPy</a></span></div>

<ul id="pagelocation">
<li><a href="../Cookbook.html">Cookbook</a></li><li><a class="backlink" href="KdV2a18.html?action=fullsearch&amp;context=180&amp;value=linkto%3A%22Cookbook%2FKdV%22" rel="nofollow" title="Click to do a full-text search for this title">KdV</a></li>
</ul>

</div>


<ul id="navibar">
<li class="wikilink"><a href="../RecentChanges.html">RecentChanges</a></li><li class="wikilink"><a class="nonexistent" href="../FindPage.html">FindPage</a></li><li class="wikilink"><a class="nonexistent" href="../HelpContents.html">HelpContents</a></li><li class="current"><a href="KdV.html">Cookbook/KdV</a></li>
</ul>

<div id="pageline"><hr style="display:none;"></div>

<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="KdV37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../../external.html?link=http://localhost:8080/Cookbook/KdV">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

</div>

<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><p class="line862">This page shows how the <a class="http" href="../../external.html?link=http://en.wikipedia.org/wiki/Korteweg-de_Vries_equation">Korteweg-de Vries equation</a> can be solved on a periodic domain using the <a class="http" href="../../external.html?link=http://www.scholarpedia.org/article/Method_of_lines">method of lines</a>, with the spatial derivatives computed using the pseudo-spectral method.  In this method, the derivatives are computed in the frequency domain by first applying the FFT to the data, then multiplying by the appropriate values and converting back to the spatial domain with the inverse FFT.  This method of differentiation is implemented by the <strong>diff</strong> function in the module <strong>scipy.fftpack</strong>. <span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><p class="line874">We discretize the spatial domain, and compute the spatial derivatives <span class="anchor" id="line-4"></span>using the <strong>diff</strong> function defined in the <strong>scipy.fftpack</strong> module. <span class="anchor" id="line-5"></span>In the following code, this function is given the alias <strong>psdiff</strong> <span class="anchor" id="line-6"></span>to avoid confusing it with the numpy function <strong>diff</strong>. <span class="anchor" id="line-7"></span>By discretizing only the spatial dimension, we obtain a system of ordinary differential equations, which is implemented in the function <strong>kdv(u, t, L)</strong>.  The function <strong>kdv_solution(u0, t, L)</strong> uses <strong>scipy.integrate.odeint</strong> to solve this system. <span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span><span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span><span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span><span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span><span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span><span class="anchor" id="line-29"></span><span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span><span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span><span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span><span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span><span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span><span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span><span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span><span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span><span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span><span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span><span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span><span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span><span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span><span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span><span class="anchor" id="line-66"></span><span class="anchor" id="line-67"></span><span class="anchor" id="line-68"></span><span class="anchor" id="line-69"></span><span class="anchor" id="line-70"></span><span class="anchor" id="line-71"></span><span class="anchor" id="line-72"></span><span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span><span class="anchor" id="line-1-1"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
function isnumbered(obj) {
  return obj.childNodes.length && obj.firstChild.childNodes.length && obj.firstChild.firstChild.className == 'LineNumber';
}
function nformat(num,chrs,add) {
  var nlen = Math.max(0,chrs-(''+num).length), res = '';
  while (nlen>0) { res += ' '; nlen-- }
  return res+num+add;
}
function addnumber(did, nstart, nstep) {
  var c = document.getElementById(did), l = c.firstChild, n = 1;
  if (!isnumbered(c)) {
    if (typeof nstart == 'undefined') nstart = 1;
    if (typeof nstep  == 'undefined') nstep = 1;
    var n = nstart;
    while (l != null) {
      if (l.tagName == 'SPAN') {
        var s = document.createElement('SPAN');
        var a = document.createElement('A');
        s.className = 'LineNumber';
        a.appendChild(document.createTextNode(nformat(n,4,'')));
        a.href = '#' + did + '_' + n;
        s.appendChild(a);
        s.appendChild(document.createTextNode(' '));
        n += nstep;
        if (l.childNodes.length) {
          l.insertBefore(s, l.firstChild);
        }
        else {
          l.appendChild(s);
        }
      }
      l = l.nextSibling;
    }
  }
  return false;
}
function remnumber(did) {
  var c = document.getElementById(did), l = c.firstChild;
  if (isnumbered(c)) {
    while (l != null) {
      if (l.tagName == 'SPAN' && l.firstChild.className == 'LineNumber') l.removeChild(l.firstChild);
      l = l.nextSibling;
    }
  }
  return false;
}
function togglenumber(did, nstart, nstep) {
  var c = document.getElementById(did);
  if (isnumbered(c)) {
    remnumber(did);
  } else {
    addnumber(did,nstart,nstep);
  }
  return false;
}
</script>

<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_1">   1</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_1"></span><span class="anchor" id="line-1-2"></span><span class="ResWord">import</span> <span class="ID">numpy</span> <span class="ResWord">as</span> <span class="ID">np</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_2">   2</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_2"></span><span class="anchor" id="line-2-1"></span><span class="ResWord">from</span> <span class="ID">scipy.integrate</span> <span class="ResWord">import</span> <span class="ID">odeint</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_3">   3</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_3"></span><span class="anchor" id="line-3-1"></span><span class="ResWord">from</span> <span class="ID">scipy.fftpack</span> <span class="ResWord">import</span> <span class="ID">diff</span> <span class="ResWord">as</span> <span class="ID">psdiff</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_4">   4</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_4"></span><span class="anchor" id="line-4-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_5">   5</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_5"></span><span class="anchor" id="line-5-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_6">   6</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_6"></span><span class="anchor" id="line-6-1"></span><span class="ResWord">def</span> <span class="ID">kdv_exact</span>(<span class="ID">x</span>, <span class="ID">c</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_7">   7</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_7"></span><span class="anchor" id="line-7-1"></span>    <span class="String">&quot;&quot;&quot;Profile of the exact solution to the KdV for a single soliton on the real line.&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_8">   8</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_8"></span><span class="anchor" id="line-8-1"></span>    <span class="ID">u</span> = <span class="Number">0.5</span>*<span class="ID">c</span>*<span class="ID">np</span>.<span class="ID">cosh</span>(<span class="Number">0.5</span>*<span class="ID">np</span>.<span class="ID">sqrt</span>(<span class="ID">c</span>)*<span class="ID">x</span>)**(-<span class="Number">2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_9">   9</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_9"></span><span class="anchor" id="line-9-1"></span>    <span class="ResWord">return</span> <span class="ID">u</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_10">  10</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_10"></span><span class="anchor" id="line-10-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_11">  11</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_11"></span><span class="anchor" id="line-11-1"></span><span class="ResWord">def</span> <span class="ID">kdv</span>(<span class="ID">u</span>, <span class="ID">t</span>, <span class="ID">L</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_12">  12</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_12"></span><span class="anchor" id="line-12-1"></span>    <span class="String">&quot;&quot;&quot;Differential equations for the KdV equation, discretized in x.&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_13">  13</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_13"></span><span class="anchor" id="line-13-1"></span>    <span class="Comment"># Compute the x derivatives using the pseudo-spectral method.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_14">  14</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_14"></span><span class="anchor" id="line-14-1"></span>    <span class="ID">ux</span> = <span class="ID">psdiff</span>(<span class="ID">u</span>, <span class="ID">period</span>=<span class="ID">L</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_15">  15</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_15"></span><span class="anchor" id="line-15-1"></span>    <span class="ID">uxxx</span> = <span class="ID">psdiff</span>(<span class="ID">u</span>, <span class="ID">period</span>=<span class="ID">L</span>, <span class="ID">order</span>=<span class="Number">3</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_16">  16</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_16"></span><span class="anchor" id="line-16-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_17">  17</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_17"></span><span class="anchor" id="line-17-1"></span>    <span class="Comment"># Compute du/dt.    </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_18">  18</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_18"></span><span class="anchor" id="line-18-1"></span>    <span class="ID">dudt</span> = -<span class="Number">6</span>*<span class="ID">u</span>*<span class="ID">ux</span> - <span class="ID">uxxx</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_19">  19</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_19"></span><span class="anchor" id="line-19-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_20">  20</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_20"></span><span class="anchor" id="line-20-1"></span>    <span class="ResWord">return</span> <span class="ID">dudt</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_21">  21</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_21"></span><span class="anchor" id="line-21-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_22">  22</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_22"></span><span class="anchor" id="line-22-1"></span><span class="ResWord">def</span> <span class="ID">kdv_solution</span>(<span class="ID">u0</span>, <span class="ID">t</span>, <span class="ID">L</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_23">  23</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_23"></span><span class="anchor" id="line-23-1"></span>    <span class="String">&quot;&quot;&quot;Use odeint to solve the KdV equation on a periodic domain.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_24">  24</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_24"></span><span class="anchor" id="line-24-1"></span><span class="String">    </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_25">  25</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_25"></span><span class="anchor" id="line-25-1"></span><span class="String">    `u0` is initial condition, `t` is the array of time values at which</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_26">  26</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_26"></span><span class="anchor" id="line-26-1"></span><span class="String">    the solution is to be computed, and `L` is the length of the periodic</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_27">  27</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_27"></span><span class="anchor" id="line-27-1"></span><span class="String">    domain.&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_28">  28</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_28"></span><span class="anchor" id="line-28-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_29">  29</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_29"></span><span class="anchor" id="line-29-1"></span>    <span class="ID">sol</span> = <span class="ID">odeint</span>(<span class="ID">kdv</span>, <span class="ID">u0</span>, <span class="ID">t</span>, <span class="ID">args</span>=(<span class="ID">L</span>,), <span class="ID">mxstep</span>=<span class="Number">5000</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_30">  30</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_30"></span><span class="anchor" id="line-30-1"></span>    <span class="ResWord">return</span> <span class="ID">sol</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_31">  31</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_31"></span><span class="anchor" id="line-31-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_32">  32</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_32"></span><span class="anchor" id="line-32-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_33">  33</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_33"></span><span class="anchor" id="line-33-1"></span><span class="ResWord">if</span> <span class="ID">__name__</span> == <span class="String">&quot;</span><span class="String">__main__</span><span class="String">&quot;</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_34">  34</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_34"></span><span class="anchor" id="line-34-1"></span>    <span class="Comment"># Set the size of the domain, and create the discretized grid.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_35">  35</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_35"></span><span class="anchor" id="line-35-1"></span>    <span class="ID">L</span> = <span class="Number">50.0</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_36">  36</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_36"></span><span class="anchor" id="line-36-1"></span>    <span class="ID">N</span> = <span class="Number">64</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_37">  37</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_37"></span><span class="anchor" id="line-37-1"></span>    <span class="ID">dx</span> = <span class="ID">L</span> / (<span class="ID">N</span> - <span class="Number">1.0</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_38">  38</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_38"></span><span class="anchor" id="line-38-1"></span>    <span class="ID">x</span> = <span class="ID">np</span>.<span class="ID">linspace</span>(<span class="Number">0</span>, (<span class="Number">1</span>-<span class="Number">1.0</span>/<span class="ID">N</span>)*<span class="ID">L</span>, <span class="ID">N</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_39">  39</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_39"></span><span class="anchor" id="line-39-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_40">  40</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_40"></span><span class="anchor" id="line-40-1"></span>    <span class="Comment"># Set the initial conditions.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_41">  41</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_41"></span><span class="anchor" id="line-41-1"></span>    <span class="Comment"># Not exact for two solitons on a periodic domain, but close enough...</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_42">  42</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_42"></span><span class="anchor" id="line-42-1"></span>    <span class="ID">u0</span> = <span class="ID">kdv_exact</span>(<span class="ID">x</span>-<span class="Number">0.33</span>*<span class="ID">L</span>, <span class="Number">0.75</span>) + <span class="ID">kdv_exact</span>(<span class="ID">x</span>-<span class="Number">0.65</span>*<span class="ID">L</span>, <span class="Number">0.4</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_43">  43</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_43"></span><span class="anchor" id="line-43-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_44">  44</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_44"></span><span class="anchor" id="line-44-1"></span>    <span class="Comment"># Set the time sample grid.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_45">  45</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_45"></span><span class="anchor" id="line-45-1"></span>    <span class="ID">T</span> = <span class="Number">200</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_46">  46</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_46"></span><span class="anchor" id="line-46-1"></span>    <span class="ID">t</span> = <span class="ID">np</span>.<span class="ID">linspace</span>(<span class="Number">0</span>, <span class="ID">T</span>, <span class="Number">501</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_47">  47</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_47"></span><span class="anchor" id="line-47-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_48">  48</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_48"></span><span class="anchor" id="line-48-1"></span>    <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">Computing the solution.</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_49">  49</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_49"></span><span class="anchor" id="line-49-1"></span>    <span class="ID">sol</span> = <span class="ID">kdv_solution</span>(<span class="ID">u0</span>, <span class="ID">t</span>, <span class="ID">L</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_50">  50</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_50"></span><span class="anchor" id="line-50-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_51">  51</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_51"></span><span class="anchor" id="line-51-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_52">  52</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_52"></span><span class="anchor" id="line-52-1"></span>    <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">Plotting.</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_53">  53</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_53"></span><span class="anchor" id="line-53-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_54">  54</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_54"></span><span class="anchor" id="line-54-1"></span>    <span class="ResWord">import</span> <span class="ID">matplotlib.pyplot</span> <span class="ResWord">as</span> <span class="ID">plt</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_55">  55</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_55"></span><span class="anchor" id="line-55-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_56">  56</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_56"></span><span class="anchor" id="line-56-1"></span>    <span class="ID">plt</span>.<span class="ID">figure</span>(<span class="ID">figsize</span>=(<span class="Number">6</span>,<span class="Number">5</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_57">  57</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_57"></span><span class="anchor" id="line-57-1"></span>    <span class="ID">plt</span>.<span class="ID">imshow</span>(<span class="ID">sol</span>[::-<span class="Number">1</span>, :], <span class="ID">extent</span>=[<span class="Number">0</span>,<span class="ID">L</span>,<span class="Number">0</span>,<span class="ID">T</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_58">  58</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_58"></span><span class="anchor" id="line-58-1"></span>    <span class="ID">plt</span>.<span class="ID">colorbar</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_59">  59</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_59"></span><span class="anchor" id="line-59-1"></span>    <span class="ID">plt</span>.<span class="ID">xlabel</span>(<span class="String">'</span><span class="String">x</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_60">  60</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_60"></span><span class="anchor" id="line-60-1"></span>    <span class="ID">plt</span>.<span class="ID">ylabel</span>(<span class="String">'</span><span class="String">t</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_61">  61</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_61"></span><span class="anchor" id="line-61-1"></span>    <span class="ID">plt</span>.<span class="ID">axis</span>(<span class="String">'</span><span class="String">normal</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_62">  62</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_62"></span><span class="anchor" id="line-62-1"></span>    <span class="ID">plt</span>.<span class="ID">title</span>(<span class="String">'</span><span class="String">Korteweg-de Vries on a Periodic Domain</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_63">  63</a> </span><span class="LineAnchor" id="CA-d3fed585ddc206cc37a8774dc7b2c3f14c03cc4c_63"></span><span class="anchor" id="line-63-1"></span>    <span class="ID">plt</span>.<span class="ID">show</span>()</span>
</pre></div></div><span class="anchor" id="line-75"></span><span class="anchor" id="line-76"></span><p class="line874">The following plot is created by the above code: <span class="anchor" id="line-77"></span><span class="anchor" id="line-78"></span><p class="line867"><img alt="kdv2.png" class="attachment" src="kdv2d59d.png?action=AttachFile&amp;do=get&amp;target=kdv2.png" title="kdv2.png" /> <span class="anchor" id="line-79"></span><span class="anchor" id="bottom"></span></div><p id="pageinfo" class="info" lang="en" dir="ltr">SciPy: Cookbook/KdV  (last edited 2015-10-24 17:48:25 by <span title="">anonymous</span>)</p>

<div id="pagebottom"></div>
</div>


<div id="footer">
<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="KdV37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../../external.html?link=http://localhost:8080/Cookbook/KdV">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

<ul id="credits">
<li><a href="../../external.html?link=http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="../../external.html?link=http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="../../external.html?link=http://moinmo.in/GPL" title="MoinMoin is GPL licensed.">GPL licensed</a></li><li><a href="../../external.html?link=http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li>
</ul>


</div>
</body>

<!-- Mirrored from localhost:8080/Cookbook/KdV by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 20:08:56 GMT -->
</html>

