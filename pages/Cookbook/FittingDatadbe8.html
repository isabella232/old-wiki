<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<!-- Mirrored from localhost:8080/Cookbook/FittingData?action=recoverpass by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 23:19:03 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="edit_on_doubleclick" content="/">
<meta name="robots" content="noindex,nofollow">

<title>Cookbook/FittingData - SciPy wiki dump</title>
<script type="text/javascript" src="../moin_static197/common/js/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../moin_static197/modern/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="../moin_static197/modern/css/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="../moin_static197/modern/css/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="../moin_static197/modern/css/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static197/modern/css/msie.css">
<![endif]-->


<link rel="alternate" title="SciPy: Cookbook/FittingData" href="../../external.html?link=http://localhost:8080/Cookbook/FittingData?diffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=Cookbook%2FFittingData&amp;ddiffs=1" type="application/rss+xml">


<link rel="Start" href="../AllPages.html">
<link rel="Alternate" title="Wiki Markup" href="../../external.html?link=http://localhost:8080/Cookbook/FittingData?action=raw">
<link rel="Alternate" media="print" title="Print View" href="../../external.html?link=http://localhost:8080/Cookbook/FittingData?action=print">
<link rel="Up" href="../Cookbook.html">
<link rel="Appendix" title="datafit.png" href="FittingDataa2fd.html?action=AttachFile&amp;do=view&amp;target=datafit.png">
<link rel="Appendix" title="fitgaussian.png" href="FittingData6ace.html?action=AttachFile&amp;do=view&amp;target=fitgaussian.png">
<link rel="Appendix" title="gaussfitter.py" href="FittingData659c.html?action=AttachFile&amp;do=view&amp;target=gaussfitter.py">
<link rel="Appendix" title="gaussfitter2.py" href="FittingData422c.html?action=AttachFile&amp;do=view&amp;target=gaussfitter2.py">
<link rel="Appendix" title="gaussianfit.png" href="FittingData3338.html?action=AttachFile&amp;do=view&amp;target=gaussianfit.png">
<link rel="Appendix" title="power_law_fit.png" href="FittingData2d0c.html?action=AttachFile&amp;do=view&amp;target=power_law_fit.png">
<link rel="Search" href="../FindPage.html">
<link rel="Index" href="../TitleIndex.html">
<link rel="Glossary" href="../WordIndex.html">
<link rel="Help" href="../HelpOnFormatting.html">
</head>

<body  lang="en" dir="ltr"><div style="background: white; padding:2em;">This is an archival dump of old wiki content --- see <a href="http://scipy.org/">scipy.org</a> for current material.<br>Please see <a href="http://scipy-cookbook.readthedocs.org/">http://scipy-cookbook.readthedocs.org/</a></div>

<div id="header">


<form id="searchform" method="get" action="../../external.html?link=http://localhost:8080/Cookbook/FittingData">
<div>
<input type="hidden" name="action" value="fullsearch">
<input type="hidden" name="context" value="180">
<label for="searchinput">Search:</label>
<input id="searchinput" type="text" name="value" value="" size="20"
    onfocus="searchFocus(this)" onblur="searchBlur(this)"
    onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search">
<input id="titlesearch" name="titlesearch" type="submit"
    value="Titles" alt="Search Titles">
<input id="fullsearch" name="fullsearch" type="submit"
    value="Text" alt="Search Full Text">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<ul id="username"><li><a href="FittingData456e.html?action=login" id="login" rel="nofollow">Login</a></li></ul>
<div id="locationline">
<div id="interwiki"><span><a href="../AllPages.html" rel="nofollow">SciPy</a></span></div>

<ul id="pagelocation">
<li><a href="../Cookbook.html">Cookbook</a></li><li><a class="backlink" href="FittingDatab0e8.html?action=fullsearch&amp;context=180&amp;value=linkto%3A%22Cookbook%2FFittingData%22" rel="nofollow" title="Click to do a full-text search for this title">FittingData</a></li>
</ul>

</div>


<ul id="navibar">
<li class="wikilink"><a href="../RecentChanges.html">RecentChanges</a></li><li class="wikilink"><a class="nonexistent" href="../FindPage.html">FindPage</a></li><li class="wikilink"><a class="nonexistent" href="../HelpContents.html">HelpContents</a></li><li class="current"><a href="FittingData.html">Cookbook/FittingData</a></li>
</ul>

<div id="pageline"><hr style="display:none;"></div>
<div id="message">
<p><div class="warning">This wiki is not enabled for mail processing.
Contact the owner of the wiki, who can enable email.</div></p><a class="clear-link" href="FittingData.html">Clear message</a>
</div>

<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="FittingData37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../../external.html?link=http://localhost:8080/Cookbook/FittingData">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

</div>

<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><p class="line874">This page shows you how to fit experimental data and plots the results using matplotlib. <span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><p class="line867"><div class="table-of-contents"><p class="table-of-contents-heading">Contents<ol><li>
<a href="#Fit_examples_with_sinusoidal_functions">Fit examples with sinusoidal functions</a><ol><li>
<a href="#Generating_the_data">Generating the data</a></li><li>
<a href="#Fitting_the_data">Fitting the data</a></li><li>
<a href="#A_clever_use_of_the_cost_function">A clever use of the cost function</a></li></ol></li><li>
<a href="#Simplifying_the_syntax">Simplifying the syntax</a></li><li>
<a href="#Fitting_gaussian-shaped_data">Fitting gaussian-shaped data</a><ol><li>
<a href="#Calculating_the_moments_of_the_distribution">Calculating the moments of the distribution</a></li><li>
<a href="#Fitting_a_2D_gaussian">Fitting a 2D gaussian</a></li></ol></li><li>
<a href="#Fitting_a_power-law_to_data_with_errors">Fitting a power-law to data with errors</a><ol><li>
<a href="#Generating_the_data-1">Generating the data</a></li><li>
<a href="#Fitting_the_data-1">Fitting the data</a></li></ol></li></ol></div> <span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span><p class="line867">
<h1 id="Fit_examples_with_sinusoidal_functions">Fit examples with sinusoidal functions</h1>
<span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><p class="line867">
<h2 id="Generating_the_data">Generating the data</h2>
<span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><p class="line874">Using real data is much more fun, but, just so that you can reproduce this example I will generate data to fit <span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span><p class="line867"><span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span><span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span><span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span><span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span><span class="anchor" id="line-1-1"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
function isnumbered(obj) {
  return obj.childNodes.length && obj.firstChild.childNodes.length && obj.firstChild.firstChild.className == 'LineNumber';
}
function nformat(num,chrs,add) {
  var nlen = Math.max(0,chrs-(''+num).length), res = '';
  while (nlen>0) { res += ' '; nlen-- }
  return res+num+add;
}
function addnumber(did, nstart, nstep) {
  var c = document.getElementById(did), l = c.firstChild, n = 1;
  if (!isnumbered(c)) {
    if (typeof nstart == 'undefined') nstart = 1;
    if (typeof nstep  == 'undefined') nstep = 1;
    var n = nstart;
    while (l != null) {
      if (l.tagName == 'SPAN') {
        var s = document.createElement('SPAN');
        var a = document.createElement('A');
        s.className = 'LineNumber';
        a.appendChild(document.createTextNode(nformat(n,4,'')));
        a.href = '#' + did + '_' + n;
        s.appendChild(a);
        s.appendChild(document.createTextNode(' '));
        n += nstep;
        if (l.childNodes.length) {
          l.insertBefore(s, l.firstChild);
        }
        else {
          l.appendChild(s);
        }
      }
      l = l.nextSibling;
    }
  }
  return false;
}
function remnumber(did) {
  var c = document.getElementById(did), l = c.firstChild;
  if (isnumbered(c)) {
    while (l != null) {
      if (l.tagName == 'SPAN' && l.firstChild.className == 'LineNumber') l.removeChild(l.firstChild);
      l = l.nextSibling;
    }
  }
  return false;
}
function togglenumber(did, nstart, nstep) {
  var c = document.getElementById(did);
  if (isnumbered(c)) {
    remnumber(did);
  } else {
    addnumber(did,nstart,nstep);
  }
  return false;
}
</script>

<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_1">   1</a> </span><span class="LineAnchor" id="CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_1"></span><span class="anchor" id="line-1-2"></span><span class="ResWord">from</span> <span class="ID">pylab</span> <span class="ResWord">import</span> *</span>
<span class="line"><span class="LineNumber"><a href="#CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_2">   2</a> </span><span class="LineAnchor" id="CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_2"></span><span class="anchor" id="line-2-1"></span><span class="ResWord">from</span> <span class="ID">scipy</span> <span class="ResWord">import</span> *</span>
<span class="line"><span class="LineNumber"><a href="#CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_3">   3</a> </span><span class="LineAnchor" id="CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_3"></span><span class="anchor" id="line-3-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_4">   4</a> </span><span class="LineAnchor" id="CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_4"></span><span class="anchor" id="line-4-1"></span><span class="Comment"># if you experience problem &quot;optimize not found&quot;, try to uncomment the following line. The problem is present at least at Ubuntu Lucid python scipy package</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_5">   5</a> </span><span class="LineAnchor" id="CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_5"></span><span class="anchor" id="line-5-1"></span><span class="Comment"># from scipy import optimize</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_6">   6</a> </span><span class="LineAnchor" id="CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_6"></span><span class="anchor" id="line-6-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_7">   7</a> </span><span class="LineAnchor" id="CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_7"></span><span class="anchor" id="line-7-1"></span><span class="Comment"># Generate data points with noise</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_8">   8</a> </span><span class="LineAnchor" id="CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_8"></span><span class="anchor" id="line-8-1"></span><span class="ID">num_points</span> = <span class="Number">150</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_9">   9</a> </span><span class="LineAnchor" id="CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_9"></span><span class="anchor" id="line-9-1"></span><span class="ID">Tx</span> = <span class="ID">linspace</span>(<span class="Number">5.</span>, <span class="Number">8.</span>, <span class="ID">num_points</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_10">  10</a> </span><span class="LineAnchor" id="CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_10"></span><span class="anchor" id="line-10-1"></span><span class="ID">Ty</span> = <span class="ID">Tx</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_11">  11</a> </span><span class="LineAnchor" id="CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_11"></span><span class="anchor" id="line-11-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_12">  12</a> </span><span class="LineAnchor" id="CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_12"></span><span class="anchor" id="line-12-1"></span><span class="ID">tX</span> = <span class="Number">11.86</span>*<span class="ID">cos</span>(<span class="Number">2</span>*<span class="ID">pi</span>/<span class="Number">0.81</span>*<span class="ID">Tx</span>-<span class="Number">1.32</span>) + <span class="Number">0.64</span>*<span class="ID">Tx</span>+<span class="Number">4</span>*((<span class="Number">0.5</span>-<span class="ID">rand</span>(<span class="ID">num_points</span>))*<span class="ID">exp</span>(<span class="Number">2</span>*<span class="ID">rand</span>(<span class="ID">num_points</span>)**<span class="Number">2</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_13">  13</a> </span><span class="LineAnchor" id="CA-029e9ae12c0592e5c90cf64b2b75493a82c5351b_13"></span><span class="anchor" id="line-13-1"></span><span class="ID">tY</span> = -<span class="Number">32.14</span>*<span class="ID">cos</span>(<span class="Number">2</span>*<span class="ID">pi</span>/<span class="Number">0.8</span>*<span class="ID">Ty</span>-<span class="Number">1.94</span>) + <span class="Number">0.15</span>*<span class="ID">Ty</span>+<span class="Number">7</span>*((<span class="Number">0.5</span>-<span class="ID">rand</span>(<span class="ID">num_points</span>))*<span class="ID">exp</span>(<span class="Number">2</span>*<span class="ID">rand</span>(<span class="ID">num_points</span>)**<span class="Number">2</span>))</span>
</pre></div></div><span class="anchor" id="line-28"></span><span class="anchor" id="line-29"></span><p class="line867">
<h2 id="Fitting_the_data">Fitting the data</h2>
<span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span><p class="line874">We now have two sets of data: Tx and Ty, the time series, and tX and tY, sinusoidal data with noise. We are interested in finding the frequency of the sine wave. <span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span><p class="line867"><span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span><span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span><span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span><span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span><span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span><span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span><span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span><span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span><span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span><span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span><span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span><span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span><span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span><span class="anchor" id="line-66"></span><span class="anchor" id="line-1-3"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-563b70db82a0851044a04c35bcf4dedab449c937\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-563b70db82a0851044a04c35bcf4dedab449c937" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_1">   1</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_1"></span><span class="anchor" id="line-1-4"></span><span class="Comment"># Fit the first set</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_2">   2</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_2"></span><span class="anchor" id="line-2-2"></span><span class="ID">fitfunc</span> = <span class="ResWord">lambda</span> <span class="ID">p</span>, <span class="ID">x</span>: <span class="ID">p</span>[<span class="Number">0</span>]*<span class="ID">cos</span>(<span class="Number">2</span>*<span class="ID">pi</span>/<span class="ID">p</span>[<span class="Number">1</span>]*<span class="ID">x</span>+<span class="ID">p</span>[<span class="Number">2</span>]) + <span class="ID">p</span>[<span class="Number">3</span>]*<span class="ID">x</span> <span class="Comment"># Target function</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_3">   3</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_3"></span><span class="anchor" id="line-3-2"></span><span class="ID">errfunc</span> = <span class="ResWord">lambda</span> <span class="ID">p</span>, <span class="ID">x</span>, <span class="ID">y</span>: <span class="ID">fitfunc</span>(<span class="ID">p</span>, <span class="ID">x</span>) - <span class="ID">y</span> <span class="Comment"># Distance to the target function</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_4">   4</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_4"></span><span class="anchor" id="line-4-2"></span><span class="ID">p0</span> = [-<span class="Number">15.</span>, <span class="Number">0.8</span>, <span class="Number">0.</span>, -<span class="Number">1.</span>] <span class="Comment"># Initial guess for the parameters</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_5">   5</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_5"></span><span class="anchor" id="line-5-2"></span><span class="ID">p1</span>, <span class="ID">success</span> = <span class="ID">optimize</span>.<span class="ID">leastsq</span>(<span class="ID">errfunc</span>, <span class="ID">p0</span>[:], <span class="ID">args</span>=(<span class="ID">Tx</span>, <span class="ID">tX</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_6">   6</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_6"></span><span class="anchor" id="line-6-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_7">   7</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_7"></span><span class="anchor" id="line-7-2"></span><span class="ID">time</span> = <span class="ID">linspace</span>(<span class="ID">Tx</span>.<span class="ID">min</span>(), <span class="ID">Tx</span>.<span class="ID">max</span>(), <span class="Number">100</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_8">   8</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_8"></span><span class="anchor" id="line-8-2"></span><span class="ID">plot</span>(<span class="ID">Tx</span>, <span class="ID">tX</span>, <span class="String">&quot;</span><span class="String">ro</span><span class="String">&quot;</span>, <span class="ID">time</span>, <span class="ID">fitfunc</span>(<span class="ID">p1</span>, <span class="ID">time</span>), <span class="String">&quot;</span><span class="String">r-</span><span class="String">&quot;</span>) <span class="Comment"># Plot of the data and the fit</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_9">   9</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_9"></span><span class="anchor" id="line-9-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_10">  10</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_10"></span><span class="anchor" id="line-10-2"></span><span class="Comment"># Fit the second set</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_11">  11</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_11"></span><span class="anchor" id="line-11-2"></span><span class="ID">p0</span> = [-<span class="Number">15.</span>, <span class="Number">0.8</span>, <span class="Number">0.</span>, -<span class="Number">1.</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_12">  12</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_12"></span><span class="anchor" id="line-12-2"></span><span class="ID">p2</span>,<span class="ID">success</span> = <span class="ID">optimize</span>.<span class="ID">leastsq</span>(<span class="ID">errfunc</span>, <span class="ID">p0</span>[:], <span class="ID">args</span>=(<span class="ID">Ty</span>, <span class="ID">tY</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_13">  13</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_13"></span><span class="anchor" id="line-13-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_14">  14</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_14"></span><span class="anchor" id="line-14-1"></span><span class="ID">time</span> = <span class="ID">linspace</span>(<span class="ID">Ty</span>.<span class="ID">min</span>(), <span class="ID">Ty</span>.<span class="ID">max</span>(), <span class="Number">100</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_15">  15</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_15"></span><span class="anchor" id="line-15-1"></span><span class="ID">plot</span>(<span class="ID">Ty</span>, <span class="ID">tY</span>, <span class="String">&quot;</span><span class="String">b^</span><span class="String">&quot;</span>, <span class="ID">time</span>, <span class="ID">fitfunc</span>(<span class="ID">p2</span>, <span class="ID">time</span>), <span class="String">&quot;</span><span class="String">b-</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_16">  16</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_16"></span><span class="anchor" id="line-16-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_17">  17</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_17"></span><span class="anchor" id="line-17-1"></span><span class="Comment"># Legend the plot</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_18">  18</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_18"></span><span class="anchor" id="line-18-1"></span><span class="ID">title</span>(<span class="String">&quot;</span><span class="String">Oscillations in the compressed trap</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_19">  19</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_19"></span><span class="anchor" id="line-19-1"></span><span class="ID">xlabel</span>(<span class="String">&quot;</span><span class="String">time [ms]</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_20">  20</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_20"></span><span class="anchor" id="line-20-1"></span><span class="ID">ylabel</span>(<span class="String">&quot;</span><span class="String">displacement [um]</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_21">  21</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_21"></span><span class="anchor" id="line-21-1"></span><span class="ID">legend</span>((<span class="String">'</span><span class="String">x position</span><span class="String">'</span>, <span class="String">'</span><span class="String">x fit</span><span class="String">'</span>, <span class="String">'</span><span class="String">y position</span><span class="String">'</span>, <span class="String">'</span><span class="String">y fit</span><span class="String">'</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_22">  22</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_22"></span><span class="anchor" id="line-22-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_23">  23</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_23"></span><span class="anchor" id="line-23-1"></span><span class="ID">ax</span> = <span class="ID">axes</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_24">  24</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_24"></span><span class="anchor" id="line-24-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_25">  25</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_25"></span><span class="anchor" id="line-25-1"></span><span class="ID">text</span>(<span class="Number">0.8</span>, <span class="Number">0.07</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_26">  26</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_26"></span><span class="anchor" id="line-26-1"></span>     <span class="String">'</span><span class="String">x freq :  </span><span class="String">%.3f</span><span class="String"> kHz </span><span class="SPChar">\n</span><span class="String"> y freq :  </span><span class="String">%.3f</span><span class="String"> kHz</span><span class="String">'</span> % (<span class="Number">1</span>/<span class="ID">p1</span>[<span class="Number">1</span>],<span class="Number">1</span>/<span class="ID">p2</span>[<span class="Number">1</span>]),</span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_27">  27</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_27"></span><span class="anchor" id="line-27-1"></span>     <span class="ID">fontsize</span>=<span class="Number">16</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_28">  28</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_28"></span><span class="anchor" id="line-28-1"></span>     <span class="ID">horizontalalignment</span>=<span class="String">'</span><span class="String">center</span><span class="String">'</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_29">  29</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_29"></span><span class="anchor" id="line-29-1"></span>     <span class="ID">verticalalignment</span>=<span class="String">'</span><span class="String">center</span><span class="String">'</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_30">  30</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_30"></span><span class="anchor" id="line-30-1"></span>     <span class="ID">transform</span>=<span class="ID">ax</span>.<span class="ID">transAxes</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_31">  31</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_31"></span><span class="anchor" id="line-31-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-563b70db82a0851044a04c35bcf4dedab449c937_32">  32</a> </span><span class="LineAnchor" id="CA-563b70db82a0851044a04c35bcf4dedab449c937_32"></span><span class="anchor" id="line-32-1"></span><span class="ID">show</span>()</span>
</pre></div></div><span class="anchor" id="line-67"></span><span class="anchor" id="line-68"></span><p class="line867"><img alt="datafit.png" class="attachment" src="datafit59fc.png?action=AttachFile&amp;do=get&amp;target=datafit.png" title="datafit.png" /> <span class="anchor" id="line-69"></span><span class="anchor" id="line-70"></span><p class="line867">
<h2 id="A_clever_use_of_the_cost_function">A clever use of the cost function</h2>
<span class="anchor" id="line-71"></span><span class="anchor" id="line-72"></span><p class="line874">Suppose that you have the same data set: two time-series of oscillating phenomena, but that you know that the frequency of the two oscillations is the same. A clever use of the cost function can allow you to fit both set of data in one fit, using the same frequency. The idea is that you return, as a &quot;cost&quot; array, the concatenation of the costs of your two data sets for one choice of parameters. Thus the leastsq routine is optimizing both data sets at the same time. <span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span><p class="line867"><span class="anchor" id="line-75"></span><span class="anchor" id="line-76"></span><span class="anchor" id="line-77"></span><span class="anchor" id="line-78"></span><span class="anchor" id="line-79"></span><span class="anchor" id="line-80"></span><span class="anchor" id="line-81"></span><span class="anchor" id="line-82"></span><span class="anchor" id="line-83"></span><span class="anchor" id="line-84"></span><span class="anchor" id="line-85"></span><span class="anchor" id="line-86"></span><span class="anchor" id="line-87"></span><span class="anchor" id="line-88"></span><span class="anchor" id="line-89"></span><span class="anchor" id="line-90"></span><span class="anchor" id="line-91"></span><span class="anchor" id="line-92"></span><span class="anchor" id="line-93"></span><span class="anchor" id="line-94"></span><span class="anchor" id="line-95"></span><span class="anchor" id="line-96"></span><span class="anchor" id="line-97"></span><span class="anchor" id="line-98"></span><span class="anchor" id="line-99"></span><span class="anchor" id="line-100"></span><span class="anchor" id="line-101"></span><span class="anchor" id="line-102"></span><span class="anchor" id="line-103"></span><span class="anchor" id="line-104"></span><span class="anchor" id="line-105"></span><span class="anchor" id="line-106"></span><span class="anchor" id="line-107"></span><span class="anchor" id="line-108"></span><span class="anchor" id="line-109"></span><span class="anchor" id="line-110"></span><span class="anchor" id="line-111"></span><span class="anchor" id="line-112"></span><span class="anchor" id="line-113"></span><span class="anchor" id="line-114"></span><span class="anchor" id="line-115"></span><span class="anchor" id="line-1-5"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-80574021d5ded9411027308792cae0ad646fa9ce\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-80574021d5ded9411027308792cae0ad646fa9ce" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_1">   1</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_1"></span><span class="anchor" id="line-1-6"></span><span class="Comment"># Target function</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_2">   2</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_2"></span><span class="anchor" id="line-2-3"></span><span class="ID">fitfunc</span> = <span class="ResWord">lambda</span> <span class="ID">T</span>, <span class="ID">p</span>, <span class="ID">x</span>: <span class="ID">p</span>[<span class="Number">0</span>]*<span class="ID">cos</span>(<span class="Number">2</span>*<span class="ID">pi</span>/<span class="ID">T</span>*<span class="ID">x</span>+<span class="ID">p</span>[<span class="Number">1</span>]) + <span class="ID">p</span>[<span class="Number">2</span>]*<span class="ID">x</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_3">   3</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_3"></span><span class="anchor" id="line-3-3"></span><span class="Comment"># Initial guess for the first set's parameters</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_4">   4</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_4"></span><span class="anchor" id="line-4-3"></span><span class="ID">p1</span> = <span class="ID">r_</span>[-<span class="Number">15.</span>, <span class="Number">0.</span>, -<span class="Number">1.</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_5">   5</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_5"></span><span class="anchor" id="line-5-3"></span><span class="Comment"># Initial guess for the second set's parameters</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_6">   6</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_6"></span><span class="anchor" id="line-6-3"></span><span class="ID">p2</span> = <span class="ID">r_</span>[-<span class="Number">15.</span>, <span class="Number">0.</span>, -<span class="Number">1.</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_7">   7</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_7"></span><span class="anchor" id="line-7-3"></span><span class="Comment"># Initial guess for the common period</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_8">   8</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_8"></span><span class="anchor" id="line-8-3"></span><span class="ID">T</span> = <span class="Number">0.8</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_9">   9</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_9"></span><span class="anchor" id="line-9-3"></span><span class="Comment"># Vector of the parameters to fit, it contains all the parameters of the problem, and the period of the oscillation is not there twice !</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_10">  10</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_10"></span><span class="anchor" id="line-10-3"></span><span class="ID">p</span> = <span class="ID">r_</span>[<span class="ID">T</span>, <span class="ID">p1</span>, <span class="ID">p2</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_11">  11</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_11"></span><span class="anchor" id="line-11-3"></span><span class="Comment"># Cost function of the fit, compare it to the previous example.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_12">  12</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_12"></span><span class="anchor" id="line-12-3"></span><span class="ID">errfunc</span> = <span class="ResWord">lambda</span> <span class="ID">p</span>, <span class="ID">x1</span>, <span class="ID">y1</span>, <span class="ID">x2</span>, <span class="ID">y2</span>: <span class="ID">r_</span>[</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_13">  13</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_13"></span><span class="anchor" id="line-13-3"></span>                <span class="ID">fitfunc</span>(<span class="ID">p</span>[<span class="Number">0</span>], <span class="ID">p</span>[<span class="Number">1</span>:<span class="Number">4</span>], <span class="ID">x1</span>) - <span class="ID">y1</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_14">  14</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_14"></span><span class="anchor" id="line-14-2"></span>                <span class="ID">fitfunc</span>(<span class="ID">p</span>[<span class="Number">0</span>], <span class="ID">p</span>[<span class="Number">4</span>:<span class="Number">7</span>], <span class="ID">x2</span>) - <span class="ID">y2</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_15">  15</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_15"></span><span class="anchor" id="line-15-2"></span>            ]</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_16">  16</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_16"></span><span class="anchor" id="line-16-2"></span><span class="Comment"># This time we need to pass the two sets of data, there are thus four &quot;args&quot;.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_17">  17</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_17"></span><span class="anchor" id="line-17-2"></span><span class="ID">p</span>,<span class="ID">success</span> = <span class="ID">optimize</span>.<span class="ID">leastsq</span>(<span class="ID">errfunc</span>, <span class="ID">p</span>, <span class="ID">args</span>=(<span class="ID">Tx</span>, <span class="ID">tX</span>, <span class="ID">Ty</span>, <span class="ID">tY</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_18">  18</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_18"></span><span class="anchor" id="line-18-2"></span><span class="ID">time</span> = <span class="ID">linspace</span>(<span class="ID">Tx</span>.<span class="ID">min</span>(), <span class="ID">Tx</span>.<span class="ID">max</span>(), <span class="Number">100</span>) <span class="Comment"># Plot of the first data and the fit</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_19">  19</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_19"></span><span class="anchor" id="line-19-2"></span><span class="ID">plot</span>(<span class="ID">Tx</span>, <span class="ID">tX</span>, <span class="String">&quot;</span><span class="String">ro</span><span class="String">&quot;</span>, <span class="ID">time</span>, <span class="ID">fitfunc</span>(<span class="ID">p</span>[<span class="Number">0</span>], <span class="ID">p</span>[<span class="Number">1</span>:<span class="Number">4</span>], <span class="ID">time</span>),<span class="String">&quot;</span><span class="String">r-</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_20">  20</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_20"></span><span class="anchor" id="line-20-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_21">  21</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_21"></span><span class="anchor" id="line-21-2"></span><span class="Comment"># Plot of the second data and the fit</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_22">  22</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_22"></span><span class="anchor" id="line-22-2"></span><span class="ID">time</span> = <span class="ID">linspace</span>(<span class="ID">Ty</span>.<span class="ID">min</span>(), <span class="ID">Ty</span>.<span class="ID">max</span>(),<span class="Number">100</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_23">  23</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_23"></span><span class="anchor" id="line-23-2"></span><span class="ID">plot</span>(<span class="ID">Ty</span>, <span class="ID">tY</span>, <span class="String">&quot;</span><span class="String">b^</span><span class="String">&quot;</span>, <span class="ID">time</span>, <span class="ID">fitfunc</span>(<span class="ID">p</span>[<span class="Number">0</span>], <span class="ID">p</span>[<span class="Number">4</span>:<span class="Number">7</span>], <span class="ID">time</span>),<span class="String">&quot;</span><span class="String">b-</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_24">  24</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_24"></span><span class="anchor" id="line-24-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_25">  25</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_25"></span><span class="anchor" id="line-25-2"></span><span class="Comment"># Legend the plot</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_26">  26</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_26"></span><span class="anchor" id="line-26-2"></span><span class="ID">title</span>(<span class="String">&quot;</span><span class="String">Oscillations in the compressed trap</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_27">  27</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_27"></span><span class="anchor" id="line-27-2"></span><span class="ID">xlabel</span>(<span class="String">&quot;</span><span class="String">time [ms]</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_28">  28</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_28"></span><span class="anchor" id="line-28-2"></span><span class="ID">ylabel</span>(<span class="String">&quot;</span><span class="String">displacement [um]</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_29">  29</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_29"></span><span class="anchor" id="line-29-2"></span><span class="ID">legend</span>((<span class="String">'</span><span class="String">x position</span><span class="String">'</span>, <span class="String">'</span><span class="String">x fit</span><span class="String">'</span>, <span class="String">'</span><span class="String">y position</span><span class="String">'</span>, <span class="String">'</span><span class="String">y fit</span><span class="String">'</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_30">  30</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_30"></span><span class="anchor" id="line-30-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_31">  31</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_31"></span><span class="anchor" id="line-31-2"></span><span class="ID">ax</span> = <span class="ID">axes</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_32">  32</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_32"></span><span class="anchor" id="line-32-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_33">  33</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_33"></span><span class="anchor" id="line-33-1"></span><span class="ID">text</span>(<span class="Number">0.8</span>, <span class="Number">0.07</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_34">  34</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_34"></span><span class="anchor" id="line-34-1"></span>     <span class="String">'</span><span class="String">x freq :  </span><span class="String">%.3f</span><span class="String"> kHz</span><span class="String">'</span> % (<span class="Number">1</span>/<span class="ID">p</span>[<span class="Number">0</span>]),</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_35">  35</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_35"></span><span class="anchor" id="line-35-1"></span>     <span class="ID">fontsize</span>=<span class="Number">16</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_36">  36</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_36"></span><span class="anchor" id="line-36-1"></span>     <span class="ID">horizontalalignment</span>=<span class="String">'</span><span class="String">center</span><span class="String">'</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_37">  37</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_37"></span><span class="anchor" id="line-37-1"></span>     <span class="ID">verticalalignment</span>=<span class="String">'</span><span class="String">center</span><span class="String">'</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_38">  38</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_38"></span><span class="anchor" id="line-38-1"></span>     <span class="ID">transform</span>=<span class="ID">ax</span>.<span class="ID">transAxes</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_39">  39</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_39"></span><span class="anchor" id="line-39-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-80574021d5ded9411027308792cae0ad646fa9ce_40">  40</a> </span><span class="LineAnchor" id="CA-80574021d5ded9411027308792cae0ad646fa9ce_40"></span><span class="anchor" id="line-40-1"></span><span class="ID">show</span>()</span>
</pre></div></div><span class="anchor" id="line-116"></span><span class="anchor" id="line-117"></span><p class="line867">
<h1 id="Simplifying_the_syntax">Simplifying the syntax</h1>
<span class="anchor" id="line-118"></span><span class="anchor" id="line-119"></span><p class="line874">Especially when using fits for interactive use, the standard syntax for <span class="anchor" id="line-120"></span>optimize.leastsq can get really long. Using the following script can simplify your <span class="anchor" id="line-121"></span>life: <span class="anchor" id="line-122"></span><span class="anchor" id="line-123"></span><p class="line867"><span class="anchor" id="line-124"></span><span class="anchor" id="line-125"></span><span class="anchor" id="line-126"></span><span class="anchor" id="line-127"></span><span class="anchor" id="line-128"></span><span class="anchor" id="line-129"></span><span class="anchor" id="line-130"></span><span class="anchor" id="line-131"></span><span class="anchor" id="line-132"></span><span class="anchor" id="line-133"></span><span class="anchor" id="line-134"></span><span class="anchor" id="line-135"></span><span class="anchor" id="line-136"></span><span class="anchor" id="line-137"></span><span class="anchor" id="line-138"></span><span class="anchor" id="line-139"></span><span class="anchor" id="line-140"></span><span class="anchor" id="line-141"></span><span class="anchor" id="line-142"></span><span class="anchor" id="line-143"></span><span class="anchor" id="line-144"></span><span class="anchor" id="line-145"></span><span class="anchor" id="line-146"></span><span class="anchor" id="line-147"></span><span class="anchor" id="line-148"></span><span class="anchor" id="line-1-7"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-f6f57481b349a5b86c3664d571012ad39fd16c8b\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_1">   1</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_1"></span><span class="anchor" id="line-1-8"></span><span class="ResWord">from</span> <span class="ID">scipy</span> <span class="ResWord">import</span> <span class="ID">optimize</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_2">   2</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_2"></span><span class="anchor" id="line-2-4"></span><span class="ResWord">from</span> <span class="ID">numpy</span> <span class="ResWord">import</span> *</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_3">   3</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_3"></span><span class="anchor" id="line-3-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_4">   4</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_4"></span><span class="anchor" id="line-4-4"></span><span class="ResWord">class</span> <span class="ID">Parameter</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_5">   5</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_5"></span><span class="anchor" id="line-5-4"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">value</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_6">   6</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_6"></span><span class="anchor" id="line-6-4"></span>            <span class="ResWord">self</span>.<span class="ID">value</span> = <span class="ID">value</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_7">   7</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_7"></span><span class="anchor" id="line-7-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_8">   8</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_8"></span><span class="anchor" id="line-8-4"></span>    <span class="ResWord">def</span> <span class="ID">set</span>(<span class="ResWord">self</span>, <span class="ID">value</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_9">   9</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_9"></span><span class="anchor" id="line-9-4"></span>            <span class="ResWord">self</span>.<span class="ID">value</span> = <span class="ID">value</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_10">  10</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_10"></span><span class="anchor" id="line-10-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_11">  11</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_11"></span><span class="anchor" id="line-11-4"></span>    <span class="ResWord">def</span> <span class="ID">__call__</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_12">  12</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_12"></span><span class="anchor" id="line-12-4"></span>            <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">value</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_13">  13</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_13"></span><span class="anchor" id="line-13-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_14">  14</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_14"></span><span class="anchor" id="line-14-3"></span><span class="ResWord">def</span> <span class="ID">fit</span>(<span class="ID">function</span>, <span class="ID">parameters</span>, <span class="ID">y</span>, <span class="ID">x</span> = <span class="ResWord">None</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_15">  15</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_15"></span><span class="anchor" id="line-15-3"></span>    <span class="ResWord">def</span> <span class="ID">f</span>(<span class="ID">params</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_16">  16</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_16"></span><span class="anchor" id="line-16-3"></span>        <span class="ID">i</span> = <span class="Number">0</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_17">  17</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_17"></span><span class="anchor" id="line-17-3"></span>        <span class="ResWord">for</span> <span class="ID">p</span> <span class="ResWord">in</span> <span class="ID">parameters</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_18">  18</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_18"></span><span class="anchor" id="line-18-3"></span>            <span class="ID">p</span>.<span class="ID">set</span>(<span class="ID">params</span>[<span class="ID">i</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_19">  19</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_19"></span><span class="anchor" id="line-19-3"></span>            <span class="ID">i</span> += <span class="Number">1</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_20">  20</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_20"></span><span class="anchor" id="line-20-3"></span>        <span class="ResWord">return</span> <span class="ID">y</span> - <span class="ID">function</span>(<span class="ID">x</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_21">  21</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_21"></span><span class="anchor" id="line-21-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_22">  22</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_22"></span><span class="anchor" id="line-22-3"></span>    <span class="ResWord">if</span> <span class="ID">x</span> <span class="ResWord">is</span> <span class="ResWord">None</span>: <span class="ID">x</span> = <span class="ID">arange</span>(<span class="ID">y</span>.<span class="ID">shape</span>[<span class="Number">0</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_23">  23</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_23"></span><span class="anchor" id="line-23-3"></span>    <span class="ID">p</span> = [<span class="ID">param</span>() <span class="ResWord">for</span> <span class="ID">param</span> <span class="ResWord">in</span> <span class="ID">parameters</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_24">  24</a> </span><span class="LineAnchor" id="CA-f6f57481b349a5b86c3664d571012ad39fd16c8b_24"></span><span class="anchor" id="line-24-3"></span>    <span class="ID">optimize</span>.<span class="ID">leastsq</span>(<span class="ID">f</span>, <span class="ID">p</span>)</span>
</pre></div></div><span class="anchor" id="line-149"></span><span class="anchor" id="line-150"></span><p class="line874">Now fitting becomes really easy, for example fitting to a gaussian: <span class="anchor" id="line-151"></span><span class="anchor" id="line-152"></span><p class="line867"><span class="anchor" id="line-153"></span><span class="anchor" id="line-154"></span><span class="anchor" id="line-155"></span><span class="anchor" id="line-156"></span><span class="anchor" id="line-157"></span><span class="anchor" id="line-158"></span><span class="anchor" id="line-159"></span><span class="anchor" id="line-160"></span><span class="anchor" id="line-161"></span><span class="anchor" id="line-162"></span><span class="anchor" id="line-163"></span><span class="anchor" id="line-1-9"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-c5fd4237e240e28f6072674ae59e5b20d0bca790\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-c5fd4237e240e28f6072674ae59e5b20d0bca790" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_1">   1</a> </span><span class="LineAnchor" id="CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_1"></span><span class="anchor" id="line-1-10"></span><span class="Comment"># giving initial parameters</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_2">   2</a> </span><span class="LineAnchor" id="CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_2"></span><span class="anchor" id="line-2-5"></span><span class="ID">mu</span> = <span class="ID">Parameter</span>(<span class="Number">7</span>)                     </span>
<span class="line"><span class="LineNumber"><a href="#CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_3">   3</a> </span><span class="LineAnchor" id="CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_3"></span><span class="anchor" id="line-3-5"></span><span class="ID">sigma</span> = <span class="ID">Parameter</span>(<span class="Number">3</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_4">   4</a> </span><span class="LineAnchor" id="CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_4"></span><span class="anchor" id="line-4-5"></span><span class="ID">height</span> = <span class="ID">Parameter</span>(<span class="Number">5</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_5">   5</a> </span><span class="LineAnchor" id="CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_5"></span><span class="anchor" id="line-5-5"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_6">   6</a> </span><span class="LineAnchor" id="CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_6"></span><span class="anchor" id="line-6-5"></span><span class="Comment"># define your function:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_7">   7</a> </span><span class="LineAnchor" id="CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_7"></span><span class="anchor" id="line-7-5"></span><span class="ResWord">def</span> <span class="ID">f</span>(<span class="ID">x</span>): <span class="ResWord">return</span> <span class="ID">height</span>() * <span class="ID">exp</span>(-((<span class="ID">x</span>-<span class="ID">mu</span>())/<span class="ID">sigma</span>())**<span class="Number">2</span>) </span>
<span class="line"><span class="LineNumber"><a href="#CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_8">   8</a> </span><span class="LineAnchor" id="CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_8"></span><span class="anchor" id="line-8-5"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_9">   9</a> </span><span class="LineAnchor" id="CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_9"></span><span class="anchor" id="line-9-5"></span><span class="Comment"># fit! (given that data is an array with the data to fit)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_10">  10</a> </span><span class="LineAnchor" id="CA-c5fd4237e240e28f6072674ae59e5b20d0bca790_10"></span><span class="anchor" id="line-10-5"></span><span class="ID">fit</span>(<span class="ID">f</span>, [<span class="ID">mu</span>, <span class="ID">sigma</span>, <span class="ID">height</span>], <span class="ID">data</span>)</span>
</pre></div></div><span class="anchor" id="line-164"></span><span class="anchor" id="line-165"></span><p class="line867">
<h1 id="Fitting_gaussian-shaped_data">Fitting gaussian-shaped data</h1>
<span class="anchor" id="line-166"></span><span class="anchor" id="line-167"></span><p class="line867">
<h2 id="Calculating_the_moments_of_the_distribution">Calculating the moments of the distribution</h2>
<span class="anchor" id="line-168"></span><span class="anchor" id="line-169"></span><p class="line874">Fitting gaussian-shaped data does not require an optimization routine. Just calculating the moments of the distribution is enough, and this is much faster. <span class="anchor" id="line-170"></span><span class="anchor" id="line-171"></span><p class="line874">However this works only if the gaussian is not cut out too much, and if it is not too small. <span class="anchor" id="line-172"></span><span class="anchor" id="line-173"></span><p class="line867"><span class="anchor" id="line-174"></span><span class="anchor" id="line-175"></span><span class="anchor" id="line-176"></span><span class="anchor" id="line-177"></span><span class="anchor" id="line-178"></span><span class="anchor" id="line-179"></span><span class="anchor" id="line-180"></span><span class="anchor" id="line-181"></span><span class="anchor" id="line-182"></span><span class="anchor" id="line-183"></span><span class="anchor" id="line-184"></span><span class="anchor" id="line-185"></span><span class="anchor" id="line-186"></span><span class="anchor" id="line-187"></span><span class="anchor" id="line-188"></span><span class="anchor" id="line-189"></span><span class="anchor" id="line-190"></span><span class="anchor" id="line-191"></span><span class="anchor" id="line-192"></span><span class="anchor" id="line-193"></span><span class="anchor" id="line-1-11"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_1">   1</a> </span><span class="LineAnchor" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_1"></span><span class="anchor" id="line-1-12"></span><span class="ResWord">from</span> <span class="ID">pylab</span> <span class="ResWord">import</span> *</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_2">   2</a> </span><span class="LineAnchor" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_2"></span><span class="anchor" id="line-2-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_3">   3</a> </span><span class="LineAnchor" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_3"></span><span class="anchor" id="line-3-6"></span><span class="ID">gaussian</span> = <span class="ResWord">lambda</span> <span class="ID">x</span>: <span class="Number">3</span>*<span class="ID">exp</span>(-(<span class="Number">30</span>-<span class="ID">x</span>)**<span class="Number">2</span>/<span class="Number">20.</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_4">   4</a> </span><span class="LineAnchor" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_4"></span><span class="anchor" id="line-4-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_5">   5</a> </span><span class="LineAnchor" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_5"></span><span class="anchor" id="line-5-6"></span><span class="ID">data</span> = <span class="ID">gaussian</span>(<span class="ID">arange</span>(<span class="Number">100</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_6">   6</a> </span><span class="LineAnchor" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_6"></span><span class="anchor" id="line-6-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_7">   7</a> </span><span class="LineAnchor" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_7"></span><span class="anchor" id="line-7-6"></span><span class="ID">plot</span>(<span class="ID">data</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_8">   8</a> </span><span class="LineAnchor" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_8"></span><span class="anchor" id="line-8-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_9">   9</a> </span><span class="LineAnchor" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_9"></span><span class="anchor" id="line-9-6"></span><span class="ID">X</span> = <span class="ID">arange</span>(<span class="ID">data</span>.<span class="ID">size</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_10">  10</a> </span><span class="LineAnchor" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_10"></span><span class="anchor" id="line-10-6"></span><span class="ID">x</span> = <span class="ResWord">sum</span>(<span class="ID">X</span>*<span class="ID">data</span>)/<span class="ResWord">sum</span>(<span class="ID">data</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_11">  11</a> </span><span class="LineAnchor" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_11"></span><span class="anchor" id="line-11-5"></span><span class="ID">width</span> = <span class="ID">sqrt</span>(<span class="ResWord">abs</span>(<span class="ResWord">sum</span>((<span class="ID">X</span>-<span class="ID">x</span>)**<span class="Number">2</span>*<span class="ID">data</span>)/<span class="ResWord">sum</span>(<span class="ID">data</span>)))</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_12">  12</a> </span><span class="LineAnchor" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_12"></span><span class="anchor" id="line-12-5"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_13">  13</a> </span><span class="LineAnchor" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_13"></span><span class="anchor" id="line-13-5"></span><span class="ResWord">max</span> = <span class="ID">data</span>.<span class="ID">max</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_14">  14</a> </span><span class="LineAnchor" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_14"></span><span class="anchor" id="line-14-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_15">  15</a> </span><span class="LineAnchor" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_15"></span><span class="anchor" id="line-15-4"></span><span class="ID">fit</span> = <span class="ResWord">lambda</span> <span class="ID">t</span> : <span class="ResWord">max</span>*<span class="ID">exp</span>(-(<span class="ID">t</span>-<span class="ID">x</span>)**<span class="Number">2</span>/(<span class="Number">2</span>*<span class="ID">width</span>**<span class="Number">2</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_16">  16</a> </span><span class="LineAnchor" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_16"></span><span class="anchor" id="line-16-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_17">  17</a> </span><span class="LineAnchor" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_17"></span><span class="anchor" id="line-17-4"></span><span class="ID">plot</span>(<span class="ID">fit</span>(<span class="ID">X</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_18">  18</a> </span><span class="LineAnchor" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_18"></span><span class="anchor" id="line-18-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_19">  19</a> </span><span class="LineAnchor" id="CA-3d9a4a4bf811f15a1cd262204bf584fc3e1833de_19"></span><span class="anchor" id="line-19-4"></span><span class="ID">show</span>()</span>
</pre></div></div><span class="anchor" id="line-194"></span><span class="anchor" id="line-195"></span><p class="line867"><img alt="gaussianfit.png" class="attachment" src="gaussianfitafe4.png?action=AttachFile&amp;do=get&amp;target=gaussianfit.png" title="gaussianfit.png" /> <span class="anchor" id="line-196"></span><span class="anchor" id="line-197"></span><p class="line867">
<h2 id="Fitting_a_2D_gaussian">Fitting a 2D gaussian</h2>
<span class="anchor" id="line-198"></span><span class="anchor" id="line-199"></span><p class="line862">Here is robust code to fit a 2D gaussian. It calculates the moments of the data to guess the initial parameters for an optimization routine.  For a more complete gaussian, one with an optional additive constant and rotation, see <a class="http" href="../../external.html?link=http://code.google.com/p/agpy/source/browse/trunk/agpy/gaussfitter.py">http://code.google.com/p/agpy/source/browse/trunk/agpy/gaussfitter.py</a>.  It also allows the specification of a known error. <span class="anchor" id="line-200"></span><span class="anchor" id="line-201"></span><p class="line867"><span class="anchor" id="line-202"></span><span class="anchor" id="line-203"></span><span class="anchor" id="line-204"></span><span class="anchor" id="line-205"></span><span class="anchor" id="line-206"></span><span class="anchor" id="line-207"></span><span class="anchor" id="line-208"></span><span class="anchor" id="line-209"></span><span class="anchor" id="line-210"></span><span class="anchor" id="line-211"></span><span class="anchor" id="line-212"></span><span class="anchor" id="line-213"></span><span class="anchor" id="line-214"></span><span class="anchor" id="line-215"></span><span class="anchor" id="line-216"></span><span class="anchor" id="line-217"></span><span class="anchor" id="line-218"></span><span class="anchor" id="line-219"></span><span class="anchor" id="line-220"></span><span class="anchor" id="line-221"></span><span class="anchor" id="line-222"></span><span class="anchor" id="line-223"></span><span class="anchor" id="line-224"></span><span class="anchor" id="line-225"></span><span class="anchor" id="line-226"></span><span class="anchor" id="line-227"></span><span class="anchor" id="line-228"></span><span class="anchor" id="line-229"></span><span class="anchor" id="line-230"></span><span class="anchor" id="line-231"></span><span class="anchor" id="line-232"></span><span class="anchor" id="line-233"></span><span class="anchor" id="line-234"></span><span class="anchor" id="line-235"></span><span class="anchor" id="line-1-13"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_1">   1</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_1"></span><span class="anchor" id="line-1-14"></span><span class="ResWord">from</span> <span class="ID">numpy</span> <span class="ResWord">import</span> *</span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_2">   2</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_2"></span><span class="anchor" id="line-2-7"></span><span class="ResWord">from</span> <span class="ID">scipy</span> <span class="ResWord">import</span> <span class="ID">optimize</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_3">   3</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_3"></span><span class="anchor" id="line-3-7"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_4">   4</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_4"></span><span class="anchor" id="line-4-7"></span><span class="ResWord">def</span> <span class="ID">gaussian</span>(<span class="ID">height</span>, <span class="ID">center_x</span>, <span class="ID">center_y</span>, <span class="ID">width_x</span>, <span class="ID">width_y</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_5">   5</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_5"></span><span class="anchor" id="line-5-7"></span>    <span class="String">&quot;&quot;&quot;Returns a gaussian function with the given parameters&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_6">   6</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_6"></span><span class="anchor" id="line-6-7"></span>    <span class="ID">width_x</span> = <span class="ResWord">float</span>(<span class="ID">width_x</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_7">   7</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_7"></span><span class="anchor" id="line-7-7"></span>    <span class="ID">width_y</span> = <span class="ResWord">float</span>(<span class="ID">width_y</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_8">   8</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_8"></span><span class="anchor" id="line-8-7"></span>    <span class="ResWord">return</span> <span class="ResWord">lambda</span> <span class="ID">x</span>,<span class="ID">y</span>: <span class="ID">height</span>*<span class="ID">exp</span>(</span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_9">   9</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_9"></span><span class="anchor" id="line-9-7"></span>                -(((<span class="ID">center_x</span>-<span class="ID">x</span>)/<span class="ID">width_x</span>)**<span class="Number">2</span>+((<span class="ID">center_y</span>-<span class="ID">y</span>)/<span class="ID">width_y</span>)**<span class="Number">2</span>)/<span class="Number">2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_10">  10</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_10"></span><span class="anchor" id="line-10-7"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_11">  11</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_11"></span><span class="anchor" id="line-11-6"></span><span class="ResWord">def</span> <span class="ID">moments</span>(<span class="ID">data</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_12">  12</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_12"></span><span class="anchor" id="line-12-6"></span>    <span class="String">&quot;&quot;&quot;Returns (height, x, y, width_x, width_y)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_13">  13</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_13"></span><span class="anchor" id="line-13-6"></span><span class="String">    the gaussian parameters of a 2D distribution by calculating its</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_14">  14</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_14"></span><span class="anchor" id="line-14-5"></span><span class="String">    moments &quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_15">  15</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_15"></span><span class="anchor" id="line-15-5"></span>    <span class="ID">total</span> = <span class="ID">data</span>.<span class="ID">sum</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_16">  16</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_16"></span><span class="anchor" id="line-16-5"></span>    <span class="ID">X</span>, <span class="ID">Y</span> = <span class="ID">indices</span>(<span class="ID">data</span>.<span class="ID">shape</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_17">  17</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_17"></span><span class="anchor" id="line-17-5"></span>    <span class="ID">x</span> = (<span class="ID">X</span>*<span class="ID">data</span>).<span class="ID">sum</span>()/<span class="ID">total</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_18">  18</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_18"></span><span class="anchor" id="line-18-5"></span>    <span class="ID">y</span> = (<span class="ID">Y</span>*<span class="ID">data</span>).<span class="ID">sum</span>()/<span class="ID">total</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_19">  19</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_19"></span><span class="anchor" id="line-19-5"></span>    <span class="ID">col</span> = <span class="ID">data</span>[:, <span class="ResWord">int</span>(<span class="ID">y</span>)]</span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_20">  20</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_20"></span><span class="anchor" id="line-20-4"></span>    <span class="ID">width_x</span> = <span class="ID">sqrt</span>(<span class="ResWord">abs</span>((<span class="ID">arange</span>(<span class="ID">col</span>.<span class="ID">size</span>)-<span class="ID">y</span>)**<span class="Number">2</span>*<span class="ID">col</span>).<span class="ID">sum</span>()/<span class="ID">col</span>.<span class="ID">sum</span>())</span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_21">  21</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_21"></span><span class="anchor" id="line-21-4"></span>    <span class="ID">row</span> = <span class="ID">data</span>[<span class="ResWord">int</span>(<span class="ID">x</span>), :]</span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_22">  22</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_22"></span><span class="anchor" id="line-22-4"></span>    <span class="ID">width_y</span> = <span class="ID">sqrt</span>(<span class="ResWord">abs</span>((<span class="ID">arange</span>(<span class="ID">row</span>.<span class="ID">size</span>)-<span class="ID">x</span>)**<span class="Number">2</span>*<span class="ID">row</span>).<span class="ID">sum</span>()/<span class="ID">row</span>.<span class="ID">sum</span>())</span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_23">  23</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_23"></span><span class="anchor" id="line-23-4"></span>    <span class="ID">height</span> = <span class="ID">data</span>.<span class="ID">max</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_24">  24</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_24"></span><span class="anchor" id="line-24-4"></span>    <span class="ResWord">return</span> <span class="ID">height</span>, <span class="ID">x</span>, <span class="ID">y</span>, <span class="ID">width_x</span>, <span class="ID">width_y</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_25">  25</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_25"></span><span class="anchor" id="line-25-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_26">  26</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_26"></span><span class="anchor" id="line-26-3"></span><span class="ResWord">def</span> <span class="ID">fitgaussian</span>(<span class="ID">data</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_27">  27</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_27"></span><span class="anchor" id="line-27-3"></span>    <span class="String">&quot;&quot;&quot;Returns (height, x, y, width_x, width_y)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_28">  28</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_28"></span><span class="anchor" id="line-28-3"></span><span class="String">    the gaussian parameters of a 2D distribution found by a fit&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_29">  29</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_29"></span><span class="anchor" id="line-29-3"></span>    <span class="ID">params</span> = <span class="ID">moments</span>(<span class="ID">data</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_30">  30</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_30"></span><span class="anchor" id="line-30-3"></span>    <span class="ID">errorfunction</span> = <span class="ResWord">lambda</span> <span class="ID">p</span>: <span class="ID">ravel</span>(<span class="ID">gaussian</span>(*<span class="ID">p</span>)(*<span class="ID">indices</span>(<span class="ID">data</span>.<span class="ID">shape</span>)) -</span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_31">  31</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_31"></span><span class="anchor" id="line-31-3"></span>                                 <span class="ID">data</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_32">  32</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_32"></span><span class="anchor" id="line-32-3"></span>    <span class="ID">p</span>, <span class="ID">success</span> = <span class="ID">optimize</span>.<span class="ID">leastsq</span>(<span class="ID">errorfunction</span>, <span class="ID">params</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_33">  33</a> </span><span class="LineAnchor" id="CA-032aa6d9e54c6cb746408b8ff7e9f308e76df5ee_33"></span><span class="anchor" id="line-33-2"></span>    <span class="ResWord">return</span> <span class="ID">p</span></span>
</pre></div></div><span class="anchor" id="line-236"></span><span class="anchor" id="line-237"></span><p class="line874">And here is an example using it: <span class="anchor" id="line-238"></span><span class="anchor" id="line-239"></span><p class="line867"><span class="anchor" id="line-240"></span><span class="anchor" id="line-241"></span><span class="anchor" id="line-242"></span><span class="anchor" id="line-243"></span><span class="anchor" id="line-244"></span><span class="anchor" id="line-245"></span><span class="anchor" id="line-246"></span><span class="anchor" id="line-247"></span><span class="anchor" id="line-248"></span><span class="anchor" id="line-249"></span><span class="anchor" id="line-250"></span><span class="anchor" id="line-251"></span><span class="anchor" id="line-252"></span><span class="anchor" id="line-253"></span><span class="anchor" id="line-254"></span><span class="anchor" id="line-255"></span><span class="anchor" id="line-256"></span><span class="anchor" id="line-257"></span><span class="anchor" id="line-258"></span><span class="anchor" id="line-259"></span><span class="anchor" id="line-260"></span><span class="anchor" id="line-261"></span><span class="anchor" id="line-262"></span><span class="anchor" id="line-263"></span><span class="anchor" id="line-1-15"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_1">   1</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_1"></span><span class="anchor" id="line-1-16"></span><span class="ResWord">from</span> <span class="ID">pylab</span> <span class="ResWord">import</span> *</span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_2">   2</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_2"></span><span class="anchor" id="line-2-8"></span><span class="Comment"># Create the gaussian data</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_3">   3</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_3"></span><span class="anchor" id="line-3-8"></span><span class="ID">Xin</span>, <span class="ID">Yin</span> = <span class="ID">mgrid</span>[<span class="Number">0</span>:<span class="Number">201</span>, <span class="Number">0</span>:<span class="Number">201</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_4">   4</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_4"></span><span class="anchor" id="line-4-8"></span><span class="ID">data</span> = <span class="ID">gaussian</span>(<span class="Number">3</span>, <span class="Number">100</span>, <span class="Number">100</span>, <span class="Number">20</span>, <span class="Number">40</span>)(<span class="ID">Xin</span>, <span class="ID">Yin</span>) + <span class="ID">random</span>.<span class="ID">random</span>(<span class="ID">Xin</span>.<span class="ID">shape</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_5">   5</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_5"></span><span class="anchor" id="line-5-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_6">   6</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_6"></span><span class="anchor" id="line-6-8"></span><span class="ID">matshow</span>(<span class="ID">data</span>, <span class="ID">cmap</span>=<span class="ID">cm</span>.<span class="ID">gist_earth_r</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_7">   7</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_7"></span><span class="anchor" id="line-7-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_8">   8</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_8"></span><span class="anchor" id="line-8-8"></span><span class="ID">params</span> = <span class="ID">fitgaussian</span>(<span class="ID">data</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_9">   9</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_9"></span><span class="anchor" id="line-9-8"></span><span class="ID">fit</span> = <span class="ID">gaussian</span>(*<span class="ID">params</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_10">  10</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_10"></span><span class="anchor" id="line-10-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_11">  11</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_11"></span><span class="anchor" id="line-11-7"></span><span class="ID">contour</span>(<span class="ID">fit</span>(*<span class="ID">indices</span>(<span class="ID">data</span>.<span class="ID">shape</span>)), <span class="ID">cmap</span>=<span class="ID">cm</span>.<span class="ID">copper</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_12">  12</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_12"></span><span class="anchor" id="line-12-7"></span><span class="ID">ax</span> = <span class="ID">gca</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_13">  13</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_13"></span><span class="anchor" id="line-13-7"></span>(<span class="ID">height</span>, <span class="ID">x</span>, <span class="ID">y</span>, <span class="ID">width_x</span>, <span class="ID">width_y</span>) = <span class="ID">params</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_14">  14</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_14"></span><span class="anchor" id="line-14-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_15">  15</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_15"></span><span class="anchor" id="line-15-6"></span><span class="ID">text</span>(<span class="Number">0.95</span>, <span class="Number">0.05</span>, <span class="String">&quot;&quot;&quot;</span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_16">  16</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_16"></span><span class="anchor" id="line-16-6"></span><span class="String"></span><span class="String">x : </span><span class="String">%.1f</span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_17">  17</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_17"></span><span class="anchor" id="line-17-6"></span><span class="String"></span><span class="String">y : </span><span class="String">%.1f</span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_18">  18</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_18"></span><span class="anchor" id="line-18-6"></span><span class="String"></span><span class="String">width_x : </span><span class="String">%.1f</span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_19">  19</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_19"></span><span class="anchor" id="line-19-6"></span><span class="String"></span><span class="String">width_y : </span><span class="String">%.1f</span><span class="String">&quot;&quot;&quot;</span> %(<span class="ID">x</span>, <span class="ID">y</span>, <span class="ID">width_x</span>, <span class="ID">width_y</span>),</span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_20">  20</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_20"></span><span class="anchor" id="line-20-5"></span>        <span class="ID">fontsize</span>=<span class="Number">16</span>, <span class="ID">horizontalalignment</span>=<span class="String">'</span><span class="String">right</span><span class="String">'</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_21">  21</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_21"></span><span class="anchor" id="line-21-5"></span>        <span class="ID">verticalalignment</span>=<span class="String">'</span><span class="String">bottom</span><span class="String">'</span>, <span class="ID">transform</span>=<span class="ID">ax</span>.<span class="ID">transAxes</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_22">  22</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_22"></span><span class="anchor" id="line-22-5"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_23">  23</a> </span><span class="LineAnchor" id="CA-bb666b07124b48b5779910e6181d90c4ccb9aa7c_23"></span><span class="anchor" id="line-23-5"></span><span class="ID">show</span>()</span>
</pre></div></div><span class="anchor" id="line-264"></span><span class="anchor" id="line-265"></span><p class="line867"><img alt="fitgaussian.png" class="attachment" src="fitgaussianbc41.png?action=AttachFile&amp;do=get&amp;target=fitgaussian.png" title="fitgaussian.png" /> <span class="anchor" id="line-266"></span><span class="anchor" id="line-267"></span><p class="line867">
<h1 id="Fitting_a_power-law_to_data_with_errors">Fitting a power-law to data with errors</h1>
<span class="anchor" id="line-268"></span><span class="anchor" id="line-269"></span><p class="line867">
<h2 id="Generating_the_data-1">Generating the data</h2>
<span class="anchor" id="line-270"></span><span class="anchor" id="line-271"></span><p class="line874">Generate some data with noise to demonstrate the fitting procedure. Data is generated with an amplitude of 10 and a power-law index of -2.0. Notice that all of our data is well-behaved when the log is taken... you may have to be more careful of this for real data. <span class="anchor" id="line-272"></span><span class="anchor" id="line-273"></span><p class="line867"><span class="anchor" id="line-274"></span><span class="anchor" id="line-275"></span><span class="anchor" id="line-276"></span><span class="anchor" id="line-277"></span><span class="anchor" id="line-278"></span><span class="anchor" id="line-279"></span><span class="anchor" id="line-280"></span><span class="anchor" id="line-281"></span><span class="anchor" id="line-282"></span><span class="anchor" id="line-283"></span><span class="anchor" id="line-284"></span><span class="anchor" id="line-285"></span><span class="anchor" id="line-286"></span><span class="anchor" id="line-287"></span><span class="anchor" id="line-288"></span><span class="anchor" id="line-289"></span><span class="anchor" id="line-290"></span><span class="anchor" id="line-291"></span><span class="anchor" id="line-292"></span><span class="anchor" id="line-1-17"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_1">   1</a> </span><span class="LineAnchor" id="CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_1"></span><span class="anchor" id="line-1-18"></span><span class="ResWord">from</span> <span class="ID">pylab</span> <span class="ResWord">import</span> *</span>
<span class="line"><span class="LineNumber"><a href="#CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_2">   2</a> </span><span class="LineAnchor" id="CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_2"></span><span class="anchor" id="line-2-9"></span><span class="ResWord">from</span> <span class="ID">scipy</span> <span class="ResWord">import</span> *</span>
<span class="line"><span class="LineNumber"><a href="#CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_3">   3</a> </span><span class="LineAnchor" id="CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_3"></span><span class="anchor" id="line-3-9"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_4">   4</a> </span><span class="LineAnchor" id="CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_4"></span><span class="anchor" id="line-4-9"></span><span class="Comment"># Define function for calculating a power law</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_5">   5</a> </span><span class="LineAnchor" id="CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_5"></span><span class="anchor" id="line-5-9"></span><span class="ID">powerlaw</span> = <span class="ResWord">lambda</span> <span class="ID">x</span>, <span class="ID">amp</span>, <span class="ID">index</span>: <span class="ID">amp</span> * (<span class="ID">x</span>**<span class="ID">index</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_6">   6</a> </span><span class="LineAnchor" id="CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_6"></span><span class="anchor" id="line-6-9"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_7">   7</a> </span><span class="LineAnchor" id="CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_7"></span><span class="anchor" id="line-7-9"></span><span class="Comment">##########</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_8">   8</a> </span><span class="LineAnchor" id="CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_8"></span><span class="anchor" id="line-8-9"></span><span class="Comment"># Generate data points with noise</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_9">   9</a> </span><span class="LineAnchor" id="CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_9"></span><span class="anchor" id="line-9-9"></span><span class="Comment">##########</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_10">  10</a> </span><span class="LineAnchor" id="CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_10"></span><span class="anchor" id="line-10-9"></span><span class="ID">num_points</span> = <span class="Number">20</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_11">  11</a> </span><span class="LineAnchor" id="CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_11"></span><span class="anchor" id="line-11-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_12">  12</a> </span><span class="LineAnchor" id="CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_12"></span><span class="anchor" id="line-12-8"></span><span class="Comment"># Note: all positive, non-zero data</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_13">  13</a> </span><span class="LineAnchor" id="CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_13"></span><span class="anchor" id="line-13-8"></span><span class="ID">xdata</span> = <span class="ID">linspace</span>(<span class="Number">1.1</span>, <span class="Number">10.1</span>, <span class="ID">num_points</span>) </span>
<span class="line"><span class="LineNumber"><a href="#CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_14">  14</a> </span><span class="LineAnchor" id="CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_14"></span><span class="anchor" id="line-14-7"></span><span class="ID">ydata</span> = <span class="ID">powerlaw</span>(<span class="ID">xdata</span>, <span class="Number">10.0</span>, -<span class="Number">2.0</span>)     <span class="Comment"># simulated perfect data</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_15">  15</a> </span><span class="LineAnchor" id="CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_15"></span><span class="anchor" id="line-15-7"></span><span class="ID">yerr</span> = <span class="Number">0.2</span> * <span class="ID">ydata</span>                      <span class="Comment"># simulated errors (10%)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_16">  16</a> </span><span class="LineAnchor" id="CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_16"></span><span class="anchor" id="line-16-7"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_17">  17</a> </span><span class="LineAnchor" id="CA-5325ec73aaa4ca7eb0ae6df6ecdf729fa463b994_17"></span><span class="anchor" id="line-17-7"></span><span class="ID">ydata</span> += <span class="ID">randn</span>(<span class="ID">num_points</span>) * <span class="ID">yerr</span>       <span class="Comment"># simulated noisy data</span></span>
</pre></div></div><span class="anchor" id="line-293"></span><span class="anchor" id="line-294"></span><p class="line867">
<h2 id="Fitting_the_data-1">Fitting the data</h2>
<span class="anchor" id="line-295"></span><span class="anchor" id="line-296"></span><p class="line862">If your data is well-behaved, you can fit a power-law function by first converting to a linear equation by using the logarithm. Then use the optimize function to fit a straight line. Notice that we are weighting by positional uncertainties during the fit. Also, the best-fit parameters uncertainties are estimated from the variance-covariance matrix. You should read up on when it may not be appropriate to use this form of error estimation.  If you are trying to fit a power-law distribution, <a class="http" href="../../external.html?link=http://code.google.com/p/agpy/wiki/PowerLaw?ts=1251337886&amp;updated=PowerLaw">this solution</a> is more appropriate. <span class="anchor" id="line-297"></span><span class="anchor" id="line-298"></span><p class="line867"><span class="anchor" id="line-299"></span><span class="anchor" id="line-300"></span><span class="anchor" id="line-301"></span><span class="anchor" id="line-302"></span><span class="anchor" id="line-303"></span><span class="anchor" id="line-304"></span><span class="anchor" id="line-305"></span><span class="anchor" id="line-306"></span><span class="anchor" id="line-307"></span><span class="anchor" id="line-308"></span><span class="anchor" id="line-309"></span><span class="anchor" id="line-310"></span><span class="anchor" id="line-311"></span><span class="anchor" id="line-312"></span><span class="anchor" id="line-313"></span><span class="anchor" id="line-314"></span><span class="anchor" id="line-315"></span><span class="anchor" id="line-316"></span><span class="anchor" id="line-317"></span><span class="anchor" id="line-318"></span><span class="anchor" id="line-319"></span><span class="anchor" id="line-320"></span><span class="anchor" id="line-321"></span><span class="anchor" id="line-322"></span><span class="anchor" id="line-323"></span><span class="anchor" id="line-324"></span><span class="anchor" id="line-325"></span><span class="anchor" id="line-326"></span><span class="anchor" id="line-327"></span><span class="anchor" id="line-328"></span><span class="anchor" id="line-329"></span><span class="anchor" id="line-330"></span><span class="anchor" id="line-331"></span><span class="anchor" id="line-332"></span><span class="anchor" id="line-333"></span><span class="anchor" id="line-334"></span><span class="anchor" id="line-335"></span><span class="anchor" id="line-336"></span><span class="anchor" id="line-337"></span><span class="anchor" id="line-338"></span><span class="anchor" id="line-339"></span><span class="anchor" id="line-340"></span><span class="anchor" id="line-341"></span><span class="anchor" id="line-342"></span><span class="anchor" id="line-343"></span><span class="anchor" id="line-344"></span><span class="anchor" id="line-345"></span><span class="anchor" id="line-346"></span><span class="anchor" id="line-347"></span><span class="anchor" id="line-348"></span><span class="anchor" id="line-349"></span><span class="anchor" id="line-350"></span><span class="anchor" id="line-351"></span><span class="anchor" id="line-352"></span><span class="anchor" id="line-353"></span><span class="anchor" id="line-354"></span><span class="anchor" id="line-355"></span><span class="anchor" id="line-356"></span><span class="anchor" id="line-357"></span><span class="anchor" id="line-358"></span><span class="anchor" id="line-1-19"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-4bf4c85ab6196a608cd3e9933353a468896210b5\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_1">   1</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_1"></span><span class="anchor" id="line-1-20"></span><span class="Comment">##########</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_2">   2</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_2"></span><span class="anchor" id="line-2-10"></span><span class="Comment"># Fitting the data -- Least Squares Method</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_3">   3</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_3"></span><span class="anchor" id="line-3-10"></span><span class="Comment">##########</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_4">   4</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_4"></span><span class="anchor" id="line-4-10"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_5">   5</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_5"></span><span class="anchor" id="line-5-10"></span><span class="Comment"># Power-law fitting is best done by first converting</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_6">   6</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_6"></span><span class="anchor" id="line-6-10"></span><span class="Comment"># to a linear equation and then fitting to a straight line.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_7">   7</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_7"></span><span class="anchor" id="line-7-10"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_8">   8</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_8"></span><span class="anchor" id="line-8-10"></span><span class="Comment">#  y = a * x^b</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_9">   9</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_9"></span><span class="anchor" id="line-9-10"></span><span class="Comment">#  log(y) = log(a) + b*log(x)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_10">  10</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_10"></span><span class="anchor" id="line-10-10"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_11">  11</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_11"></span><span class="anchor" id="line-11-9"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_12">  12</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_12"></span><span class="anchor" id="line-12-9"></span><span class="ID">logx</span> = <span class="ID">log10</span>(<span class="ID">xdata</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_13">  13</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_13"></span><span class="anchor" id="line-13-9"></span><span class="ID">logy</span> = <span class="ID">log10</span>(<span class="ID">ydata</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_14">  14</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_14"></span><span class="anchor" id="line-14-8"></span><span class="ID">logyerr</span> = <span class="ID">yerr</span> / <span class="ID">ydata</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_15">  15</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_15"></span><span class="anchor" id="line-15-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_16">  16</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_16"></span><span class="anchor" id="line-16-8"></span><span class="Comment"># define our (line) fitting function</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_17">  17</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_17"></span><span class="anchor" id="line-17-8"></span><span class="ID">fitfunc</span> = <span class="ResWord">lambda</span> <span class="ID">p</span>, <span class="ID">x</span>: <span class="ID">p</span>[<span class="Number">0</span>] + <span class="ID">p</span>[<span class="Number">1</span>] * <span class="ID">x</span>   </span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_18">  18</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_18"></span><span class="anchor" id="line-18-7"></span><span class="ID">errfunc</span> = <span class="ResWord">lambda</span> <span class="ID">p</span>, <span class="ID">x</span>, <span class="ID">y</span>, <span class="ID">err</span>: (<span class="ID">y</span> - <span class="ID">fitfunc</span>(<span class="ID">p</span>, <span class="ID">x</span>)) / <span class="ID">err</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_19">  19</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_19"></span><span class="anchor" id="line-19-7"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_20">  20</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_20"></span><span class="anchor" id="line-20-6"></span><span class="ID">pinit</span> = [<span class="Number">1.0</span>, -<span class="Number">1.0</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_21">  21</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_21"></span><span class="anchor" id="line-21-6"></span><span class="ID">out</span> = <span class="ID">optimize</span>.<span class="ID">leastsq</span>(<span class="ID">errfunc</span>, <span class="ID">pinit</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_22">  22</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_22"></span><span class="anchor" id="line-22-6"></span>                       <span class="ID">args</span>=(<span class="ID">logx</span>, <span class="ID">logy</span>, <span class="ID">logyerr</span>), <span class="ID">full_output</span>=<span class="Number">1</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_23">  23</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_23"></span><span class="anchor" id="line-23-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_24">  24</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_24"></span><span class="anchor" id="line-24-5"></span><span class="ID">pfinal</span> = <span class="ID">out</span>[<span class="Number">0</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_25">  25</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_25"></span><span class="anchor" id="line-25-4"></span><span class="ID">covar</span> = <span class="ID">out</span>[<span class="Number">1</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_26">  26</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_26"></span><span class="anchor" id="line-26-4"></span><span class="ResWord">print</span> <span class="ID">pfinal</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_27">  27</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_27"></span><span class="anchor" id="line-27-4"></span><span class="ResWord">print</span> <span class="ID">covar</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_28">  28</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_28"></span><span class="anchor" id="line-28-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_29">  29</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_29"></span><span class="anchor" id="line-29-4"></span><span class="ID">index</span> = <span class="ID">pfinal</span>[<span class="Number">1</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_30">  30</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_30"></span><span class="anchor" id="line-30-4"></span><span class="ID">amp</span> = <span class="Number">10.0</span>**<span class="ID">pfinal</span>[<span class="Number">0</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_31">  31</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_31"></span><span class="anchor" id="line-31-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_32">  32</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_32"></span><span class="anchor" id="line-32-4"></span><span class="ID">indexErr</span> = <span class="ID">sqrt</span>( <span class="ID">covar</span>[<span class="Number">0</span>][<span class="Number">0</span>] ) </span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_33">  33</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_33"></span><span class="anchor" id="line-33-3"></span><span class="ID">ampErr</span> = <span class="ID">sqrt</span>( <span class="ID">covar</span>[<span class="Number">1</span>][<span class="Number">1</span>] ) * <span class="ID">amp</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_34">  34</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_34"></span><span class="anchor" id="line-34-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_35">  35</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_35"></span><span class="anchor" id="line-35-2"></span><span class="Comment">##########</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_36">  36</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_36"></span><span class="anchor" id="line-36-2"></span><span class="Comment"># Plotting data</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_37">  37</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_37"></span><span class="anchor" id="line-37-2"></span><span class="Comment">##########</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_38">  38</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_38"></span><span class="anchor" id="line-38-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_39">  39</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_39"></span><span class="anchor" id="line-39-2"></span><span class="ID">clf</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_40">  40</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_40"></span><span class="anchor" id="line-40-2"></span><span class="ID">subplot</span>(<span class="Number">2</span>, <span class="Number">1</span>, <span class="Number">1</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_41">  41</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_41"></span><span class="anchor" id="line-41-1"></span><span class="ID">plot</span>(<span class="ID">xdata</span>, <span class="ID">powerlaw</span>(<span class="ID">xdata</span>, <span class="ID">amp</span>, <span class="ID">index</span>))     <span class="Comment"># Fit</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_42">  42</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_42"></span><span class="anchor" id="line-42-1"></span><span class="ID">errorbar</span>(<span class="ID">xdata</span>, <span class="ID">ydata</span>, <span class="ID">yerr</span>=<span class="ID">yerr</span>, <span class="ID">fmt</span>=<span class="String">'</span><span class="String">k.</span><span class="String">'</span>)  <span class="Comment"># Data</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_43">  43</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_43"></span><span class="anchor" id="line-43-1"></span><span class="ID">text</span>(<span class="Number">5</span>, <span class="Number">6.5</span>, <span class="String">'</span><span class="String">Ampli = </span><span class="String">%5.2f</span><span class="String"> +/- </span><span class="String">%5.2f</span><span class="String">'</span> % (<span class="ID">amp</span>, <span class="ID">ampErr</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_44">  44</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_44"></span><span class="anchor" id="line-44-1"></span><span class="ID">text</span>(<span class="Number">5</span>, <span class="Number">5.5</span>, <span class="String">'</span><span class="String">Index = </span><span class="String">%5.2f</span><span class="String"> +/- </span><span class="String">%5.2f</span><span class="String">'</span> % (<span class="ID">index</span>, <span class="ID">indexErr</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_45">  45</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_45"></span><span class="anchor" id="line-45-1"></span><span class="ID">title</span>(<span class="String">'</span><span class="String">Best Fit Power Law</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_46">  46</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_46"></span><span class="anchor" id="line-46-1"></span><span class="ID">xlabel</span>(<span class="String">'</span><span class="String">X</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_47">  47</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_47"></span><span class="anchor" id="line-47-1"></span><span class="ID">ylabel</span>(<span class="String">'</span><span class="String">Y</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_48">  48</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_48"></span><span class="anchor" id="line-48-1"></span><span class="ID">xlim</span>(<span class="Number">1</span>, <span class="Number">11</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_49">  49</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_49"></span><span class="anchor" id="line-49-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_50">  50</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_50"></span><span class="anchor" id="line-50-1"></span><span class="ID">subplot</span>(<span class="Number">2</span>, <span class="Number">1</span>, <span class="Number">2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_51">  51</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_51"></span><span class="anchor" id="line-51-1"></span><span class="ID">loglog</span>(<span class="ID">xdata</span>, <span class="ID">powerlaw</span>(<span class="ID">xdata</span>, <span class="ID">amp</span>, <span class="ID">index</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_52">  52</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_52"></span><span class="anchor" id="line-52-1"></span><span class="ID">errorbar</span>(<span class="ID">xdata</span>, <span class="ID">ydata</span>, <span class="ID">yerr</span>=<span class="ID">yerr</span>, <span class="ID">fmt</span>=<span class="String">'</span><span class="String">k.</span><span class="String">'</span>)  <span class="Comment"># Data</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_53">  53</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_53"></span><span class="anchor" id="line-53-1"></span><span class="ID">xlabel</span>(<span class="String">'</span><span class="String">X (log scale)</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_54">  54</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_54"></span><span class="anchor" id="line-54-1"></span><span class="ID">ylabel</span>(<span class="String">'</span><span class="String">Y (log scale)</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_55">  55</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_55"></span><span class="anchor" id="line-55-1"></span><span class="ID">xlim</span>(<span class="Number">1.0</span>, <span class="Number">11</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_56">  56</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_56"></span><span class="anchor" id="line-56-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4bf4c85ab6196a608cd3e9933353a468896210b5_57">  57</a> </span><span class="LineAnchor" id="CA-4bf4c85ab6196a608cd3e9933353a468896210b5_57"></span><span class="anchor" id="line-57-1"></span><span class="ID">savefig</span>(<span class="String">'</span><span class="String">power_law_fit.png</span><span class="String">'</span>)</span>
</pre></div></div><span class="anchor" id="line-359"></span><span class="anchor" id="line-360"></span><p class="line867"><img alt="power_law_fit.png" class="attachment" src="power_law_fit9e6b.png?action=AttachFile&amp;do=get&amp;target=power_law_fit.png" title="power_law_fit.png" /> <span class="anchor" id="line-361"></span><span class="anchor" id="bottom"></span></div>
<div id="pagebottom"></div>
</div>


<div id="footer">
<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="FittingData37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../../external.html?link=http://localhost:8080/Cookbook/FittingData">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

<ul id="credits">
<li><a href="../../external.html?link=http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="../../external.html?link=http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="../../external.html?link=http://moinmo.in/GPL" title="MoinMoin is GPL licensed.">GPL licensed</a></li><li><a href="../../external.html?link=http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li>
</ul>


</div>
</body>

<!-- Mirrored from localhost:8080/Cookbook/FittingData?action=recoverpass by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 23:19:03 GMT -->
</html>

