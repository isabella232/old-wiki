<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<!-- Mirrored from localhost:8080/Cookbook/RANSAC?highlight=%28%28CategoryCookbook%29%29 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 23:34:07 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="edit_on_doubleclick" content="/">
<meta name="robots" content="noindex,nofollow">

<title>Cookbook/RANSAC - SciPy wiki dump</title>
<script type="text/javascript" src="../moin_static197/common/js/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../moin_static197/modern/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="../moin_static197/modern/css/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="../moin_static197/modern/css/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="../moin_static197/modern/css/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static197/modern/css/msie.css">
<![endif]-->


<link rel="alternate" title="SciPy: Cookbook/RANSAC" href="../../external.html?link=http://localhost:8080/Cookbook/RANSAC?diffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=Cookbook%2FRANSAC&amp;ddiffs=1" type="application/rss+xml">


<link rel="Start" href="../AllPages.html">
<link rel="Alternate" title="Wiki Markup" href="../../external.html?link=http://localhost:8080/Cookbook/RANSAC?action=raw">
<link rel="Alternate" media="print" title="Print View" href="../../external.html?link=http://localhost:8080/Cookbook/RANSAC?action=print">
<link rel="Up" href="../Cookbook.html">
<link rel="Appendix" title="ransac.png" href="RANSACdc7e.html?action=AttachFile&amp;do=view&amp;target=ransac.png">
<link rel="Appendix" title="ransac.py" href="RANSAC803e.html?action=AttachFile&amp;do=view&amp;target=ransac.py">
<link rel="Search" href="../FindPage.html">
<link rel="Index" href="../TitleIndex.html">
<link rel="Glossary" href="../WordIndex.html">
<link rel="Help" href="../HelpOnFormatting.html">
</head>

<body  lang="en" dir="ltr"><div style="background: white; padding:2em;">This is an archival dump of old wiki content --- see <a href="http://scipy.org/">scipy.org</a> for current material.<br>Please see <a href="http://scipy-cookbook.readthedocs.org/">http://scipy-cookbook.readthedocs.org/</a></div>

<div id="header">


<form id="searchform" method="get" action="../../external.html?link=http://localhost:8080/Cookbook/RANSAC">
<div>
<input type="hidden" name="action" value="fullsearch">
<input type="hidden" name="context" value="180">
<label for="searchinput">Search:</label>
<input id="searchinput" type="text" name="value" value="" size="20"
    onfocus="searchFocus(this)" onblur="searchBlur(this)"
    onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search">
<input id="titlesearch" name="titlesearch" type="submit"
    value="Titles" alt="Search Titles">
<input id="fullsearch" name="fullsearch" type="submit"
    value="Text" alt="Search Full Text">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<ul id="username"><li><a href="RANSAC456e.html?action=login" id="login" rel="nofollow">Login</a></li></ul>
<div id="locationline">
<div id="interwiki"><span><a href="../AllPages.html" rel="nofollow">SciPy</a></span></div>

<ul id="pagelocation">
<li><a href="../Cookbook.html">Cookbook</a></li><li><a class="backlink" href="RANSACd9e6.html?action=fullsearch&amp;context=180&amp;value=linkto%3A%22Cookbook%2FRANSAC%22" rel="nofollow" title="Click to do a full-text search for this title">RANSAC</a></li>
</ul>

</div>


<ul id="navibar">
<li class="wikilink"><a href="../RecentChanges.html">RecentChanges</a></li><li class="wikilink"><a class="nonexistent" href="../FindPage.html">FindPage</a></li><li class="wikilink"><a class="nonexistent" href="../HelpContents.html">HelpContents</a></li><li class="current"><a href="RANSAC.html">Cookbook/RANSAC</a></li>
</ul>

<div id="pageline"><hr style="display:none;"></div>

<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="RANSAC37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../../external.html?link=http://localhost:8080/Cookbook/RANSAC">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

</div>

<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><p class="line862">The attached file ( <a class="attachment" href="RANSAC803e.html?action=AttachFile&amp;do=view&amp;target=ransac.py" title="">ransac.py</a> ) implements the <a class="http" href="../../external.html?link=http://en.wikipedia.org/wiki/RANSAC">RANSAC algorithm</a>. An example image: <span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><p class="line867"><img alt="ransac.png" class="attachment" src="ransace8ff.png?action=AttachFile&amp;do=get&amp;target=ransac.png" title="ransac.png" /> <span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span><p class="line874">To run the file, save it to your computer, start IPython <span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><span class="anchor" id="line-8"></span><pre><span class="anchor" id="line-1-1"></span>ipython -wthread</pre><span class="anchor" id="line-9"></span><span class="anchor" id="line-10"></span><p class="line874">Import the module and run the test program <span class="anchor" id="line-11"></span><span class="anchor" id="line-12"></span><p class="line867"><span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><span class="anchor" id="line-15"></span><span class="anchor" id="line-1-2"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
function isnumbered(obj) {
  return obj.childNodes.length && obj.firstChild.childNodes.length && obj.firstChild.firstChild.className == 'LineNumber';
}
function nformat(num,chrs,add) {
  var nlen = Math.max(0,chrs-(''+num).length), res = '';
  while (nlen>0) { res += ' '; nlen-- }
  return res+num+add;
}
function addnumber(did, nstart, nstep) {
  var c = document.getElementById(did), l = c.firstChild, n = 1;
  if (!isnumbered(c)) {
    if (typeof nstart == 'undefined') nstart = 1;
    if (typeof nstep  == 'undefined') nstep = 1;
    var n = nstart;
    while (l != null) {
      if (l.tagName == 'SPAN') {
        var s = document.createElement('SPAN');
        var a = document.createElement('A');
        s.className = 'LineNumber';
        a.appendChild(document.createTextNode(nformat(n,4,'')));
        a.href = '#' + did + '_' + n;
        s.appendChild(a);
        s.appendChild(document.createTextNode(' '));
        n += nstep;
        if (l.childNodes.length) {
          l.insertBefore(s, l.firstChild);
        }
        else {
          l.appendChild(s);
        }
      }
      l = l.nextSibling;
    }
  }
  return false;
}
function remnumber(did) {
  var c = document.getElementById(did), l = c.firstChild;
  if (isnumbered(c)) {
    while (l != null) {
      if (l.tagName == 'SPAN' && l.firstChild.className == 'LineNumber') l.removeChild(l.firstChild);
      l = l.nextSibling;
    }
  }
  return false;
}
function togglenumber(did, nstart, nstep) {
  var c = document.getElementById(did);
  if (isnumbered(c)) {
    remnumber(did);
  } else {
    addnumber(did,nstart,nstep);
  }
  return false;
}
</script>

<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-4509b3efc4aeba8b558fb3da9adb1007b5dba20a\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-4509b3efc4aeba8b558fb3da9adb1007b5dba20a" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-4509b3efc4aeba8b558fb3da9adb1007b5dba20a_1">   1</a> </span><span class="LineAnchor" id="CA-4509b3efc4aeba8b558fb3da9adb1007b5dba20a_1"></span><span class="anchor" id="line-1-3"></span><span class="ResWord">import</span> <span class="ID">ransac</span> </span>
<span class="line"><span class="LineNumber"><a href="#CA-4509b3efc4aeba8b558fb3da9adb1007b5dba20a_2">   2</a> </span><span class="LineAnchor" id="CA-4509b3efc4aeba8b558fb3da9adb1007b5dba20a_2"></span><span class="anchor" id="line-2-1"></span><span class="ID">ransac</span>.<span class="ID">test</span>()</span>
</pre></div></div><span class="anchor" id="line-16"></span><span class="anchor" id="line-17"></span><p class="line874">To use the module you need to create a model class with two methods <span class="anchor" id="line-18"></span><span class="anchor" id="line-19"></span><p class="line867"><span class="anchor" id="line-20"></span><span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span><span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span><span class="anchor" id="line-1-4"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-5bb3fa132fb55f348ef70a627f7390213431c1fc\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-5bb3fa132fb55f348ef70a627f7390213431c1fc" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-5bb3fa132fb55f348ef70a627f7390213431c1fc_1">   1</a> </span><span class="LineAnchor" id="CA-5bb3fa132fb55f348ef70a627f7390213431c1fc_1"></span><span class="anchor" id="line-1-5"></span><span class="ResWord">def</span> <span class="ID">fit</span>(<span class="ResWord">self</span>, <span class="ID">data</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-5bb3fa132fb55f348ef70a627f7390213431c1fc_2">   2</a> </span><span class="LineAnchor" id="CA-5bb3fa132fb55f348ef70a627f7390213431c1fc_2"></span><span class="anchor" id="line-2-2"></span>  <span class="String">&quot;&quot;&quot;Given the data fit the data with your model and return the model (a vector)&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5bb3fa132fb55f348ef70a627f7390213431c1fc_3">   3</a> </span><span class="LineAnchor" id="CA-5bb3fa132fb55f348ef70a627f7390213431c1fc_3"></span><span class="anchor" id="line-3-1"></span><span class="ResWord">def</span> <span class="ID">get_error</span>(<span class="ResWord">self</span>, <span class="ID">data</span>, <span class="ID">model</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-5bb3fa132fb55f348ef70a627f7390213431c1fc_4">   4</a> </span><span class="LineAnchor" id="CA-5bb3fa132fb55f348ef70a627f7390213431c1fc_4"></span><span class="anchor" id="line-4-1"></span>  <span class="String">&quot;&quot;&quot;Given a set of data and a model, what is the error of using this model to estimate the data &quot;&quot;&quot;</span></span>
</pre></div></div><span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span><p class="line862">An example of such model is the class <a class="nonexistent" href="../LinearLeastSquaresModel.html">LinearLeastSquaresModel</a> as seen the file source (below) <span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span><span class="anchor" id="line-1-6"></span><div class="highlight text"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_1">   1</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_1"></span><span class="anchor" id="line-1-7"></span><span class="ResWord">import</span> <span class="ID">numpy</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_2">   2</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_2"></span><span class="anchor" id="line-2-3"></span><span class="ResWord">import</span> <span class="ID">scipy</span> <span class="Comment"># use numpy if scipy unavailable</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_3">   3</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_3"></span><span class="anchor" id="line-3-2"></span><span class="ResWord">import</span> <span class="ID">scipy.linalg</span> <span class="Comment"># use numpy if scipy unavailable</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_4">   4</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_4"></span><span class="anchor" id="line-4-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_5">   5</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_5"></span><span class="anchor" id="line-5-1"></span><span class="Comment">## Copyright (c) 2004-2007, Andrew D. Straw. All rights reserved.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_6">   6</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_6"></span><span class="anchor" id="line-6-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_7">   7</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_7"></span><span class="anchor" id="line-7-1"></span><span class="Comment">## Redistribution and use in source and binary forms, with or without</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_8">   8</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_8"></span><span class="anchor" id="line-8-1"></span><span class="Comment">## modification, are permitted provided that the following conditions are</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_9">   9</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_9"></span><span class="anchor" id="line-9-1"></span><span class="Comment">## met:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_10">  10</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_10"></span><span class="anchor" id="line-10-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_11">  11</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_11"></span><span class="anchor" id="line-11-1"></span><span class="Comment">##     * Redistributions of source code must retain the above copyright</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_12">  12</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_12"></span><span class="anchor" id="line-12-1"></span><span class="Comment">##       notice, this list of conditions and the following disclaimer.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_13">  13</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_13"></span><span class="anchor" id="line-13-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_14">  14</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_14"></span><span class="anchor" id="line-14-1"></span><span class="Comment">##     * Redistributions in binary form must reproduce the above</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_15">  15</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_15"></span><span class="anchor" id="line-15-1"></span><span class="Comment">##       copyright notice, this list of conditions and the following</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_16">  16</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_16"></span><span class="anchor" id="line-16-1"></span><span class="Comment">##       disclaimer in the documentation and/or other materials provided</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_17">  17</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_17"></span><span class="anchor" id="line-17-1"></span><span class="Comment">##       with the distribution.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_18">  18</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_18"></span><span class="anchor" id="line-18-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_19">  19</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_19"></span><span class="anchor" id="line-19-1"></span><span class="Comment">##     * Neither the name of the Andrew D. Straw nor the names of its</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_20">  20</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_20"></span><span class="anchor" id="line-20-1"></span><span class="Comment">##       contributors may be used to endorse or promote products derived</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_21">  21</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_21"></span><span class="anchor" id="line-21-1"></span><span class="Comment">##       from this software without specific prior written permission.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_22">  22</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_22"></span><span class="anchor" id="line-22-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_23">  23</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_23"></span><span class="anchor" id="line-23-1"></span><span class="Comment">## THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_24">  24</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_24"></span><span class="anchor" id="line-24-1"></span><span class="Comment">## &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_25">  25</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_25"></span><span class="anchor" id="line-25-1"></span><span class="Comment">## LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_26">  26</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_26"></span><span class="anchor" id="line-26-1"></span><span class="Comment">## A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_27">  27</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_27"></span><span class="anchor" id="line-27-1"></span><span class="Comment">## OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_28">  28</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_28"></span><span class="anchor" id="line-28-1"></span><span class="Comment">## SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_29">  29</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_29"></span><span class="anchor" id="line-29"></span><span class="Comment">## LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_30">  30</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_30"></span><span class="anchor" id="line-30"></span><span class="Comment">## DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_31">  31</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_31"></span><span class="anchor" id="line-31"></span><span class="Comment">## THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_32">  32</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_32"></span><span class="anchor" id="line-32"></span><span class="Comment">## (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_33">  33</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_33"></span><span class="anchor" id="line-33"></span><span class="Comment">## OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_34">  34</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_34"></span><span class="anchor" id="line-34"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_35">  35</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_35"></span><span class="anchor" id="line-35"></span><span class="ResWord">def</span> <span class="ID">ransac</span>(<span class="ID">data</span>,<span class="ID">model</span>,<span class="ID">n</span>,<span class="ID">k</span>,<span class="ID">t</span>,<span class="ID">d</span>,<span class="ID">debug</span>=<span class="ResWord">False</span>,<span class="ID">return_all</span>=<span class="ResWord">False</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_36">  36</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_36"></span><span class="anchor" id="line-36"></span>    <span class="String">&quot;&quot;&quot;fit model parameters to data using the RANSAC algorithm</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_37">  37</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_37"></span><span class="anchor" id="line-37"></span><span class="String">    </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_38">  38</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_38"></span><span class="anchor" id="line-38"></span><span class="String">This implementation written from pseudocode found at</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_39">  39</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_39"></span><span class="anchor" id="line-39"></span><span class="String">http://en.wikipedia.org/w/index.php?title=RANSAC&amp;oldid=116358182</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_40">  40</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_40"></span><span class="anchor" id="line-40"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_41">  41</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_41"></span><span class="anchor" id="line-41"></span><span class="String">{{{</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_42">  42</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_42"></span><span class="anchor" id="line-42"></span><span class="String">Given:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_43">  43</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_43"></span><span class="anchor" id="line-43"></span><span class="String">    data - a set of observed data points</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_44">  44</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_44"></span><span class="anchor" id="line-44"></span><span class="String">    model - a model that can be fitted to data points</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_45">  45</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_45"></span><span class="anchor" id="line-45"></span><span class="String">    n - the minimum number of data values required to fit the model</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_46">  46</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_46"></span><span class="anchor" id="line-46"></span><span class="String">    k - the maximum number of iterations allowed in the algorithm</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_47">  47</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_47"></span><span class="anchor" id="line-47"></span><span class="String">    t - a threshold value for determining when a data point fits a model</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_48">  48</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_48"></span><span class="anchor" id="line-48"></span><span class="String">    d - the number of close data values required to assert that a model fits well to data</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_49">  49</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_49"></span><span class="anchor" id="line-49"></span><span class="String">Return:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_50">  50</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_50"></span><span class="anchor" id="line-50"></span><span class="String">    bestfit - model parameters which best fit the data (or nil if no good model is found)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_51">  51</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_51"></span><span class="anchor" id="line-51"></span><span class="String">iterations = 0</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_52">  52</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_52"></span><span class="anchor" id="line-52"></span><span class="String">bestfit = nil</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_53">  53</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_53"></span><span class="anchor" id="line-53"></span><span class="String">besterr = something really large</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_54">  54</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_54"></span><span class="anchor" id="line-54"></span><span class="String">while iterations &lt; k {</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_55">  55</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_55"></span><span class="anchor" id="line-55"></span><span class="String">    maybeinliers = n randomly selected values from data</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_56">  56</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_56"></span><span class="anchor" id="line-56"></span><span class="String">    maybemodel = model parameters fitted to maybeinliers</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_57">  57</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_57"></span><span class="anchor" id="line-57"></span><span class="String">    alsoinliers = empty set</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_58">  58</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_58"></span><span class="anchor" id="line-58"></span><span class="String">    for every point in data not in maybeinliers {</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_59">  59</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_59"></span><span class="anchor" id="line-59"></span><span class="String">        if point fits maybemodel with an error smaller than t</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_60">  60</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_60"></span><span class="anchor" id="line-60"></span><span class="String">             add point to alsoinliers</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_61">  61</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_61"></span><span class="anchor" id="line-61"></span><span class="String">    }</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_62">  62</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_62"></span><span class="anchor" id="line-62"></span><span class="String">    if the number of elements in alsoinliers is &gt; d {</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_63">  63</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_63"></span><span class="anchor" id="line-63"></span><span class="String">        % this implies that we may have found a good model</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_64">  64</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_64"></span><span class="anchor" id="line-64"></span><span class="String">        % now test how good it is</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_65">  65</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_65"></span><span class="anchor" id="line-65"></span><span class="String">        bettermodel = model parameters fitted to all points in maybeinliers and alsoinliers</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_66">  66</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_66"></span><span class="anchor" id="line-66"></span><span class="String">        thiserr = a measure of how well model fits these points</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_67">  67</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_67"></span><span class="anchor" id="line-67"></span><span class="String">        if thiserr &lt; besterr {</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_68">  68</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_68"></span><span class="anchor" id="line-68"></span><span class="String">            bestfit = bettermodel</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_69">  69</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_69"></span><span class="anchor" id="line-69"></span><span class="String">            besterr = thiserr</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_70">  70</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_70"></span><span class="anchor" id="line-70"></span><span class="String">        }</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_71">  71</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_71"></span><span class="anchor" id="line-71"></span><span class="String">    }</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_72">  72</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_72"></span><span class="anchor" id="line-72"></span><span class="String">    increment iterations</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_73">  73</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_73"></span><span class="anchor" id="line-73"></span><span class="String">}</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_74">  74</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_74"></span><span class="anchor" id="line-74"></span><span class="String">return bestfit</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_75">  75</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_75"></span><span class="anchor" id="line-75"></span><span class="String">}}}</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_76">  76</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_76"></span><span class="anchor" id="line-76"></span><span class="String">&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_77">  77</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_77"></span><span class="anchor" id="line-77"></span>    <span class="ID">iterations</span> = <span class="Number">0</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_78">  78</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_78"></span><span class="anchor" id="line-78"></span>    <span class="ID">bestfit</span> = <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_79">  79</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_79"></span><span class="anchor" id="line-79"></span>    <span class="ID">besterr</span> = <span class="ID">numpy</span>.<span class="ID">inf</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_80">  80</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_80"></span><span class="anchor" id="line-80"></span>    <span class="ID">best_inlier_idxs</span> = <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_81">  81</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_81"></span><span class="anchor" id="line-81"></span>    <span class="ResWord">while</span> <span class="ID">iterations</span> &lt; <span class="ID">k</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_82">  82</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_82"></span><span class="anchor" id="line-82"></span>        <span class="ID">maybe_idxs</span>, <span class="ID">test_idxs</span> = <span class="ID">random_partition</span>(<span class="ID">n</span>,<span class="ID">data</span>.<span class="ID">shape</span>[<span class="Number">0</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_83">  83</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_83"></span><span class="anchor" id="line-83"></span>        <span class="ID">maybeinliers</span> = <span class="ID">data</span>[<span class="ID">maybe_idxs</span>,:]</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_84">  84</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_84"></span><span class="anchor" id="line-84"></span>        <span class="ID">test_points</span> = <span class="ID">data</span>[<span class="ID">test_idxs</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_85">  85</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_85"></span><span class="anchor" id="line-85"></span>        <span class="ID">maybemodel</span> = <span class="ID">model</span>.<span class="ID">fit</span>(<span class="ID">maybeinliers</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_86">  86</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_86"></span><span class="anchor" id="line-86"></span>        <span class="ID">test_err</span> = <span class="ID">model</span>.<span class="ID">get_error</span>( <span class="ID">test_points</span>, <span class="ID">maybemodel</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_87">  87</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_87"></span><span class="anchor" id="line-87"></span>        <span class="ID">also_idxs</span> = <span class="ID">test_idxs</span>[<span class="ID">test_err</span> &lt; <span class="ID">t</span>] <span class="Comment"># select indices of rows with accepted points</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_88">  88</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_88"></span><span class="anchor" id="line-88"></span>        <span class="ID">alsoinliers</span> = <span class="ID">data</span>[<span class="ID">also_idxs</span>,:]</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_89">  89</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_89"></span><span class="anchor" id="line-89"></span>        <span class="ResWord">if</span> <span class="ID">debug</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_90">  90</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_90"></span><span class="anchor" id="line-90"></span>            <span class="ResWord">print</span> <span class="String">'</span><span class="String">test_err.min()</span><span class="String">'</span>,<span class="ID">test_err</span>.<span class="ID">min</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_91">  91</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_91"></span><span class="anchor" id="line-91"></span>            <span class="ResWord">print</span> <span class="String">'</span><span class="String">test_err.max()</span><span class="String">'</span>,<span class="ID">test_err</span>.<span class="ID">max</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_92">  92</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_92"></span><span class="anchor" id="line-92"></span>            <span class="ResWord">print</span> <span class="String">'</span><span class="String">numpy.mean(test_err)</span><span class="String">'</span>,<span class="ID">numpy</span>.<span class="ID">mean</span>(<span class="ID">test_err</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_93">  93</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_93"></span><span class="anchor" id="line-93"></span>            <span class="ResWord">print</span> <span class="String">'</span><span class="String">iteration </span><span class="String">%d</span><span class="String">:len(alsoinliers) = </span><span class="String">%d</span><span class="String">'</span>%(</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_94">  94</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_94"></span><span class="anchor" id="line-94"></span>                <span class="ID">iterations</span>,<span class="ResWord">len</span>(<span class="ID">alsoinliers</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_95">  95</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_95"></span><span class="anchor" id="line-95"></span>        <span class="ResWord">if</span> <span class="ResWord">len</span>(<span class="ID">alsoinliers</span>) &gt; <span class="ID">d</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_96">  96</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_96"></span><span class="anchor" id="line-96"></span>            <span class="ID">betterdata</span> = <span class="ID">numpy</span>.<span class="ID">concatenate</span>( (<span class="ID">maybeinliers</span>, <span class="ID">alsoinliers</span>) )</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_97">  97</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_97"></span><span class="anchor" id="line-97"></span>            <span class="ID">bettermodel</span> = <span class="ID">model</span>.<span class="ID">fit</span>(<span class="ID">betterdata</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_98">  98</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_98"></span><span class="anchor" id="line-98"></span>            <span class="ID">better_errs</span> = <span class="ID">model</span>.<span class="ID">get_error</span>( <span class="ID">betterdata</span>, <span class="ID">bettermodel</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_99">  99</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_99"></span><span class="anchor" id="line-99"></span>            <span class="ID">thiserr</span> = <span class="ID">numpy</span>.<span class="ID">mean</span>( <span class="ID">better_errs</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_100"> 100</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_100"></span><span class="anchor" id="line-100"></span>            <span class="ResWord">if</span> <span class="ID">thiserr</span> &lt; <span class="ID">besterr</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_101"> 101</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_101"></span><span class="anchor" id="line-101"></span>                <span class="ID">bestfit</span> = <span class="ID">bettermodel</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_102"> 102</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_102"></span><span class="anchor" id="line-102"></span>                <span class="ID">besterr</span> = <span class="ID">thiserr</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_103"> 103</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_103"></span><span class="anchor" id="line-103"></span>                <span class="ID">best_inlier_idxs</span> = <span class="ID">numpy</span>.<span class="ID">concatenate</span>( (<span class="ID">maybe_idxs</span>, <span class="ID">also_idxs</span>) )</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_104"> 104</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_104"></span><span class="anchor" id="line-104"></span>        <span class="ID">iterations</span>+=<span class="Number">1</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_105"> 105</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_105"></span><span class="anchor" id="line-105"></span>    <span class="ResWord">if</span> <span class="ID">bestfit</span> <span class="ResWord">is</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_106"> 106</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_106"></span><span class="anchor" id="line-106"></span>        <span class="ResWord">raise</span> <span class="ID">ValueError</span>(<span class="String">&quot;</span><span class="String">did not meet fit acceptance criteria</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_107"> 107</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_107"></span><span class="anchor" id="line-107"></span>    <span class="ResWord">if</span> <span class="ID">return_all</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_108"> 108</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_108"></span><span class="anchor" id="line-108"></span>        <span class="ResWord">return</span> <span class="ID">bestfit</span>, {<span class="String">'</span><span class="String">inliers</span><span class="String">'</span>:<span class="ID">best_inlier_idxs</span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_109"> 109</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_109"></span><span class="anchor" id="line-109"></span>    <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_110"> 110</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_110"></span><span class="anchor" id="line-110"></span>        <span class="ResWord">return</span> <span class="ID">bestfit</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_111"> 111</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_111"></span><span class="anchor" id="line-111"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_112"> 112</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_112"></span><span class="anchor" id="line-112"></span><span class="ResWord">def</span> <span class="ID">random_partition</span>(<span class="ID">n</span>,<span class="ID">n_data</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_113"> 113</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_113"></span><span class="anchor" id="line-113"></span>    <span class="String">&quot;&quot;&quot;return n random rows of data (and also the other len(data)-n rows)&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_114"> 114</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_114"></span><span class="anchor" id="line-114"></span>    <span class="ID">all_idxs</span> = <span class="ID">numpy</span>.<span class="ID">arange</span>( <span class="ID">n_data</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_115"> 115</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_115"></span><span class="anchor" id="line-115"></span>    <span class="ID">numpy</span>.<span class="ID">random</span>.<span class="ID">shuffle</span>(<span class="ID">all_idxs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_116"> 116</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_116"></span><span class="anchor" id="line-116"></span>    <span class="ID">idxs1</span> = <span class="ID">all_idxs</span>[:<span class="ID">n</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_117"> 117</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_117"></span><span class="anchor" id="line-117"></span>    <span class="ID">idxs2</span> = <span class="ID">all_idxs</span>[<span class="ID">n</span>:]</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_118"> 118</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_118"></span><span class="anchor" id="line-118"></span>    <span class="ResWord">return</span> <span class="ID">idxs1</span>, <span class="ID">idxs2</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_119"> 119</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_119"></span><span class="anchor" id="line-119"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_120"> 120</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_120"></span><span class="anchor" id="line-120"></span><span class="ResWord">class</span> <span class="ID">LinearLeastSquaresModel</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_121"> 121</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_121"></span><span class="anchor" id="line-121"></span>    <span class="String">&quot;&quot;&quot;linear system solved using linear least squares</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_122"> 122</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_122"></span><span class="anchor" id="line-122"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_123"> 123</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_123"></span><span class="anchor" id="line-123"></span><span class="String">    This class serves as an example that fulfills the model interface</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_124"> 124</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_124"></span><span class="anchor" id="line-124"></span><span class="String">    needed by the ransac() function.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_125"> 125</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_125"></span><span class="anchor" id="line-125"></span><span class="String">    </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_126"> 126</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_126"></span><span class="anchor" id="line-126"></span><span class="String">    &quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_127"> 127</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_127"></span><span class="anchor" id="line-127"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>,<span class="ID">input_columns</span>,<span class="ID">output_columns</span>,<span class="ID">debug</span>=<span class="ResWord">False</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_128"> 128</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_128"></span><span class="anchor" id="line-128"></span>        <span class="ResWord">self</span>.<span class="ID">input_columns</span> = <span class="ID">input_columns</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_129"> 129</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_129"></span><span class="anchor" id="line-129"></span>        <span class="ResWord">self</span>.<span class="ID">output_columns</span> = <span class="ID">output_columns</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_130"> 130</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_130"></span><span class="anchor" id="line-130"></span>        <span class="ResWord">self</span>.<span class="ID">debug</span> = <span class="ID">debug</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_131"> 131</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_131"></span><span class="anchor" id="line-131"></span>    <span class="ResWord">def</span> <span class="ID">fit</span>(<span class="ResWord">self</span>, <span class="ID">data</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_132"> 132</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_132"></span><span class="anchor" id="line-132"></span>        <span class="ID">A</span> = <span class="ID">numpy</span>.<span class="ID">vstack</span>([<span class="ID">data</span>[:,<span class="ID">i</span>] <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">input_columns</span>]).<span class="ID">T</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_133"> 133</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_133"></span><span class="anchor" id="line-133"></span>        <span class="ID">B</span> = <span class="ID">numpy</span>.<span class="ID">vstack</span>([<span class="ID">data</span>[:,<span class="ID">i</span>] <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">output_columns</span>]).<span class="ID">T</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_134"> 134</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_134"></span><span class="anchor" id="line-134"></span>        <span class="ID">x</span>,<span class="ID">resids</span>,<span class="ID">rank</span>,<span class="ID">s</span> = <span class="ID">scipy</span>.<span class="ID">linalg</span>.<span class="ID">lstsq</span>(<span class="ID">A</span>,<span class="ID">B</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_135"> 135</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_135"></span><span class="anchor" id="line-135"></span>        <span class="ResWord">return</span> <span class="ID">x</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_136"> 136</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_136"></span><span class="anchor" id="line-136"></span>    <span class="ResWord">def</span> <span class="ID">get_error</span>( <span class="ResWord">self</span>, <span class="ID">data</span>, <span class="ID">model</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_137"> 137</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_137"></span><span class="anchor" id="line-137"></span>        <span class="ID">A</span> = <span class="ID">numpy</span>.<span class="ID">vstack</span>([<span class="ID">data</span>[:,<span class="ID">i</span>] <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">input_columns</span>]).<span class="ID">T</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_138"> 138</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_138"></span><span class="anchor" id="line-138"></span>        <span class="ID">B</span> = <span class="ID">numpy</span>.<span class="ID">vstack</span>([<span class="ID">data</span>[:,<span class="ID">i</span>] <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">output_columns</span>]).<span class="ID">T</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_139"> 139</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_139"></span><span class="anchor" id="line-139"></span>        <span class="ID">B_fit</span> = <span class="ID">scipy</span>.<span class="ID">dot</span>(<span class="ID">A</span>,<span class="ID">model</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_140"> 140</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_140"></span><span class="anchor" id="line-140"></span>        <span class="ID">err_per_point</span> = <span class="ID">numpy</span>.<span class="ID">sum</span>((<span class="ID">B</span>-<span class="ID">B_fit</span>)**<span class="Number">2</span>,<span class="ID">axis</span>=<span class="Number">1</span>) <span class="Comment"># sum squared error per row</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_141"> 141</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_141"></span><span class="anchor" id="line-141"></span>        <span class="ResWord">return</span> <span class="ID">err_per_point</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_142"> 142</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_142"></span><span class="anchor" id="line-142"></span>        </span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_143"> 143</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_143"></span><span class="anchor" id="line-143"></span><span class="ResWord">def</span> <span class="ID">test</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_144"> 144</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_144"></span><span class="anchor" id="line-144"></span>    <span class="Comment"># generate perfect input data</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_145"> 145</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_145"></span><span class="anchor" id="line-145"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_146"> 146</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_146"></span><span class="anchor" id="line-146"></span>    <span class="ID">n_samples</span> = <span class="Number">500</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_147"> 147</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_147"></span><span class="anchor" id="line-147"></span>    <span class="ID">n_inputs</span> = <span class="Number">1</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_148"> 148</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_148"></span><span class="anchor" id="line-148"></span>    <span class="ID">n_outputs</span> = <span class="Number">1</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_149"> 149</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_149"></span><span class="anchor" id="line-149"></span>    <span class="ID">A_exact</span> = <span class="Number">20</span>*<span class="ID">numpy</span>.<span class="ID">random</span>.<span class="ID">random</span>((<span class="ID">n_samples</span>,<span class="ID">n_inputs</span>) )</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_150"> 150</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_150"></span><span class="anchor" id="line-150"></span>    <span class="ID">perfect_fit</span> = <span class="Number">60</span>*<span class="ID">numpy</span>.<span class="ID">random</span>.<span class="ID">normal</span>(<span class="ID">size</span>=(<span class="ID">n_inputs</span>,<span class="ID">n_outputs</span>) ) <span class="Comment"># the model</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_151"> 151</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_151"></span><span class="anchor" id="line-151"></span>    <span class="ID">B_exact</span> = <span class="ID">scipy</span>.<span class="ID">dot</span>(<span class="ID">A_exact</span>,<span class="ID">perfect_fit</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_152"> 152</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_152"></span><span class="anchor" id="line-152"></span>    <span class="ResWord">assert</span> <span class="ID">B_exact</span>.<span class="ID">shape</span> == (<span class="ID">n_samples</span>,<span class="ID">n_outputs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_153"> 153</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_153"></span><span class="anchor" id="line-153"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_154"> 154</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_154"></span><span class="anchor" id="line-154"></span>    <span class="Comment"># add a little gaussian noise (linear least squares alone should handle this well)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_155"> 155</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_155"></span><span class="anchor" id="line-155"></span>    <span class="ID">A_noisy</span> = <span class="ID">A_exact</span> + <span class="ID">numpy</span>.<span class="ID">random</span>.<span class="ID">normal</span>(<span class="ID">size</span>=<span class="ID">A_exact</span>.<span class="ID">shape</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_156"> 156</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_156"></span><span class="anchor" id="line-156"></span>    <span class="ID">B_noisy</span> = <span class="ID">B_exact</span> + <span class="ID">numpy</span>.<span class="ID">random</span>.<span class="ID">normal</span>(<span class="ID">size</span>=<span class="ID">B_exact</span>.<span class="ID">shape</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_157"> 157</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_157"></span><span class="anchor" id="line-157"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_158"> 158</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_158"></span><span class="anchor" id="line-158"></span>    <span class="ResWord">if</span> <span class="Number">1</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_159"> 159</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_159"></span><span class="anchor" id="line-159"></span>        <span class="Comment"># add some outliers</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_160"> 160</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_160"></span><span class="anchor" id="line-160"></span>        <span class="ID">n_outliers</span> = <span class="Number">100</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_161"> 161</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_161"></span><span class="anchor" id="line-161"></span>        <span class="ID">all_idxs</span> = <span class="ID">numpy</span>.<span class="ID">arange</span>( <span class="ID">A_noisy</span>.<span class="ID">shape</span>[<span class="Number">0</span>] )</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_162"> 162</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_162"></span><span class="anchor" id="line-162"></span>        <span class="ID">numpy</span>.<span class="ID">random</span>.<span class="ID">shuffle</span>(<span class="ID">all_idxs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_163"> 163</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_163"></span><span class="anchor" id="line-163"></span>        <span class="ID">outlier_idxs</span> = <span class="ID">all_idxs</span>[:<span class="ID">n_outliers</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_164"> 164</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_164"></span><span class="anchor" id="line-164"></span>        <span class="ID">non_outlier_idxs</span> = <span class="ID">all_idxs</span>[<span class="ID">n_outliers</span>:]</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_165"> 165</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_165"></span><span class="anchor" id="line-165"></span>        <span class="ID">A_noisy</span>[<span class="ID">outlier_idxs</span>] =  <span class="Number">20</span>*<span class="ID">numpy</span>.<span class="ID">random</span>.<span class="ID">random</span>((<span class="ID">n_outliers</span>,<span class="ID">n_inputs</span>) )</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_166"> 166</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_166"></span><span class="anchor" id="line-166"></span>        <span class="ID">B_noisy</span>[<span class="ID">outlier_idxs</span>] = <span class="Number">50</span>*<span class="ID">numpy</span>.<span class="ID">random</span>.<span class="ID">normal</span>(<span class="ID">size</span>=(<span class="ID">n_outliers</span>,<span class="ID">n_outputs</span>) )</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_167"> 167</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_167"></span><span class="anchor" id="line-167"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_168"> 168</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_168"></span><span class="anchor" id="line-168"></span>    <span class="Comment"># setup model</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_169"> 169</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_169"></span><span class="anchor" id="line-169"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_170"> 170</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_170"></span><span class="anchor" id="line-170"></span>    <span class="ID">all_data</span> = <span class="ID">numpy</span>.<span class="ID">hstack</span>( (<span class="ID">A_noisy</span>,<span class="ID">B_noisy</span>) )</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_171"> 171</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_171"></span><span class="anchor" id="line-171"></span>    <span class="ID">input_columns</span> = <span class="ResWord">range</span>(<span class="ID">n_inputs</span>) <span class="Comment"># the first columns of the array</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_172"> 172</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_172"></span><span class="anchor" id="line-172"></span>    <span class="ID">output_columns</span> = [<span class="ID">n_inputs</span>+<span class="ID">i</span> <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ID">n_outputs</span>)] <span class="Comment"># the last columns of the array</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_173"> 173</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_173"></span><span class="anchor" id="line-173"></span>    <span class="ID">debug</span> = <span class="ResWord">False</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_174"> 174</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_174"></span><span class="anchor" id="line-174"></span>    <span class="ID">model</span> = <span class="ID">LinearLeastSquaresModel</span>(<span class="ID">input_columns</span>,<span class="ID">output_columns</span>,<span class="ID">debug</span>=<span class="ID">debug</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_175"> 175</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_175"></span><span class="anchor" id="line-175"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_176"> 176</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_176"></span><span class="anchor" id="line-176"></span>    <span class="ID">linear_fit</span>,<span class="ID">resids</span>,<span class="ID">rank</span>,<span class="ID">s</span> = <span class="ID">scipy</span>.<span class="ID">linalg</span>.<span class="ID">lstsq</span>(<span class="ID">all_data</span>[:,<span class="ID">input_columns</span>],</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_177"> 177</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_177"></span><span class="anchor" id="line-177"></span>                                                  <span class="ID">all_data</span>[:,<span class="ID">output_columns</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_178"> 178</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_178"></span><span class="anchor" id="line-178"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_179"> 179</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_179"></span><span class="anchor" id="line-179"></span>    <span class="Comment"># run RANSAC algorithm</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_180"> 180</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_180"></span><span class="anchor" id="line-180"></span>    <span class="ID">ransac_fit</span>, <span class="ID">ransac_data</span> = <span class="ID">ransac</span>(<span class="ID">all_data</span>,<span class="ID">model</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_181"> 181</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_181"></span><span class="anchor" id="line-181"></span>                                     <span class="Number">50</span>, <span class="Number">1000</span>, <span class="Number">7e3</span>, <span class="Number">300</span>, <span class="Comment"># misc. parameters</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_182"> 182</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_182"></span><span class="anchor" id="line-182"></span>                                     <span class="ID">debug</span>=<span class="ID">debug</span>,<span class="ID">return_all</span>=<span class="ResWord">True</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_183"> 183</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_183"></span><span class="anchor" id="line-183"></span>    <span class="ResWord">if</span> <span class="Number">1</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_184"> 184</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_184"></span><span class="anchor" id="line-184"></span>        <span class="ResWord">import</span> <span class="ID">pylab</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_185"> 185</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_185"></span><span class="anchor" id="line-185"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_186"> 186</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_186"></span><span class="anchor" id="line-186"></span>        <span class="ID">sort_idxs</span> = <span class="ID">numpy</span>.<span class="ID">argsort</span>(<span class="ID">A_exact</span>[:,<span class="Number">0</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_187"> 187</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_187"></span><span class="anchor" id="line-187"></span>        <span class="ID">A_col0_sorted</span> = <span class="ID">A_exact</span>[<span class="ID">sort_idxs</span>] <span class="Comment"># maintain as rank-2 array</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_188"> 188</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_188"></span><span class="anchor" id="line-188"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_189"> 189</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_189"></span><span class="anchor" id="line-189"></span>        <span class="ResWord">if</span> <span class="Number">1</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_190"> 190</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_190"></span><span class="anchor" id="line-190"></span>            <span class="ID">pylab</span>.<span class="ID">plot</span>( <span class="ID">A_noisy</span>[:,<span class="Number">0</span>], <span class="ID">B_noisy</span>[:,<span class="Number">0</span>], <span class="String">'</span><span class="String">k.</span><span class="String">'</span>, <span class="ID">label</span>=<span class="String">'</span><span class="String">data</span><span class="String">'</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_191"> 191</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_191"></span><span class="anchor" id="line-191"></span>            <span class="ID">pylab</span>.<span class="ID">plot</span>( <span class="ID">A_noisy</span>[<span class="ID">ransac_data</span>[<span class="String">'</span><span class="String">inliers</span><span class="String">'</span>],<span class="Number">0</span>], <span class="ID">B_noisy</span>[<span class="ID">ransac_data</span>[<span class="String">'</span><span class="String">inliers</span><span class="String">'</span>],<span class="Number">0</span>], <span class="String">'</span><span class="String">bx</span><span class="String">'</span>, <span class="ID">label</span>=<span class="String">'</span><span class="String">RANSAC data</span><span class="String">'</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_192"> 192</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_192"></span><span class="anchor" id="line-192"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_193"> 193</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_193"></span><span class="anchor" id="line-193"></span>            <span class="ID">pylab</span>.<span class="ID">plot</span>( <span class="ID">A_noisy</span>[<span class="ID">non_outlier_idxs</span>,<span class="Number">0</span>], <span class="ID">B_noisy</span>[<span class="ID">non_outlier_idxs</span>,<span class="Number">0</span>], <span class="String">'</span><span class="String">k.</span><span class="String">'</span>, <span class="ID">label</span>=<span class="String">'</span><span class="String">noisy data</span><span class="String">'</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_194"> 194</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_194"></span><span class="anchor" id="line-194"></span>            <span class="ID">pylab</span>.<span class="ID">plot</span>( <span class="ID">A_noisy</span>[<span class="ID">outlier_idxs</span>,<span class="Number">0</span>], <span class="ID">B_noisy</span>[<span class="ID">outlier_idxs</span>,<span class="Number">0</span>], <span class="String">'</span><span class="String">r.</span><span class="String">'</span>, <span class="ID">label</span>=<span class="String">'</span><span class="String">outlier data</span><span class="String">'</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_195"> 195</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_195"></span><span class="anchor" id="line-195"></span>        <span class="ID">pylab</span>.<span class="ID">plot</span>( <span class="ID">A_col0_sorted</span>[:,<span class="Number">0</span>],</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_196"> 196</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_196"></span><span class="anchor" id="line-196"></span>                    <span class="ID">numpy</span>.<span class="ID">dot</span>(<span class="ID">A_col0_sorted</span>,<span class="ID">ransac_fit</span>)[:,<span class="Number">0</span>],</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_197"> 197</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_197"></span><span class="anchor" id="line-197"></span>                    <span class="ID">label</span>=<span class="String">'</span><span class="String">RANSAC fit</span><span class="String">'</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_198"> 198</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_198"></span><span class="anchor" id="line-198"></span>        <span class="ID">pylab</span>.<span class="ID">plot</span>( <span class="ID">A_col0_sorted</span>[:,<span class="Number">0</span>],</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_199"> 199</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_199"></span><span class="anchor" id="line-199"></span>                    <span class="ID">numpy</span>.<span class="ID">dot</span>(<span class="ID">A_col0_sorted</span>,<span class="ID">perfect_fit</span>)[:,<span class="Number">0</span>],</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_200"> 200</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_200"></span><span class="anchor" id="line-200"></span>                    <span class="ID">label</span>=<span class="String">'</span><span class="String">exact system</span><span class="String">'</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_201"> 201</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_201"></span><span class="anchor" id="line-201"></span>        <span class="ID">pylab</span>.<span class="ID">plot</span>( <span class="ID">A_col0_sorted</span>[:,<span class="Number">0</span>],</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_202"> 202</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_202"></span><span class="anchor" id="line-202"></span>                    <span class="ID">numpy</span>.<span class="ID">dot</span>(<span class="ID">A_col0_sorted</span>,<span class="ID">linear_fit</span>)[:,<span class="Number">0</span>],</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_203"> 203</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_203"></span><span class="anchor" id="line-203"></span>                    <span class="ID">label</span>=<span class="String">'</span><span class="String">linear fit</span><span class="String">'</span> )</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_204"> 204</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_204"></span><span class="anchor" id="line-204"></span>        <span class="ID">pylab</span>.<span class="ID">legend</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_205"> 205</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_205"></span><span class="anchor" id="line-205"></span>        <span class="ID">pylab</span>.<span class="ID">show</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_206"> 206</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_206"></span><span class="anchor" id="line-206"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_207"> 207</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_207"></span><span class="anchor" id="line-207"></span><span class="ResWord">if</span> <span class="ID">__name__</span>==<span class="String">'</span><span class="String">__main__</span><span class="String">'</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_208"> 208</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_208"></span><span class="anchor" id="line-208"></span>    <span class="ID">test</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_209"> 209</a> </span><span class="LineAnchor" id="CA-c4be47ffca0400078d03a61fe5dcbe4da63e5f1c_209"></span><span class="anchor" id="line-209"></span>    </span>
</pre></div></div><p class="line867"><a class="attachment" href="RANSAC803e.html?action=AttachFile&amp;do=view&amp;target=ransac.py" title="attachment:ransac.py">ransac.py</a> <span class="anchor" id="line-29-1"></span><span class="anchor" id="line-30-1"></span><p class="line867"><hr /><p class="line874"> <span class="anchor" id="line-31-1"></span><ul><li style="list-style-type:none"><p class="line891"><a href="../CategoryCookbook.html"><strong class="highlight">CategoryCookbook</strong></a> <span class="anchor" id="line-32-1"></span></li></ul><span class="anchor" id="bottom"></span></div><p id="pageinfo" class="info" lang="en" dir="ltr">SciPy: Cookbook/RANSAC  (last edited 2015-10-24 17:48:26 by <span title="">anonymous</span>)</p>

<div id="pagebottom"></div>
</div>


<div id="footer">
<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="RANSAC37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../../external.html?link=http://localhost:8080/Cookbook/RANSAC">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

<ul id="credits">
<li><a href="../../external.html?link=http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="../../external.html?link=http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="../../external.html?link=http://moinmo.in/GPL" title="MoinMoin is GPL licensed.">GPL licensed</a></li><li><a href="../../external.html?link=http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li>
</ul>


</div>
</body>

<!-- Mirrored from localhost:8080/Cookbook/RANSAC?highlight=%28%28CategoryCookbook%29%29 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 23:34:07 GMT -->
</html>

