<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<!-- Mirrored from localhost:8080/Cookbook/C_Extensions/NumPy_arrays?highlight=%28%28SciPy%29%29 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 23:20:10 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="edit_on_doubleclick" content="/">
<meta name="robots" content="noindex,nofollow">

<title>Cookbook/C_Extensions/NumPy_arrays - SciPy</title>
<script type="text/javascript" src="../../moin_static197/common/js/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../../moin_static197/modern/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="../../moin_static197/modern/css/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="../../moin_static197/modern/css/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="../../moin_static197/modern/css/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static197/modern/css/msie.css">
<![endif]-->


<link rel="alternate" title="SciPy: Cookbook/C_Extensions/NumPy_arrays" href="../../../external.html?link=http://localhost:8080/Cookbook/C_Extensions/NumPy_arrays?diffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=Cookbook%2FC_Extensions%2FNumPy_arrays&amp;ddiffs=1" type="application/rss+xml">


<link rel="Start" href="../../AllPages.html">
<link rel="Alternate" title="Wiki Markup" href="../../../external.html?link=http://localhost:8080/Cookbook/C_Extensions/NumPy_arrays?action=raw">
<link rel="Alternate" media="print" title="Print View" href="../../../external.html?link=http://localhost:8080/Cookbook/C_Extensions/NumPy_arrays?action=print">
<link rel="Up" href="../C_Extensions.html">
<link rel="Appendix" title="C_arraytest.c" href="NumPy_arraysa868.html?action=AttachFile&amp;do=view&amp;target=C_arraytest.c">
<link rel="Appendix" title="C_arraytest.c_v2" href="NumPy_arrays7bc7.html?action=AttachFile&amp;do=view&amp;target=C_arraytest.c_v2">
<link rel="Appendix" title="C_arraytest.h" href="NumPy_arrays8a71.html?action=AttachFile&amp;do=view&amp;target=C_arraytest.h">
<link rel="Appendix" title="C_arraytest.h_v2" href="NumPy_arrays8db7.html?action=AttachFile&amp;do=view&amp;target=C_arraytest.h_v2">
<link rel="Appendix" title="Cext_v2.tar.gz" href="NumPy_arrays102a.html?action=AttachFile&amp;do=view&amp;target=Cext_v2.tar.gz">
<link rel="Search" href="../../FindPage.html">
<link rel="Index" href="../../TitleIndex.html">
<link rel="Glossary" href="../../WordIndex.html">
<link rel="Help" href="../../HelpOnFormatting.html">
</head>

<body  lang="en" dir="ltr">

<div id="header">


<form id="searchform" method="get" action="../../../external.html?link=http://localhost:8080/Cookbook/C_Extensions/NumPy_arrays">
<div>
<input type="hidden" name="action" value="fullsearch">
<input type="hidden" name="context" value="180">
<label for="searchinput">Search:</label>
<input id="searchinput" type="text" name="value" value="" size="20"
    onfocus="searchFocus(this)" onblur="searchBlur(this)"
    onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search">
<input id="titlesearch" name="titlesearch" type="submit"
    value="Titles" alt="Search Titles">
<input id="fullsearch" name="fullsearch" type="submit"
    value="Text" alt="Search Full Text">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<ul id="username"><li><a href="NumPy_arrays456e.html?action=login" id="login" rel="nofollow">Login</a></li></ul>
<div id="locationline">
<div id="interwiki"><span><a href="../../AllPages.html" rel="nofollow">SciPy</a></span></div>

<ul id="pagelocation">
<li><a href="../../Cookbook.html">Cookbook</a></li><li><a href="../C_Extensions.html">C_Extensions</a></li><li><a class="backlink" href="NumPy_arrays188f.html?action=fullsearch&amp;context=180&amp;value=linkto%3A%22Cookbook%2FC_Extensions%2FNumPy_arrays%22" rel="nofollow" title="Click to do a full-text search for this title">NumPy_arrays</a></li>
</ul>

</div>


<ul id="navibar">
<li class="wikilink"><a href="../../RecentChanges.html">RecentChanges</a></li><li class="wikilink"><a class="nonexistent" href="../../FindPage.html">FindPage</a></li><li class="wikilink"><a class="nonexistent" href="../../HelpContents.html">HelpContents</a></li><li class="current"><a href="NumPy_arrays.html">NumPy_arrays</a></li>
</ul>

<div id="pageline"><hr style="display:none;"></div>

<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="NumPy_arrays37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../../../external.html?link=http://localhost:8080/Cookbook/C_Extensions/NumPy_arrays">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

</div>

<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><p class="line862">C Extensions for Using <a class="nonexistent" href="../../NumPy.html">NumPy</a> Arrays <span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><p class="line862">I've written several C extensions that handle <a class="nonexistent" href="../../NumPy.html">NumPy</a> arrays.  They are simple, but they seem to work well. They will show you how to pass Python variables and <a class="nonexistent" href="../../NumPy.html">NumPy</a> arrays to your C code. Once you learn how to do it, it's pretty straight-forward. I suspect they will suffice for most numerical code.  I've written it up as a draft and have made the code and document file available. I found for my numerical needs I really only need to pass a limited set of things (integers, floats, strings, and <a class="nonexistent" href="../../NumPy.html">NumPy</a> arrays).  If that's your category, this code might help you. <span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span><span class="anchor" id="line-6"></span><p class="line862">I have tested the routines and so far,so good, but I cannot guarantee anything.  I am a bit new to this.  If you find any errors put up a message on the <a href="../../SciPy.html"><strong class="highlight">SciPy</strong></a> mailing list. <span class="anchor" id="line-7"></span><span class="anchor" id="line-8"></span><p class="line874">A link to the tar ball that holds the code and docs is given below. <span class="anchor" id="line-9"></span><span class="anchor" id="line-10"></span><p class="line874">I have recently updated some information and included more examples.  The document presented below is the original documentation which is still useful.  The link below holds the latest documentation and source code. <span class="anchor" id="line-11"></span><span class="anchor" id="line-12"></span><p class="line874">-- Lou Pecora <span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><ul><li style="list-style-type:none"><p class="line891"><a class="attachment" href="NumPy_arrays102a.html?action=AttachFile&amp;do=view&amp;target=Cext_v2.tar.gz" title="">Cext_v2.tar.gz</a> <span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span></li></ul><p class="line867"><hr /><p class="line874"> <span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><p class="line867"><em>What follows is the content of Lou`s word-document originally pasted here as version 1. I (<a href="../../DavidLinke.html">DavidLinke</a>) have converted this to wiki-markup:</em> <span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span><p class="line867">
<h1 id="C_Extensions_to_NumPy_and_Python">C Extensions to NumPy and Python</h1>
<span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span><p class="line874">By Lou Pecora - 2006-12-07 (Draft version 0.1) <span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span><p class="line867"><div class="table-of-contents"><p class="table-of-contents-heading">Contents<ol><li>
<a href="#C_Extensions_to_NumPy_and_Python">C Extensions to NumPy and Python</a><ol><li>
<a href="#Overview">Overview</a><ol><li>
<a href="#Introduction.2BIBM_a_little_background">Introduction– a little background</a></li><li>
<a href="#General_Scheme_for_NumPy_Extensions">General Scheme for NumPy Extensions</a></li><li>
<a href="#Python_Wrapper_Functions">Python Wrapper Functions</a></li></ol></li><li>
<a href="#The_Code">The Code</a><ol><li>
<a href="#The_C_Code_.2BIBM_one_detailed_example_with_utilities">The C Code – one detailed example with utilities</a><ol><li>
<a href="#Headers">Headers</a></li><li>
<a href="#Method_definitions">Method definitions</a></li><li>
<a href="#Initializations">Initializations</a></li><li>
<a href="#The_matsqfunction_code">The matsqfunction code</a></li></ol></li></ol></li></ol></li></ol></div><p class="line874"> <span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span><p class="line867">
<h2 id="Overview">Overview</h2>
<span class="anchor" id="line-27"></span><p class="line867">
<h3 id="Introduction.2BIBM_a_little_background">Introduction– a little background</h3>
<span class="anchor" id="line-28"></span><span class="anchor" id="line-29"></span><p class="line874">In my use of Python I came across a typical problem: I needed to speed up particular parts of my code. I am not a Python guru or any kind of coding/computer guru. I use Python for numerical calculations and I make heavy use of Numeric/NumPy. Almost every Python book or tutorial tells you build C extensions to Python when you need a routine to run fast. C extensions are C code that can be compiled and linked to a shared library that can be imported like any Python module and you can call specified C routines like they were Python functions. <span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span><p class="line862">Sounds nice, but I had reservations. It looked non-trivial (it is, to an extent). So I searched for other solutions. I found them. They are such approaches as <a class="http" href="../../../external.html?link=http://www.swig.org/">SWIG</a>, <a class="http" href="../../../external.html?link=http://www.cosc.canterbury.ac.nz/greg.ewing/python/Pyrex/">Pyrex</a>, <a class="http" href="../../../external.html?link=http://python.net/crew/theller/ctypes/">ctypes</a>, <a class="http" href="../../../external.html?link=http://psyco.sourceforge.net/">Psycho</a>, and <a class="http" href="../../../external.html?link=http://www.scipy.org/Weave">Weave</a>. I often got the simple examples given to work (not all, however) when I tried these. But I hit a barrier when I tried to apply them to <a class="nonexistent" href="../../NumPy.html">NumPy</a>. Then one gets into typemaps or other hybrid constructs. I am not knocking these approaches, but I could never figure them out and get going on my own code despite lots of online tutorials and helpful suggestions from various Python support groups and emailing lists. <span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span><p class="line862">So I decided to see if I could just write my own C extensions. I got help in the form of some simple C extension examples for using Numeric written about 2000 from Tom Loredo of Cornell university. These sat on my hard drive until 5 years later out of desperation I pulled them out and using his examples, I was able to quickly put together several C extensions that (at least for me) handle all of the cases (so far) where I want a speedup.   These cases mostly involve passing Python integers, floats (=C doubles), strings, and <a class="nonexistent" href="../../NumPy.html">NumPy</a> 1D and 2D float and integer arrays. I rarely need to pass anything else to a C routine to do a calculation. If you are in the same situation as me, then this package I put together might help you. It turns out to be fairly easy once you get going. <span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><p class="line874">Please note, Tom Loredo is not responsible for any errors in my code or instructions although I am deeply indebted to him. Likewise, this code is for research only. It was tested by only my development and usage. It is not guaranteed, and comes with no warranty. Do not use this code where there are any threats of loss of life, limb, property, or money or anything you or others hold dear. <span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span><p class="line862">I developed these C extensions and their Python wrappers on a Macintosh G4 laptop using system OS X 10.4 (essential BSD Unix), Python 2.4, <a class="nonexistent" href="../../NumPy.html">NumPy</a> 0.9x, and the gnu compiler and linker gcc. I think most of what I tell you here will be easily translated to Linux and other Unix systems beyond the Mac. I am not sure about Windows. I hope that my low-level approach will make it easy for Windows users, too. <span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span><p class="line862">The code (both C and Python) for the extensions may look like a lot, but it is <strong>very</strong> repetitious. Once you get the main scheme for one extension function you will see that repeated over and over again in all the others with minor variations to handle different arguments or return different objects to the calling routine. Don't be put off by the code. The good news is that for many numerical uses extensions will follow the same format so you can quickly reuse what you already have written for new projects. Focus on one extension function and follow it in detail (in fact, I will do this below). Once you understand it, the other routines will be almost obvious. The same is true of the several utility functions that come with the package. They help you create, test, and manipulate the data and they also have a lot of repetition. The utility functions are also very short and simple so nothing to fear there. <span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><p class="line867">
<h3 id="General_Scheme_for_NumPy_Extensions">General Scheme for NumPy Extensions</h3>
<span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><p class="line874">This will be covered in detail below, but first I wanted to give you a sense of how each extension is organized. <span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span><p class="line874">Three things that must be done before your C extension functions in the C source file. <span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span><ol type="1"><li><p class="line862">You must include Python and <a class="nonexistent" href="../../NumPy.html">NumPy</a> headers. <span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span></li><li class="gap">Each extension must be named in a defining structure at the beginning of the file. This is a name used to access the extension from a Python function. <span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span></li><li class="gap"><p class="line862">Next an initialization set of calls is made to set up the Python and <a class="nonexistent" href="../../NumPy.html">NumPy</a> calls and interface. It will be the same for all extensions involving <a class="nonexistent" href="../../NumPy.html">NumPy</a> and Python unless you add extensions to access other Python packages or classes beyond <a class="nonexistent" href="../../NumPy.html">NumPy</a> arrays. I will not cover any of that here (because I don't know it). So the init calls can be copied to each extension file. <span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span></li></ol><p class="line874">Each C extension will have the following form. <span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span><ul><li><p class="line862">The arguments will always be the same: (<tt class="backtick">PyObject&nbsp;*self</tt>, <tt class="backtick">PyObject&nbsp;*args</tt>) - Don't worry if you don't know what exactly these are. They are pointers to general Python objects and they are automatically provided by the header files you will use from <a class="nonexistent" href="../../NumPy.html">NumPy</a> and Python itself. You need know no more than that. <span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span></li><li class="gap">The args get processed by a function call that parses them and assigns them to C defined objects. <span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span></li><li class="gap">Next the results of that parse might be checked by a utility routine that reaches into the structure representing the object and makes sure the data is the right kind (float or int, 1D or 2D array, etc.). Although I included some of these C-level checks, you will see that I think they are better done in Python functions that are used to wrap the C extensions. They are also a lot easier to do in Python. I have plenty of data checks in my calling Python wrappers. Usually this does not lead to much overhead since you are not calling these extensions billions of times in some loop, but using them as a portal to a C or C++ routine to do a long, complex, repetitive, specialized calculation. <span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span></li><li class="gap"><p class="line862">After some possible data checks, C data types are initialized to point to the data part of the <a class="nonexistent" href="../../NumPy.html">NumPy</a> arrays with the help of utility functions. <span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span></li><li class="gap">Next dimension information is extracted so you know the number of columns, rows, vector dimensions, etc. <span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span></li><li class="gap"><p class="line862">Now you can use the C arrays to manipulate the data in the <a class="nonexistent" href="../../NumPy.html">NumPy</a> arrays. The C arrays and C data from the above parse point to the original Python/NumPy data so changes you make affect the array values when you go back to Python after the extension returns. You can pass the arrays to other C functions that do calculations, etc. Just remember you are operating on the original <a class="nonexistent" href="../../NumPy.html">NumPy</a> matrices and vectors. <span class="anchor" id="line-66"></span><span class="anchor" id="line-67"></span></li><li class="gap"><p class="line862">After your calculation you have to free any memory allocated in the construction of your C data for the <a class="nonexistent" href="../../NumPy.html">NumPy</a> arrays. This is done again by Utility functions. This step is only necessary if you allocated memory to handle the arrays (e.g. in the matrix routines), but is not necessary if you have not allocated memory (e.g. in the vector routines). <span class="anchor" id="line-68"></span><span class="anchor" id="line-69"></span></li><li class="gap"><p class="line862">Finally, you return to the Python calling function, by returning a Python value or <a class="nonexistent" href="../../NumPy.html">NumPy</a> array. I have C extensions which show examples of both. <span class="anchor" id="line-70"></span><span class="anchor" id="line-71"></span><span class="anchor" id="line-72"></span></li></ul><p class="line867">
<h3 id="Python_Wrapper_Functions">Python Wrapper Functions</h3>
<span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span><p class="line874">It is best to call the C extensions by calling a Python function that then calls the extension. This is called a Python wrapper function. It puts a more pythonic look to your code (e.g. you can use keywords easily) and, as I pointed out above, allows you to easily check that the function arguments and data are correct before you had them over to the C extension and other C functions for that big calculation. It may seem like an unnecessary extra step, but it's worth it. <span class="anchor" id="line-75"></span><span class="anchor" id="line-76"></span><span class="anchor" id="line-77"></span><p class="line867">
<h2 id="The_Code">The Code</h2>
<span class="anchor" id="line-78"></span><span class="anchor" id="line-79"></span><p class="line874">In this section I refer to the code in the source files C_arraytest.h, C_arraytest.c, C_arraytest.py, and C_arraytest.mak. You should keep those files handy (probably printed out) so you can follow the explanations of the code below. <span class="anchor" id="line-80"></span><span class="anchor" id="line-81"></span><p class="line867">
<h3 id="The_C_Code_.2BIBM_one_detailed_example_with_utilities">The C Code – one detailed example with utilities</h3>
<span class="anchor" id="line-82"></span><span class="anchor" id="line-83"></span><p class="line862">First, I will use the example of code from C_arraytest.h, C_arraytest.c for the routine called matsq. This function takes a (<a class="nonexistent" href="../../NumPy.html">NumPy</a>) matrix <em>A</em>, integer <em>i</em>, and (Python) float <em>y</em> as input and outputs a return (<a class="nonexistent" href="../../NumPy.html">NumPy</a>) matrix <em>B</em> each of whose components is equal to the square of the input matrix component times the integer times the float. Mathematically: <span class="anchor" id="line-84"></span><span class="anchor" id="line-85"></span><ul><li style="list-style-type:none"><p class="line891"><em>B<sub>ij</sub></em> = <em>i y</em> (<em>A<sub>ij</sub></em>)<sup>2</sup> <span class="anchor" id="line-86"></span><span class="anchor" id="line-87"></span></li></ul><p class="line862">The Python code to call the matsq routine is <tt class="backtick">A=matsq(B,i,y)</tt>. Here is the relevant code in one place: <span class="anchor" id="line-88"></span><span class="anchor" id="line-89"></span><p class="line874">The Header file, C_arraytest.h: <span class="anchor" id="line-90"></span><span class="anchor" id="line-91"></span><ul><span class="anchor" id="line-1-1"></span><div class="highlight text"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
function isnumbered(obj) {
  return obj.childNodes.length && obj.firstChild.childNodes.length && obj.firstChild.firstChild.className == 'LineNumber';
}
function nformat(num,chrs,add) {
  var nlen = Math.max(0,chrs-(''+num).length), res = '';
  while (nlen>0) { res += ' '; nlen-- }
  return res+num+add;
}
function addnumber(did, nstart, nstep) {
  var c = document.getElementById(did), l = c.firstChild, n = 1;
  if (!isnumbered(c)) {
    if (typeof nstart == 'undefined') nstart = 1;
    if (typeof nstep  == 'undefined') nstep = 1;
    var n = nstart;
    while (l != null) {
      if (l.tagName == 'SPAN') {
        var s = document.createElement('SPAN');
        var a = document.createElement('A');
        s.className = 'LineNumber';
        a.appendChild(document.createTextNode(nformat(n,4,'')));
        a.href = '#' + did + '_' + n;
        s.appendChild(a);
        s.appendChild(document.createTextNode(' '));
        n += nstep;
        if (l.childNodes.length) {
          l.insertBefore(s, l.firstChild);
        }
        else {
          l.appendChild(s);
        }
      }
      l = l.nextSibling;
    }
  }
  return false;
}
function remnumber(did) {
  var c = document.getElementById(did), l = c.firstChild;
  if (isnumbered(c)) {
    while (l != null) {
      if (l.tagName == 'SPAN' && l.firstChild.className == 'LineNumber') l.removeChild(l.firstChild);
      l = l.nextSibling;
    }
  }
  return false;
}
function togglenumber(did, nstart, nstep) {
  var c = document.getElementById(did);
  if (isnumbered(c)) {
    remnumber(did);
  } else {
    addnumber(did,nstart,nstep);
  }
  return false;
}
</script>

<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-e055aa5e126ce94ad87603787fb8cb825990e993\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_1">   1</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_1"></span><span class="anchor" id="line-1-2"></span><span class="Comment">/* Header to test of C modules for arrays for Python: C_test.c */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_2">   2</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_2"></span><span class="anchor" id="line-2-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_3">   3</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_3"></span><span class="anchor" id="line-3-1"></span><span class="Comment">/* ==== Prototypes =================================== */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_4">   4</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_4"></span><span class="anchor" id="line-4-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_5">   5</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_5"></span><span class="anchor" id="line-5-1"></span><span class="Comment">// .... Python callable Vector functions ..................</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_6">   6</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_6"></span><span class="anchor" id="line-6-1"></span><span class="Comment"></span><span class="ResWord">static</span> <span class="ID">PyObject</span> *<span class="ID">vecfcn1</span>(<span class="ID">PyObject</span> *<span class="ID">self</span>, <span class="ID">PyObject</span> *<span class="ID">args</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_7">   7</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_7"></span><span class="anchor" id="line-7-1"></span><span class="ResWord">static</span> <span class="ID">PyObject</span> *<span class="ID">vecsq</span>(<span class="ID">PyObject</span> *<span class="ID">self</span>, <span class="ID">PyObject</span> *<span class="ID">args</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_8">   8</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_8"></span><span class="anchor" id="line-8-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_9">   9</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_9"></span><span class="anchor" id="line-9-1"></span><span class="Comment">/* .... C vector utility functions ..................*/</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_10">  10</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_10"></span><span class="anchor" id="line-10-1"></span><span class="ID">PyArrayObject</span> *<span class="ID">pyvector</span>(<span class="ID">PyObject</span> *<span class="ID">objin</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_11">  11</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_11"></span><span class="anchor" id="line-11-1"></span><span class="ResWord">double</span> *<span class="ID">pyvector_to_Carrayptrs</span>(<span class="ID">PyArrayObject</span> *<span class="ID">arrayin</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_12">  12</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_12"></span><span class="anchor" id="line-12-1"></span><span class="ResWord">int</span>  <span class="ID">not_doublevector</span>(<span class="ID">PyArrayObject</span> *<span class="ID">vec</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_13">  13</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_13"></span><span class="anchor" id="line-13-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_14">  14</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_14"></span><span class="anchor" id="line-14-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_15">  15</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_15"></span><span class="anchor" id="line-15-1"></span><span class="Comment">/* .... Python callable Matrix functions ..................*/</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_16">  16</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_16"></span><span class="anchor" id="line-16-1"></span><span class="ResWord">static</span> <span class="ID">PyObject</span> *<span class="ID">rowx2</span>(<span class="ID">PyObject</span> *<span class="ID">self</span>, <span class="ID">PyObject</span> *<span class="ID">args</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_17">  17</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_17"></span><span class="anchor" id="line-17-1"></span><span class="ResWord">static</span> <span class="ID">PyObject</span> *<span class="ID">rowx2_v2</span>(<span class="ID">PyObject</span> *<span class="ID">self</span>, <span class="ID">PyObject</span> *<span class="ID">args</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_18">  18</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_18"></span><span class="anchor" id="line-18-1"></span><span class="ResWord">static</span> <span class="ID">PyObject</span> *<span class="ID">matsq</span>(<span class="ID">PyObject</span> *<span class="ID">self</span>, <span class="ID">PyObject</span> *<span class="ID">args</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_19">  19</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_19"></span><span class="anchor" id="line-19-1"></span><span class="ResWord">static</span> <span class="ID">PyObject</span> *<span class="ID">contigmat</span>(<span class="ID">PyObject</span> *<span class="ID">self</span>, <span class="ID">PyObject</span> *<span class="ID">args</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_20">  20</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_20"></span><span class="anchor" id="line-20-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_21">  21</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_21"></span><span class="anchor" id="line-21-1"></span><span class="Comment">/* .... C matrix utility functions ..................*/</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_22">  22</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_22"></span><span class="anchor" id="line-22-1"></span><span class="ID">PyArrayObject</span> *<span class="ID">pymatrix</span>(<span class="ID">PyObject</span> *<span class="ID">objin</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_23">  23</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_23"></span><span class="anchor" id="line-23-1"></span><span class="ResWord">double</span> **<span class="ID">pymatrix_to_Carrayptrs</span>(<span class="ID">PyArrayObject</span> *<span class="ID">arrayin</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_24">  24</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_24"></span><span class="anchor" id="line-24-1"></span><span class="ResWord">double</span> **<span class="ID">ptrvector</span>(<span class="ResWord">long</span> <span class="ID">n</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_25">  25</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_25"></span><span class="anchor" id="line-25-1"></span><span class="ResWord">void</span> <span class="ID">free_Carrayptrs</span>(<span class="ResWord">double</span> **<span class="ID">v</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_26">  26</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_26"></span><span class="anchor" id="line-26-1"></span><span class="ResWord">int</span>  <span class="ID">not_doublematrix</span>(<span class="ID">PyArrayObject</span> *<span class="ID">mat</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_27">  27</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_27"></span><span class="anchor" id="line-27-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_28">  28</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_28"></span><span class="anchor" id="line-28-1"></span><span class="Comment">/* .... Python callable integer 2D array functions ..................*/</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_29">  29</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_29"></span><span class="anchor" id="line-29-1"></span><span class="ResWord">static</span> <span class="ID">PyObject</span> *<span class="ID">intfcn1</span>(<span class="ID">PyObject</span> *<span class="ID">self</span>, <span class="ID">PyObject</span> *<span class="ID">args</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_30">  30</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_30"></span><span class="anchor" id="line-30-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_31">  31</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_31"></span><span class="anchor" id="line-31-1"></span><span class="Comment">/* .... C 2D int array utility functions ..................*/</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_32">  32</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_32"></span><span class="anchor" id="line-32-1"></span><span class="ID">PyArrayObject</span> *<span class="ID">pyint2Darray</span>(<span class="ID">PyObject</span> *<span class="ID">objin</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_33">  33</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_33"></span><span class="anchor" id="line-33-1"></span><span class="ResWord">int</span> **<span class="ID">pyint2Darray_to_Carrayptrs</span>(<span class="ID">PyArrayObject</span> *<span class="ID">arrayin</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_34">  34</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_34"></span><span class="anchor" id="line-34-1"></span><span class="ResWord">int</span> **<span class="ID">ptrintvector</span>(<span class="ResWord">long</span> <span class="ID">n</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_35">  35</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_35"></span><span class="anchor" id="line-35-1"></span><span class="ResWord">void</span> <span class="ID">free_Cint2Darrayptrs</span>(<span class="ResWord">int</span> **<span class="ID">v</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-e055aa5e126ce94ad87603787fb8cb825990e993_36">  36</a> </span><span class="LineAnchor" id="CA-e055aa5e126ce94ad87603787fb8cb825990e993_36"></span><span class="anchor" id="line-36-1"></span><span class="ResWord">int</span>  <span class="ID">not_int2Darray</span>(<span class="ID">PyArrayObject</span> *<span class="ID">mat</span>);</span>
</pre></div></div><li style="list-style-type:none"><p class="line891"><a class="attachment" href="NumPy_arrays8a71.html?action=AttachFile&amp;do=view&amp;target=C_arraytest.h" title="attachment:C_arraytest.h">C_arraytest.h</a> <span class="anchor" id="line-92"></span><span class="anchor" id="line-93"></span></li></ul><p class="line874">The Source file, C_arraytest.c: <span class="anchor" id="line-94"></span><span class="anchor" id="line-95"></span><ul><span class="anchor" id="line-1-3"></span><div class="highlight text"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-4c24d1a924163136cd0183d8f428952dda2a5d5a\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_1">   1</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_1"></span><span class="anchor" id="line-1-4"></span><span class="Comment">/* A file to test imorting C modules for handling arrays to Python */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_2">   2</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_2"></span><span class="anchor" id="line-2-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_3">   3</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_3"></span><span class="anchor" id="line-3-2"></span><span class="Preprc">#</span><span class="Preprc">include &quot;Python.h&quot;</span><span class="Preprc"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_4">   4</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_4"></span><span class="anchor" id="line-4-2"></span><span class="Preprc"></span><span class="Preprc">#</span><span class="Preprc">include &quot;arrayobject.h&quot;</span><span class="Preprc"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_5">   5</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_5"></span><span class="anchor" id="line-5-2"></span><span class="Preprc"></span><span class="Preprc">#</span><span class="Preprc">include &quot;C_arraytest.h&quot;</span><span class="Preprc"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_6">   6</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_6"></span><span class="anchor" id="line-6-2"></span><span class="Preprc"></span><span class="Preprc">#</span><span class="Preprc">include &lt;math.h&gt;</span><span class="Preprc"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_7">   7</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_7"></span><span class="anchor" id="line-7-2"></span><span class="Preprc"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_8">   8</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_8"></span><span class="anchor" id="line-8-2"></span><span class="Comment">/* #### Globals #################################### */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_9">   9</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_9"></span><span class="anchor" id="line-9-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_10">  10</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_10"></span><span class="anchor" id="line-10-2"></span><span class="Comment">/* ==== Set up the methods table ====================== */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_11">  11</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_11"></span><span class="anchor" id="line-11-2"></span><span class="ResWord">static</span> <span class="ID">PyMethodDef</span> <span class="ID">_C_arraytestMethods</span>[] = {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_12">  12</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_12"></span><span class="anchor" id="line-12-2"></span>	{<span class="String">&quot;</span><span class="String">vecfcn1</span><span class="String">&quot;</span>, <span class="ID">vecfcn1</span>, <span class="ID">METH_VARARGS</span>},</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_13">  13</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_13"></span><span class="anchor" id="line-13-2"></span>	{<span class="String">&quot;</span><span class="String">vecsq</span><span class="String">&quot;</span>, <span class="ID">vecsq</span>, <span class="ID">METH_VARARGS</span>},</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_14">  14</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_14"></span><span class="anchor" id="line-14-2"></span>	{<span class="String">&quot;</span><span class="String">rowx2</span><span class="String">&quot;</span>, <span class="ID">rowx2</span>, <span class="ID">METH_VARARGS</span>},</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_15">  15</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_15"></span><span class="anchor" id="line-15-2"></span>	{<span class="String">&quot;</span><span class="String">rowx2_v2</span><span class="String">&quot;</span>, <span class="ID">rowx2_v2</span>, <span class="ID">METH_VARARGS</span>},</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_16">  16</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_16"></span><span class="anchor" id="line-16-2"></span>	{<span class="String">&quot;</span><span class="String">matsq</span><span class="String">&quot;</span>, <span class="ID">matsq</span>, <span class="ID">METH_VARARGS</span>},</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_17">  17</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_17"></span><span class="anchor" id="line-17-2"></span>	{<span class="String">&quot;</span><span class="String">contigmat</span><span class="String">&quot;</span>, <span class="ID">contigmat</span>, <span class="ID">METH_VARARGS</span>},</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_18">  18</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_18"></span><span class="anchor" id="line-18-2"></span>	{<span class="String">&quot;</span><span class="String">intfcn1</span><span class="String">&quot;</span>, <span class="ID">intfcn1</span>, <span class="ID">METH_VARARGS</span>},</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_19">  19</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_19"></span><span class="anchor" id="line-19-2"></span>	{<span class="ResWord">NULL</span>, <span class="ResWord">NULL</span>}     <span class="Comment">/* Sentinel - marks the end of this structure */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_20">  20</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_20"></span><span class="anchor" id="line-20-2"></span>};</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_21">  21</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_21"></span><span class="anchor" id="line-21-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_22">  22</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_22"></span><span class="anchor" id="line-22-2"></span><span class="Comment">/* ==== Initialize the C_test functions ====================== */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_23">  23</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_23"></span><span class="anchor" id="line-23-2"></span><span class="Comment">// Module name must be _C_arraytest in compile and linked </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_24">  24</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_24"></span><span class="anchor" id="line-24-2"></span><span class="Comment"></span><span class="ResWord">void</span> <span class="ID">init_C_arraytest</span>()  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_25">  25</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_25"></span><span class="anchor" id="line-25-2"></span>	(<span class="ResWord">void</span>) <span class="ID">Py_InitModule</span>(<span class="String">&quot;</span><span class="String">_C_arraytest</span><span class="String">&quot;</span>, <span class="ID">_C_arraytestMethods</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_26">  26</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_26"></span><span class="anchor" id="line-26-2"></span>	<span class="ID">import_array</span>();  <span class="Comment">// Must be present for NumPy.  Called first after above line.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_27">  27</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_27"></span><span class="anchor" id="line-27-2"></span><span class="Comment"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_28">  28</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_28"></span><span class="anchor" id="line-28-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_29">  29</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_29"></span><span class="anchor" id="line-29-2"></span><span class="Comment">/* #### Vector Extensions ############################## */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_30">  30</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_30"></span><span class="anchor" id="line-30-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_31">  31</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_31"></span><span class="anchor" id="line-31-2"></span><span class="Comment">/* ==== vector function - manipulate vector in place ======================</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_32">  32</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_32"></span><span class="anchor" id="line-32-2"></span><span class="Comment">    Multiply the input by 2 x dfac and put in output</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_33">  33</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_33"></span><span class="anchor" id="line-33-2"></span><span class="Comment">    Interface:  vecfcn1(vec1, vec2, str1, d1)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_34">  34</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_34"></span><span class="anchor" id="line-34-2"></span><span class="Comment">                vec1, vec2 are NumPy vectors, </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_35">  35</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_35"></span><span class="anchor" id="line-35-2"></span><span class="Comment">                str1 is Python string, d1 is Python float (double)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_36">  36</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_36"></span><span class="anchor" id="line-36-2"></span><span class="Comment">                Returns integer 1 if successful                */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_37">  37</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_37"></span><span class="anchor" id="line-37-1"></span><span class="ResWord">static</span> <span class="ID">PyObject</span> *<span class="ID">vecfcn1</span>(<span class="ID">PyObject</span> *<span class="ID">self</span>, <span class="ID">PyObject</span> *<span class="ID">args</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_38">  38</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_38"></span><span class="anchor" id="line-38-1"></span>{</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_39">  39</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_39"></span><span class="anchor" id="line-39-1"></span>	<span class="ID">PyArrayObject</span> *<span class="ID">vecin</span>, *<span class="ID">vecout</span>;  <span class="Comment">// The python objects to be extracted from the args</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_40">  40</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_40"></span><span class="anchor" id="line-40-1"></span><span class="Comment"></span>	<span class="ResWord">double</span> *<span class="ID">cin</span>, *<span class="ID">cout</span>;             <span class="Comment">// The C vectors to be created to point to the </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_41">  41</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_41"></span><span class="anchor" id="line-41-1"></span><span class="Comment"></span>	                                <span class="Comment">//   python vectors, cin and cout point to the row</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_42">  42</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_42"></span><span class="anchor" id="line-42-1"></span><span class="Comment"></span>	                                <span class="Comment">//   of vecin and vecout, respectively</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_43">  43</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_43"></span><span class="anchor" id="line-43-1"></span><span class="Comment"></span>	<span class="ResWord">int</span> <span class="ID">i</span>,<span class="ID">j</span>,<span class="ID">n</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_44">  44</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_44"></span><span class="anchor" id="line-44-1"></span>	<span class="ResWord">const</span> <span class="ResWord">char</span> *<span class="ID">str</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_45">  45</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_45"></span><span class="anchor" id="line-45-1"></span>	<span class="ResWord">double</span> <span class="ID">dfac</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_46">  46</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_46"></span><span class="anchor" id="line-46-1"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_47">  47</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_47"></span><span class="anchor" id="line-47-1"></span>	<span class="Comment">/* Parse tuples separately since args will differ between C fcns */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_48">  48</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_48"></span><span class="anchor" id="line-48-1"></span>	<span class="ResWord">if</span> (!<span class="ID">PyArg_ParseTuple</span>(<span class="ID">args</span>, <span class="String">&quot;</span><span class="String">O!O!sd</span><span class="String">&quot;</span>, &amp;<span class="ID">PyArray_Type</span>, &amp;<span class="ID">vecin</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_49">  49</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_49"></span><span class="anchor" id="line-49-1"></span>		&amp;<span class="ID">PyArray_Type</span>, &amp;<span class="ID">vecout</span>, &amp;<span class="ID">str</span>, &amp;<span class="ID">dfac</span>))  <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_50">  50</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_50"></span><span class="anchor" id="line-50-1"></span>	<span class="ResWord">if</span> (<span class="ResWord">NULL</span> == <span class="ID">vecin</span>)  <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_51">  51</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_51"></span><span class="anchor" id="line-51-1"></span>	<span class="ResWord">if</span> (<span class="ResWord">NULL</span> == <span class="ID">vecout</span>)  <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_52">  52</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_52"></span><span class="anchor" id="line-52-1"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_53">  53</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_53"></span><span class="anchor" id="line-53-1"></span>	<span class="Comment">// Print out input string</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_54">  54</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_54"></span><span class="anchor" id="line-54-1"></span><span class="Comment"></span>	<span class="ID">printf</span>(<span class="String">&quot;</span><span class="String">Input string: %s</span><span class="SPChar">\n</span><span class="String">&quot;</span>, <span class="ID">str</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_55">  55</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_55"></span><span class="anchor" id="line-55-1"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_56">  56</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_56"></span><span class="anchor" id="line-56-1"></span>	<span class="Comment">/* Check that objects are 'double' type and vectors</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_57">  57</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_57"></span><span class="anchor" id="line-57-1"></span><span class="Comment">	     Not needed if python wrapper function checks before call to this routine */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_58">  58</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_58"></span><span class="anchor" id="line-58-1"></span>	<span class="ResWord">if</span> (<span class="ID">not_doublevector</span>(<span class="ID">vecin</span>)) <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_59">  59</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_59"></span><span class="anchor" id="line-59-1"></span>	<span class="ResWord">if</span> (<span class="ID">not_doublevector</span>(<span class="ID">vecout</span>)) <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_60">  60</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_60"></span><span class="anchor" id="line-60-1"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_61">  61</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_61"></span><span class="anchor" id="line-61-1"></span>	<span class="Comment">/* Change contiguous arrays into C * arrays   */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_62">  62</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_62"></span><span class="anchor" id="line-62-1"></span>	<span class="ID">cin</span>=<span class="ID">pyvector_to_Carrayptrs</span>(<span class="ID">vecin</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_63">  63</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_63"></span><span class="anchor" id="line-63-1"></span>	<span class="ID">cout</span>=<span class="ID">pyvector_to_Carrayptrs</span>(<span class="ID">vecout</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_64">  64</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_64"></span><span class="anchor" id="line-64-1"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_65">  65</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_65"></span><span class="anchor" id="line-65-1"></span>	<span class="Comment">/* Get vector dimension. */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_66">  66</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_66"></span><span class="anchor" id="line-66-1"></span>	<span class="ID">n</span>=<span class="ID">vecin</span>-&gt;<span class="ID">dimensions</span>[<span class="Number">0</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_67">  67</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_67"></span><span class="anchor" id="line-67-1"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_68">  68</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_68"></span><span class="anchor" id="line-68-1"></span>	<span class="Comment">/* Operate on the vectors  */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_69">  69</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_69"></span><span class="anchor" id="line-69-1"></span>	<span class="ResWord">for</span> ( <span class="ID">i</span>=<span class="Number">0</span>; <span class="ID">i</span>&lt;<span class="ID">n</span>; <span class="ID">i</span>++)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_70">  70</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_70"></span><span class="anchor" id="line-70-1"></span>			<span class="ID">cout</span>[<span class="ID">i</span>]=<span class="Number">2.0</span>*<span class="ID">dfac</span>*<span class="ID">cin</span>[<span class="ID">i</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_71">  71</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_71"></span><span class="anchor" id="line-71-1"></span>	}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_72">  72</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_72"></span><span class="anchor" id="line-72-1"></span>		</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_73">  73</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_73"></span><span class="anchor" id="line-73-1"></span>	<span class="ResWord">return</span> <span class="ID">Py_BuildValue</span>(<span class="String">&quot;</span><span class="String">i</span><span class="String">&quot;</span>, <span class="Number">1</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_74">  74</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_74"></span><span class="anchor" id="line-74-1"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_75">  75</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_75"></span><span class="anchor" id="line-75-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_76">  76</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_76"></span><span class="anchor" id="line-76-1"></span><span class="Comment">/* ==== Square vector components &amp; multiply by a float =========================</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_77">  77</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_77"></span><span class="anchor" id="line-77-1"></span><span class="Comment">    Returns a NEW  NumPy vector array</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_78">  78</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_78"></span><span class="anchor" id="line-78-1"></span><span class="Comment">    interface:  vecsq(vec1, x1)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_79">  79</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_79"></span><span class="anchor" id="line-79-1"></span><span class="Comment">                vec1 is NumPy vector, x1 is Python float (double)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_80">  80</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_80"></span><span class="anchor" id="line-80-1"></span><span class="Comment">                returns a NumPy vector                                        */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_81">  81</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_81"></span><span class="anchor" id="line-81-1"></span><span class="ResWord">static</span> <span class="ID">PyObject</span> *<span class="ID">vecsq</span>(<span class="ID">PyObject</span> *<span class="ID">self</span>, <span class="ID">PyObject</span> *<span class="ID">args</span>)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_82">  82</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_82"></span><span class="anchor" id="line-82-1"></span>	<span class="ID">PyArrayObject</span> *<span class="ID">vecin</span>, *<span class="ID">vecout</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_83">  83</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_83"></span><span class="anchor" id="line-83-1"></span>	<span class="ResWord">double</span> *<span class="ID">cin</span>, *<span class="ID">cout</span>, <span class="ID">dfactor</span>;   <span class="Comment">// The C vectors to be created to point to the </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_84">  84</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_84"></span><span class="anchor" id="line-84-1"></span><span class="Comment"></span>	                               <span class="Comment">//   python vectors, cin and cout point to the row</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_85">  85</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_85"></span><span class="anchor" id="line-85-1"></span><span class="Comment"></span>	                               <span class="Comment">//   of vecin and vecout, respectively</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_86">  86</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_86"></span><span class="anchor" id="line-86-1"></span><span class="Comment"></span>	<span class="ResWord">int</span> <span class="ID">i</span>,<span class="ID">j</span>,<span class="ID">n</span>,<span class="ID">m</span>, <span class="ID">dims</span>[<span class="Number">2</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_87">  87</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_87"></span><span class="anchor" id="line-87-1"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_88">  88</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_88"></span><span class="anchor" id="line-88-1"></span>	<span class="Comment">/* Parse tuples separately since args will differ between C fcns */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_89">  89</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_89"></span><span class="anchor" id="line-89-1"></span>	<span class="ResWord">if</span> (!<span class="ID">PyArg_ParseTuple</span>(<span class="ID">args</span>, <span class="String">&quot;</span><span class="String">O!d</span><span class="String">&quot;</span>, </span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_90">  90</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_90"></span><span class="anchor" id="line-90-1"></span>		&amp;<span class="ID">PyArray_Type</span>, &amp;<span class="ID">vecin</span>, &amp;<span class="ID">dfactor</span>))  <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_91">  91</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_91"></span><span class="anchor" id="line-91-1"></span>	<span class="ResWord">if</span> (<span class="ResWord">NULL</span> == <span class="ID">vecin</span>)  <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_92">  92</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_92"></span><span class="anchor" id="line-92-1"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_93">  93</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_93"></span><span class="anchor" id="line-93-1"></span>	<span class="Comment">/* Check that object input is 'double' type and a vector</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_94">  94</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_94"></span><span class="anchor" id="line-94-1"></span><span class="Comment">	   Not needed if python wrapper function checks before call to this routine */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_95">  95</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_95"></span><span class="anchor" id="line-95-1"></span>	<span class="ResWord">if</span> (<span class="ID">not_doublevector</span>(<span class="ID">vecin</span>)) <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_96">  96</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_96"></span><span class="anchor" id="line-96"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_97">  97</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_97"></span><span class="anchor" id="line-97"></span>	<span class="Comment">/* Get the dimension of the input */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_98">  98</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_98"></span><span class="anchor" id="line-98"></span>	<span class="ID">n</span>=<span class="ID">dims</span>[<span class="Number">0</span>]=<span class="ID">vecin</span>-&gt;<span class="ID">dimensions</span>[<span class="Number">0</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_99">  99</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_99"></span><span class="anchor" id="line-99"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_100"> 100</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_100"></span><span class="anchor" id="line-100"></span>	<span class="Comment">/* Make a new double vector of same dimension */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_101"> 101</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_101"></span><span class="anchor" id="line-101"></span>	<span class="ID">vecout</span>=(<span class="ID">PyArrayObject</span> *) <span class="ID">PyArray_FromDims</span>(<span class="Number">1</span>,<span class="ID">dims</span>,<span class="ID">NPY_DOUBLE</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_102"> 102</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_102"></span><span class="anchor" id="line-102"></span>		</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_103"> 103</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_103"></span><span class="anchor" id="line-103"></span>	<span class="Comment">/* Change contiguous arrays into C *arrays   */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_104"> 104</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_104"></span><span class="anchor" id="line-104"></span>	<span class="ID">cin</span>=<span class="ID">pyvector_to_Carrayptrs</span>(<span class="ID">vecin</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_105"> 105</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_105"></span><span class="anchor" id="line-105"></span>	<span class="ID">cout</span>=<span class="ID">pyvector_to_Carrayptrs</span>(<span class="ID">vecout</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_106"> 106</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_106"></span><span class="anchor" id="line-106"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_107"> 107</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_107"></span><span class="anchor" id="line-107"></span>	<span class="Comment">/* Do the calculation. */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_108"> 108</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_108"></span><span class="anchor" id="line-108"></span>	<span class="ResWord">for</span> ( <span class="ID">i</span>=<span class="Number">0</span>; <span class="ID">i</span>&lt;<span class="ID">n</span>; <span class="ID">i</span>++)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_109"> 109</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_109"></span><span class="anchor" id="line-109"></span>			<span class="ID">cout</span>[<span class="ID">i</span>]= <span class="ID">dfactor</span>*<span class="ID">cin</span>[<span class="ID">i</span>]*<span class="ID">cin</span>[<span class="ID">i</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_110"> 110</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_110"></span><span class="anchor" id="line-110"></span>	}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_111"> 111</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_111"></span><span class="anchor" id="line-111"></span>		</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_112"> 112</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_112"></span><span class="anchor" id="line-112"></span>	<span class="ResWord">return</span> <span class="ID">PyArray_Return</span>(<span class="ID">vecout</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_113"> 113</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_113"></span><span class="anchor" id="line-113"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_114"> 114</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_114"></span><span class="anchor" id="line-114"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_115"> 115</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_115"></span><span class="anchor" id="line-115"></span><span class="Comment">/* #### Vector Utility functions ######################### */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_116"> 116</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_116"></span><span class="anchor" id="line-116"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_117"> 117</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_117"></span><span class="anchor" id="line-117"></span><span class="Comment">/* ==== Make a Python Array Obj. from a PyObject, ================</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_118"> 118</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_118"></span><span class="anchor" id="line-118"></span><span class="Comment">     generates a double vector w/ contiguous memory which may be a new allocation if</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_119"> 119</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_119"></span><span class="anchor" id="line-119"></span><span class="Comment">     the original was not a double type or contiguous </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_120"> 120</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_120"></span><span class="anchor" id="line-120"></span><span class="Comment">  !! Must DECREF the object returned from this routine unless it is returned to the</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_121"> 121</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_121"></span><span class="anchor" id="line-121"></span><span class="Comment">     caller of this routines caller using return PyArray_Return(obj) or</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_122"> 122</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_122"></span><span class="anchor" id="line-122"></span><span class="Comment">     PyArray_BuildValue with the &quot;N&quot; construct   !!!</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_123"> 123</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_123"></span><span class="anchor" id="line-123"></span><span class="Comment">*/</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_124"> 124</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_124"></span><span class="anchor" id="line-124"></span><span class="ID">PyArrayObject</span> *<span class="ID">pyvector</span>(<span class="ID">PyObject</span> *<span class="ID">objin</span>)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_125"> 125</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_125"></span><span class="anchor" id="line-125"></span>	<span class="ResWord">return</span> (<span class="ID">PyArrayObject</span> *) <span class="ID">PyArray_ContiguousFromObject</span>(<span class="ID">objin</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_126"> 126</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_126"></span><span class="anchor" id="line-126"></span>		<span class="ID">NPY_DOUBLE</span>, <span class="Number">1</span>,<span class="Number">1</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_127"> 127</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_127"></span><span class="anchor" id="line-127"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_128"> 128</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_128"></span><span class="anchor" id="line-128"></span><span class="Comment">/* ==== Create 1D Carray from PyArray ======================</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_129"> 129</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_129"></span><span class="anchor" id="line-129"></span><span class="Comment">    Assumes PyArray is contiguous in memory.             */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_130"> 130</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_130"></span><span class="anchor" id="line-130"></span><span class="ResWord">double</span> *<span class="ID">pyvector_to_Carrayptrs</span>(<span class="ID">PyArrayObject</span> *<span class="ID">arrayin</span>)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_131"> 131</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_131"></span><span class="anchor" id="line-131"></span>	<span class="ResWord">int</span> <span class="ID">i</span>,<span class="ID">n</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_132"> 132</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_132"></span><span class="anchor" id="line-132"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_133"> 133</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_133"></span><span class="anchor" id="line-133"></span>	<span class="ID">n</span>=<span class="ID">arrayin</span>-&gt;<span class="ID">dimensions</span>[<span class="Number">0</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_134"> 134</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_134"></span><span class="anchor" id="line-134"></span>	<span class="ResWord">return</span> (<span class="ResWord">double</span> *) <span class="ID">arrayin</span>-&gt;<span class="ID">data</span>;  <span class="Comment">/* pointer to arrayin data as double */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_135"> 135</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_135"></span><span class="anchor" id="line-135"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_136"> 136</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_136"></span><span class="anchor" id="line-136"></span><span class="Comment">/* ==== Check that PyArrayObject is a double (Float) type and a vector ==============</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_137"> 137</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_137"></span><span class="anchor" id="line-137"></span><span class="Comment">    return 1 if an error and raise exception */</span> </span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_138"> 138</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_138"></span><span class="anchor" id="line-138"></span><span class="ResWord">int</span>  <span class="ID">not_doublevector</span>(<span class="ID">PyArrayObject</span> *<span class="ID">vec</span>)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_139"> 139</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_139"></span><span class="anchor" id="line-139"></span>	<span class="ResWord">if</span> (<span class="ID">vec</span>-&gt;<span class="ID">descr</span>-&gt;<span class="ID">type_num</span> != <span class="ID">NPY_DOUBLE</span> || <span class="ID">vec</span>-&gt;<span class="ID">nd</span> != <span class="Number">1</span>)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_140"> 140</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_140"></span><span class="anchor" id="line-140"></span>		<span class="ID">PyErr_SetString</span>(<span class="ID">PyExc_ValueError</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_141"> 141</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_141"></span><span class="anchor" id="line-141"></span>			<span class="String">&quot;</span><span class="String">In not_doublevector: array must be of type Float and 1 dimensional (n).</span><span class="String">&quot;</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_142"> 142</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_142"></span><span class="anchor" id="line-142"></span>		<span class="ResWord">return</span> <span class="Number">1</span>;  }</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_143"> 143</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_143"></span><span class="anchor" id="line-143"></span>	<span class="ResWord">return</span> <span class="Number">0</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_144"> 144</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_144"></span><span class="anchor" id="line-144"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_145"> 145</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_145"></span><span class="anchor" id="line-145"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_146"> 146</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_146"></span><span class="anchor" id="line-146"></span><span class="Comment">/* #### Matrix Extensions ############################## */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_147"> 147</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_147"></span><span class="anchor" id="line-147"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_148"> 148</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_148"></span><span class="anchor" id="line-148"></span><span class="Comment">/* ==== Row x 2 function - manipulate matrix in place ======================</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_149"> 149</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_149"></span><span class="anchor" id="line-149"></span><span class="Comment">    Multiply the 2nd row of the input by 2 and put in output</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_150"> 150</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_150"></span><span class="anchor" id="line-150"></span><span class="Comment">    interface:  rowx2(mat1, mat2)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_151"> 151</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_151"></span><span class="anchor" id="line-151"></span><span class="Comment">                mat1 and mat2 are NumPy matrices</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_152"> 152</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_152"></span><span class="anchor" id="line-152"></span><span class="Comment">                Returns integer 1 if successful                        */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_153"> 153</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_153"></span><span class="anchor" id="line-153"></span><span class="ResWord">static</span> <span class="ID">PyObject</span> *<span class="ID">rowx2</span>(<span class="ID">PyObject</span> *<span class="ID">self</span>, <span class="ID">PyObject</span> *<span class="ID">args</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_154"> 154</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_154"></span><span class="anchor" id="line-154"></span>{</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_155"> 155</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_155"></span><span class="anchor" id="line-155"></span>	<span class="ID">PyArrayObject</span> *<span class="ID">matin</span>, *<span class="ID">matout</span>;  <span class="Comment">// The python objects to be extracted from the args</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_156"> 156</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_156"></span><span class="anchor" id="line-156"></span><span class="Comment"></span>	<span class="ResWord">double</span> **<span class="ID">cin</span>, **<span class="ID">cout</span>;           <span class="Comment">// The C matrices to be created to point to the </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_157"> 157</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_157"></span><span class="anchor" id="line-157"></span><span class="Comment"></span>	                                <span class="Comment">//   python matrices, cin and cout point to the rows</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_158"> 158</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_158"></span><span class="anchor" id="line-158"></span><span class="Comment"></span>	                                <span class="Comment">//   of matin and matout, respectively</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_159"> 159</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_159"></span><span class="anchor" id="line-159"></span><span class="Comment"></span>	<span class="ResWord">int</span> <span class="ID">i</span>,<span class="ID">j</span>,<span class="ID">n</span>,<span class="ID">m</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_160"> 160</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_160"></span><span class="anchor" id="line-160"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_161"> 161</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_161"></span><span class="anchor" id="line-161"></span>	<span class="Comment">/* Parse tuples separately since args will differ between C fcns */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_162"> 162</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_162"></span><span class="anchor" id="line-162"></span>	<span class="ResWord">if</span> (!<span class="ID">PyArg_ParseTuple</span>(<span class="ID">args</span>, <span class="String">&quot;</span><span class="String">O!O!</span><span class="String">&quot;</span>, &amp;<span class="ID">PyArray_Type</span>, &amp;<span class="ID">matin</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_163"> 163</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_163"></span><span class="anchor" id="line-163"></span>		&amp;<span class="ID">PyArray_Type</span>, &amp;<span class="ID">matout</span>))  <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_164"> 164</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_164"></span><span class="anchor" id="line-164"></span>	<span class="ResWord">if</span> (<span class="ResWord">NULL</span> == <span class="ID">matin</span>)  <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_165"> 165</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_165"></span><span class="anchor" id="line-165"></span>	<span class="ResWord">if</span> (<span class="ResWord">NULL</span> == <span class="ID">matout</span>)  <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_166"> 166</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_166"></span><span class="anchor" id="line-166"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_167"> 167</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_167"></span><span class="anchor" id="line-167"></span>	<span class="Comment">/* Check that objects are 'double' type and matrices</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_168"> 168</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_168"></span><span class="anchor" id="line-168"></span><span class="Comment">	     Not needed if python wrapper function checks before call to this routine */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_169"> 169</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_169"></span><span class="anchor" id="line-169"></span>	<span class="ResWord">if</span> (<span class="ID">not_doublematrix</span>(<span class="ID">matin</span>)) <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_170"> 170</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_170"></span><span class="anchor" id="line-170"></span>	<span class="ResWord">if</span> (<span class="ID">not_doublematrix</span>(<span class="ID">matout</span>)) <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_171"> 171</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_171"></span><span class="anchor" id="line-171"></span>		</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_172"> 172</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_172"></span><span class="anchor" id="line-172"></span>	<span class="Comment">/* Change contiguous arrays into C ** arrays (Memory is Allocated!) */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_173"> 173</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_173"></span><span class="anchor" id="line-173"></span>	<span class="ID">cin</span>=<span class="ID">pymatrix_to_Carrayptrs</span>(<span class="ID">matin</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_174"> 174</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_174"></span><span class="anchor" id="line-174"></span>	<span class="ID">cout</span>=<span class="ID">pymatrix_to_Carrayptrs</span>(<span class="ID">matout</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_175"> 175</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_175"></span><span class="anchor" id="line-175"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_176"> 176</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_176"></span><span class="anchor" id="line-176"></span>	<span class="Comment">/* Get matrix dimensions. */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_177"> 177</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_177"></span><span class="anchor" id="line-177"></span>	<span class="ID">n</span>=<span class="ID">matin</span>-&gt;<span class="ID">dimensions</span>[<span class="Number">0</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_178"> 178</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_178"></span><span class="anchor" id="line-178"></span>	<span class="ID">m</span>=<span class="ID">matin</span>-&gt;<span class="ID">dimensions</span>[<span class="Number">1</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_179"> 179</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_179"></span><span class="anchor" id="line-179"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_180"> 180</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_180"></span><span class="anchor" id="line-180"></span>	<span class="Comment">/* Operate on the matrices  */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_181"> 181</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_181"></span><span class="anchor" id="line-181"></span>	<span class="ResWord">for</span> ( <span class="ID">i</span>=<span class="Number">0</span>; <span class="ID">i</span>&lt;<span class="ID">n</span>; <span class="ID">i</span>++)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_182"> 182</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_182"></span><span class="anchor" id="line-182"></span>		<span class="ResWord">for</span> ( <span class="ID">j</span>=<span class="Number">0</span>; <span class="ID">j</span>&lt;<span class="ID">m</span>; <span class="ID">j</span>++)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_183"> 183</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_183"></span><span class="anchor" id="line-183"></span>			<span class="ResWord">if</span> (<span class="ID">i</span>==<span class="Number">1</span>) <span class="ID">cout</span>[<span class="ID">i</span>][<span class="ID">j</span>]=<span class="Number">2.0</span>*<span class="ID">cin</span>[<span class="ID">i</span>][<span class="ID">j</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_184"> 184</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_184"></span><span class="anchor" id="line-184"></span>	}  }</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_185"> 185</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_185"></span><span class="anchor" id="line-185"></span>		</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_186"> 186</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_186"></span><span class="anchor" id="line-186"></span>	<span class="Comment">/* Free memory, close file and return */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_187"> 187</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_187"></span><span class="anchor" id="line-187"></span>	<span class="ID">free_Carrayptrs</span>(<span class="ID">cin</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_188"> 188</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_188"></span><span class="anchor" id="line-188"></span>	<span class="ID">free_Carrayptrs</span>(<span class="ID">cout</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_189"> 189</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_189"></span><span class="anchor" id="line-189"></span>	<span class="ResWord">return</span> <span class="ID">Py_BuildValue</span>(<span class="String">&quot;</span><span class="String">i</span><span class="String">&quot;</span>, <span class="Number">1</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_190"> 190</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_190"></span><span class="anchor" id="line-190"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_191"> 191</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_191"></span><span class="anchor" id="line-191"></span><span class="Comment">/* ==== Row x 2 function- Version 2. - manipulate matrix in place ======================</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_192"> 192</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_192"></span><span class="anchor" id="line-192"></span><span class="Comment">    Multiply the 2nd row of the input by 2 and put in output</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_193"> 193</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_193"></span><span class="anchor" id="line-193"></span><span class="Comment">    interface:  rowx2(mat1, mat2)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_194"> 194</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_194"></span><span class="anchor" id="line-194"></span><span class="Comment">                mat1 and mat2 are NumPy matrices</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_195"> 195</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_195"></span><span class="anchor" id="line-195"></span><span class="Comment">                Returns integer 1 if successful</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_196"> 196</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_196"></span><span class="anchor" id="line-196"></span><span class="Comment">    Uses the utility function pymatrix to make NumPy C objects from PyObjects</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_197"> 197</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_197"></span><span class="anchor" id="line-197"></span><span class="Comment">*/</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_198"> 198</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_198"></span><span class="anchor" id="line-198"></span><span class="ResWord">static</span> <span class="ID">PyObject</span> *<span class="ID">rowx2_v2</span>(<span class="ID">PyObject</span> *<span class="ID">self</span>, <span class="ID">PyObject</span> *<span class="ID">args</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_199"> 199</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_199"></span><span class="anchor" id="line-199"></span>{</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_200"> 200</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_200"></span><span class="anchor" id="line-200"></span>	<span class="ID">PyObject</span> *<span class="ID">Pymatin</span>, *<span class="ID">Pymatout</span>;   <span class="Comment">// The python objects to be extracted from the args</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_201"> 201</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_201"></span><span class="anchor" id="line-201"></span><span class="Comment"></span>	<span class="ID">PyArrayObject</span> *<span class="ID">matin</span>, *<span class="ID">matout</span>;  <span class="Comment">// The python array objects to be extracted from python objects</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_202"> 202</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_202"></span><span class="anchor" id="line-202"></span><span class="Comment"></span>	<span class="ResWord">double</span> **<span class="ID">cin</span>, **<span class="ID">cout</span>;           <span class="Comment">// The C matrices to be created to point to the </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_203"> 203</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_203"></span><span class="anchor" id="line-203"></span><span class="Comment"></span>	                                <span class="Comment">//   python matrices, cin and cout point to the rows</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_204"> 204</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_204"></span><span class="anchor" id="line-204"></span><span class="Comment"></span>	                                <span class="Comment">//   of matin and matout, respectively</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_205"> 205</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_205"></span><span class="anchor" id="line-205"></span><span class="Comment"></span>	<span class="ResWord">int</span> <span class="ID">i</span>,<span class="ID">j</span>,<span class="ID">n</span>,<span class="ID">m</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_206"> 206</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_206"></span><span class="anchor" id="line-206"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_207"> 207</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_207"></span><span class="anchor" id="line-207"></span>	<span class="Comment">/* Parse tuples separately since args will differ between C fcns */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_208"> 208</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_208"></span><span class="anchor" id="line-208"></span>	<span class="ResWord">if</span> (!<span class="ID">PyArg_ParseTuple</span>(<span class="ID">args</span>, <span class="String">&quot;</span><span class="String">OO</span><span class="String">&quot;</span>, &amp;<span class="ID">Pymatin</span>, &amp;<span class="ID">Pymatout</span>))  <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_209"> 209</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_209"></span><span class="anchor" id="line-209"></span>	<span class="ResWord">if</span> (<span class="ResWord">NULL</span> == <span class="ID">Pymatin</span>)  <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_210"> 210</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_210"></span><span class="anchor" id="line-210"></span>	<span class="ResWord">if</span> (<span class="ResWord">NULL</span> == <span class="ID">Pymatout</span>)  <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_211"> 211</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_211"></span><span class="anchor" id="line-211"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_212"> 212</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_212"></span><span class="anchor" id="line-212"></span>	<span class="Comment">/* Convert Python Objects to Python Array Objects */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_213"> 213</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_213"></span><span class="anchor" id="line-213"></span>	<span class="ID">matin</span>= <span class="ID">pymatrix</span>(<span class="ID">Pymatin</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_214"> 214</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_214"></span><span class="anchor" id="line-214"></span>	<span class="ID">matout</span>= <span class="ID">pymatrix</span>(<span class="ID">Pymatout</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_215"> 215</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_215"></span><span class="anchor" id="line-215"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_216"> 216</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_216"></span><span class="anchor" id="line-216"></span>	<span class="Comment">/* Check that objects are 'double' type and matrices</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_217"> 217</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_217"></span><span class="anchor" id="line-217"></span><span class="Comment">	     Not needed if python wrapper function checks before call to this routine */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_218"> 218</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_218"></span><span class="anchor" id="line-218"></span>	<span class="ResWord">if</span> (<span class="ID">not_doublematrix</span>(<span class="ID">matin</span>)) <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_219"> 219</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_219"></span><span class="anchor" id="line-219"></span>	<span class="ResWord">if</span> (<span class="ID">not_doublematrix</span>(<span class="ID">matout</span>)) <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_220"> 220</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_220"></span><span class="anchor" id="line-220"></span>		</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_221"> 221</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_221"></span><span class="anchor" id="line-221"></span>	<span class="Comment">/* Change contiguous arrays into C ** arrays (Memory is Allocated!) */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_222"> 222</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_222"></span><span class="anchor" id="line-222"></span>	<span class="ID">cin</span>=<span class="ID">pymatrix_to_Carrayptrs</span>(<span class="ID">matin</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_223"> 223</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_223"></span><span class="anchor" id="line-223"></span>	<span class="ID">cout</span>=<span class="ID">pymatrix_to_Carrayptrs</span>(<span class="ID">matout</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_224"> 224</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_224"></span><span class="anchor" id="line-224"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_225"> 225</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_225"></span><span class="anchor" id="line-225"></span>	<span class="Comment">/* Get matrix dimensions. */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_226"> 226</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_226"></span><span class="anchor" id="line-226"></span>	<span class="ID">n</span>=<span class="ID">matin</span>-&gt;<span class="ID">dimensions</span>[<span class="Number">0</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_227"> 227</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_227"></span><span class="anchor" id="line-227"></span>	<span class="ID">m</span>=<span class="ID">matin</span>-&gt;<span class="ID">dimensions</span>[<span class="Number">1</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_228"> 228</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_228"></span><span class="anchor" id="line-228"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_229"> 229</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_229"></span><span class="anchor" id="line-229"></span>	<span class="Comment">/* Operate on the matrices  */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_230"> 230</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_230"></span><span class="anchor" id="line-230"></span>	<span class="ResWord">for</span> ( <span class="ID">i</span>=<span class="Number">0</span>; <span class="ID">i</span>&lt;<span class="ID">n</span>; <span class="ID">i</span>++)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_231"> 231</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_231"></span><span class="anchor" id="line-231"></span>		<span class="ResWord">for</span> ( <span class="ID">j</span>=<span class="Number">0</span>; <span class="ID">j</span>&lt;<span class="ID">m</span>; <span class="ID">j</span>++)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_232"> 232</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_232"></span><span class="anchor" id="line-232"></span>			<span class="ResWord">if</span> (<span class="ID">i</span>==<span class="Number">1</span>) <span class="ID">cout</span>[<span class="ID">i</span>][<span class="ID">j</span>]=<span class="Number">2.0</span>*<span class="ID">cin</span>[<span class="ID">i</span>][<span class="ID">j</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_233"> 233</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_233"></span><span class="anchor" id="line-233"></span>	}  }</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_234"> 234</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_234"></span><span class="anchor" id="line-234"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_235"> 235</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_235"></span><span class="anchor" id="line-235"></span>	<span class="Comment">/* Free memory, close file and return */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_236"> 236</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_236"></span><span class="anchor" id="line-236"></span>	<span class="ID">free_Carrayptrs</span>(<span class="ID">cin</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_237"> 237</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_237"></span><span class="anchor" id="line-237"></span>	<span class="ID">free_Carrayptrs</span>(<span class="ID">cout</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_238"> 238</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_238"></span><span class="anchor" id="line-238"></span>	<span class="ResWord">return</span> <span class="ID">Py_BuildValue</span>(<span class="String">&quot;</span><span class="String">i</span><span class="String">&quot;</span>, <span class="Number">1</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_239"> 239</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_239"></span><span class="anchor" id="line-239"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_240"> 240</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_240"></span><span class="anchor" id="line-240"></span><span class="Comment">/* ==== Square matrix components function &amp; multiply by int and float =========</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_241"> 241</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_241"></span><span class="anchor" id="line-241"></span><span class="Comment">    Returns a NEW NumPy array</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_242"> 242</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_242"></span><span class="anchor" id="line-242"></span><span class="Comment">    interface:  matsq(mat1, i1, d1)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_243"> 243</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_243"></span><span class="anchor" id="line-243"></span><span class="Comment">                mat1 is NumPy matrix, i1 is Python integer, d1 is Python float (double)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_244"> 244</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_244"></span><span class="anchor" id="line-244"></span><span class="Comment">                returns a NumPy matrix                                        */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_245"> 245</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_245"></span><span class="anchor" id="line-245"></span><span class="ResWord">static</span> <span class="ID">PyObject</span> *<span class="ID">matsq</span>(<span class="ID">PyObject</span> *<span class="ID">self</span>, <span class="ID">PyObject</span> *<span class="ID">args</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_246"> 246</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_246"></span><span class="anchor" id="line-246"></span>{</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_247"> 247</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_247"></span><span class="anchor" id="line-247"></span>	<span class="ID">PyArrayObject</span> *<span class="ID">matin</span>, *<span class="ID">matout</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_248"> 248</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_248"></span><span class="anchor" id="line-248"></span>	<span class="ResWord">double</span> **<span class="ID">cin</span>, **<span class="ID">cout</span>, <span class="ID">dfactor</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_249"> 249</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_249"></span><span class="anchor" id="line-249"></span>	<span class="ResWord">int</span> <span class="ID">i</span>,<span class="ID">j</span>,<span class="ID">n</span>,<span class="ID">m</span>, <span class="ID">dims</span>[<span class="Number">2</span>], <span class="ID">ifactor</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_250"> 250</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_250"></span><span class="anchor" id="line-250"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_251"> 251</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_251"></span><span class="anchor" id="line-251"></span>	<span class="Comment">/* Parse tuples separately since args will differ between C fcns */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_252"> 252</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_252"></span><span class="anchor" id="line-252"></span>	<span class="ResWord">if</span> (!<span class="ID">PyArg_ParseTuple</span>(<span class="ID">args</span>, <span class="String">&quot;</span><span class="String">O!id</span><span class="String">&quot;</span>, </span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_253"> 253</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_253"></span><span class="anchor" id="line-253"></span>		&amp;<span class="ID">PyArray_Type</span>, &amp;<span class="ID">matin</span>, &amp;<span class="ID">ifactor</span>, &amp;<span class="ID">dfactor</span>))  <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_254"> 254</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_254"></span><span class="anchor" id="line-254"></span>	<span class="ResWord">if</span> (<span class="ResWord">NULL</span> == <span class="ID">matin</span>)  <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_255"> 255</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_255"></span><span class="anchor" id="line-255"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_256"> 256</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_256"></span><span class="anchor" id="line-256"></span>	<span class="Comment">/* Check that object input is 'double' type and a matrix</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_257"> 257</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_257"></span><span class="anchor" id="line-257"></span><span class="Comment">	   Not needed if python wrapper function checks before call to this routine */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_258"> 258</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_258"></span><span class="anchor" id="line-258"></span>	<span class="ResWord">if</span> (<span class="ID">not_doublematrix</span>(<span class="ID">matin</span>)) <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_259"> 259</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_259"></span><span class="anchor" id="line-259"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_260"> 260</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_260"></span><span class="anchor" id="line-260"></span>	<span class="Comment">/* Get the dimensions of the input */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_261"> 261</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_261"></span><span class="anchor" id="line-261"></span>	<span class="ID">n</span>=<span class="ID">dims</span>[<span class="Number">0</span>]=<span class="ID">matin</span>-&gt;<span class="ID">dimensions</span>[<span class="Number">0</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_262"> 262</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_262"></span><span class="anchor" id="line-262"></span>	<span class="ID">m</span>=<span class="ID">dims</span>[<span class="Number">1</span>]=<span class="ID">matin</span>-&gt;<span class="ID">dimensions</span>[<span class="Number">1</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_263"> 263</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_263"></span><span class="anchor" id="line-263"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_264"> 264</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_264"></span><span class="anchor" id="line-264"></span>	<span class="Comment">/* Make a new double matrix of same dims */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_265"> 265</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_265"></span><span class="anchor" id="line-265"></span>	<span class="ID">matout</span>=(<span class="ID">PyArrayObject</span> *) <span class="ID">PyArray_FromDims</span>(<span class="Number">2</span>,<span class="ID">dims</span>,<span class="ID">NPY_DOUBLE</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_266"> 266</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_266"></span><span class="anchor" id="line-266"></span>		</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_267"> 267</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_267"></span><span class="anchor" id="line-267"></span>	<span class="Comment">/* Change contiguous arrays into C ** arrays (Memory is Allocated!) */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_268"> 268</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_268"></span><span class="anchor" id="line-268"></span>	<span class="ID">cin</span>=<span class="ID">pymatrix_to_Carrayptrs</span>(<span class="ID">matin</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_269"> 269</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_269"></span><span class="anchor" id="line-269"></span>	<span class="ID">cout</span>=<span class="ID">pymatrix_to_Carrayptrs</span>(<span class="ID">matout</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_270"> 270</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_270"></span><span class="anchor" id="line-270"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_271"> 271</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_271"></span><span class="anchor" id="line-271"></span>	<span class="Comment">/* Do the calculation. */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_272"> 272</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_272"></span><span class="anchor" id="line-272"></span>	<span class="ResWord">for</span> ( <span class="ID">i</span>=<span class="Number">0</span>; <span class="ID">i</span>&lt;<span class="ID">n</span>; <span class="ID">i</span>++)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_273"> 273</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_273"></span><span class="anchor" id="line-273"></span>		<span class="ResWord">for</span> ( <span class="ID">j</span>=<span class="Number">0</span>; <span class="ID">j</span>&lt;<span class="ID">m</span>; <span class="ID">j</span>++)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_274"> 274</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_274"></span><span class="anchor" id="line-274"></span>			<span class="ID">cout</span>[<span class="ID">i</span>][<span class="ID">j</span>]= <span class="ID">ifactor</span>*<span class="ID">dfactor</span>*<span class="ID">cin</span>[<span class="ID">i</span>][<span class="ID">j</span>]*<span class="ID">cin</span>[<span class="ID">i</span>][<span class="ID">j</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_275"> 275</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_275"></span><span class="anchor" id="line-275"></span>	}  }</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_276"> 276</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_276"></span><span class="anchor" id="line-276"></span>		</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_277"> 277</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_277"></span><span class="anchor" id="line-277"></span>	<span class="Comment">/* Free memory, close file and return */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_278"> 278</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_278"></span><span class="anchor" id="line-278"></span>	<span class="ID">free_Carrayptrs</span>(<span class="ID">cin</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_279"> 279</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_279"></span><span class="anchor" id="line-279"></span>	<span class="ID">free_Carrayptrs</span>(<span class="ID">cout</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_280"> 280</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_280"></span><span class="anchor" id="line-280"></span>	<span class="ResWord">return</span> <span class="ID">PyArray_Return</span>(<span class="ID">matout</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_281"> 281</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_281"></span><span class="anchor" id="line-281"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_282"> 282</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_282"></span><span class="anchor" id="line-282"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_283"> 283</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_283"></span><span class="anchor" id="line-283"></span><span class="Comment">/* ==== Operate on Matrix components as contiguous memory =========================</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_284"> 284</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_284"></span><span class="anchor" id="line-284"></span><span class="Comment">  Shows how to access the array data as a contiguous block of memory. Used, for example,</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_285"> 285</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_285"></span><span class="anchor" id="line-285"></span><span class="Comment">  in matrix classes implemented as contiquous memory rather than as n arrays of </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_286"> 286</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_286"></span><span class="anchor" id="line-286"></span><span class="Comment">  pointers to the data &quot;rows&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_287"> 287</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_287"></span><span class="anchor" id="line-287"></span><span class="Comment">  </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_288"> 288</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_288"></span><span class="anchor" id="line-288"></span><span class="Comment">    Returns a NEW NumPy array</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_289"> 289</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_289"></span><span class="anchor" id="line-289"></span><span class="Comment">    interface:  contigmat(mat1, x1)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_290"> 290</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_290"></span><span class="anchor" id="line-290"></span><span class="Comment">                mat1 is NumPy matrix, x1 is Python float (double)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_291"> 291</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_291"></span><span class="anchor" id="line-291"></span><span class="Comment">                returns a NumPy matrix                                        */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_292"> 292</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_292"></span><span class="anchor" id="line-292"></span><span class="ResWord">static</span> <span class="ID">PyObject</span> *<span class="ID">contigmat</span>(<span class="ID">PyObject</span> *<span class="ID">self</span>, <span class="ID">PyObject</span> *<span class="ID">args</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_293"> 293</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_293"></span><span class="anchor" id="line-293"></span>{</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_294"> 294</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_294"></span><span class="anchor" id="line-294"></span>	<span class="ID">PyArrayObject</span> *<span class="ID">matin</span>, *<span class="ID">matout</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_295"> 295</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_295"></span><span class="anchor" id="line-295"></span>	<span class="ResWord">double</span> *<span class="ID">cin</span>, *<span class="ID">cout</span>, <span class="ID">x1</span>;     <span class="Comment">// Pointers to the contiguous data in the matrices to</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_296"> 296</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_296"></span><span class="anchor" id="line-296"></span><span class="Comment"></span>	                            <span class="Comment">// be used by C (e.g. passed to a program that uses</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_297"> 297</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_297"></span><span class="anchor" id="line-297"></span><span class="Comment"></span>	                            <span class="Comment">// matrix classes implemented as contiquous memory rather</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_298"> 298</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_298"></span><span class="anchor" id="line-298"></span><span class="Comment"></span>	                            <span class="Comment">// than as n arrays of pointers to the data &quot;rows&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_299"> 299</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_299"></span><span class="anchor" id="line-299"></span><span class="Comment"></span>	<span class="ResWord">int</span> <span class="ID">i</span>,<span class="ID">j</span>,<span class="ID">n</span>,<span class="ID">m</span>, <span class="ID">dims</span>[<span class="Number">2</span>], <span class="ID">ncomps</span>;  <span class="Comment">// ncomps=n*m=total number of matrix components in mat1</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_300"> 300</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_300"></span><span class="anchor" id="line-300"></span><span class="Comment"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_301"> 301</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_301"></span><span class="anchor" id="line-301"></span>	<span class="Comment">/* Parse tuples separately since args will differ between C fcns */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_302"> 302</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_302"></span><span class="anchor" id="line-302"></span>	<span class="ResWord">if</span> (!<span class="ID">PyArg_ParseTuple</span>(<span class="ID">args</span>, <span class="String">&quot;</span><span class="String">O!d</span><span class="String">&quot;</span>, </span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_303"> 303</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_303"></span><span class="anchor" id="line-303"></span>		&amp;<span class="ID">PyArray_Type</span>, &amp;<span class="ID">matin</span>, &amp;<span class="ID">x1</span>))  <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_304"> 304</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_304"></span><span class="anchor" id="line-304"></span>	<span class="ResWord">if</span> (<span class="ResWord">NULL</span> == <span class="ID">matin</span>)  <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_305"> 305</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_305"></span><span class="anchor" id="line-305"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_306"> 306</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_306"></span><span class="anchor" id="line-306"></span>	<span class="Comment">/* Check that object input is 'double' type and a matrix</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_307"> 307</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_307"></span><span class="anchor" id="line-307"></span><span class="Comment">	   Not needed if python wrapper function checks before call to this routine */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_308"> 308</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_308"></span><span class="anchor" id="line-308"></span>	<span class="ResWord">if</span> (<span class="ID">not_doublematrix</span>(<span class="ID">matin</span>)) <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_309"> 309</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_309"></span><span class="anchor" id="line-309"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_310"> 310</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_310"></span><span class="anchor" id="line-310"></span>	<span class="Comment">/* Get the dimensions of the input */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_311"> 311</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_311"></span><span class="anchor" id="line-311"></span>	<span class="ID">n</span>=<span class="ID">dims</span>[<span class="Number">0</span>]=<span class="ID">matin</span>-&gt;<span class="ID">dimensions</span>[<span class="Number">0</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_312"> 312</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_312"></span><span class="anchor" id="line-312"></span>	<span class="ID">m</span>=<span class="ID">dims</span>[<span class="Number">1</span>]=<span class="ID">matin</span>-&gt;<span class="ID">dimensions</span>[<span class="Number">1</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_313"> 313</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_313"></span><span class="anchor" id="line-313"></span>	<span class="ID">ncomps</span>=<span class="ID">n</span>*<span class="ID">m</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_314"> 314</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_314"></span><span class="anchor" id="line-314"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_315"> 315</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_315"></span><span class="anchor" id="line-315"></span>	<span class="Comment">/* Make a new double matrix of same dims */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_316"> 316</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_316"></span><span class="anchor" id="line-316"></span>	<span class="ID">matout</span>=(<span class="ID">PyArrayObject</span> *) <span class="ID">PyArray_FromDims</span>(<span class="Number">2</span>,<span class="ID">dims</span>,<span class="ID">NPY_DOUBLE</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_317"> 317</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_317"></span><span class="anchor" id="line-317"></span>		</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_318"> 318</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_318"></span><span class="anchor" id="line-318"></span>	<span class="Comment">/* Change contiguous arrays into C * arrays pointers to PyArrayObject data */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_319"> 319</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_319"></span><span class="anchor" id="line-319"></span>	<span class="ID">cin</span>=<span class="ID">pyvector_to_Carrayptrs</span>(<span class="ID">matin</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_320"> 320</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_320"></span><span class="anchor" id="line-320"></span>	<span class="ID">cout</span>=<span class="ID">pyvector_to_Carrayptrs</span>(<span class="ID">matout</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_321"> 321</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_321"></span><span class="anchor" id="line-321"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_322"> 322</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_322"></span><span class="anchor" id="line-322"></span>	<span class="Comment">/* Do the calculation. */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_323"> 323</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_323"></span><span class="anchor" id="line-323"></span>	<span class="ID">printf</span>(<span class="String">&quot;</span><span class="String">In contigmat, cout (as contiguous memory) =</span><span class="SPChar">\n</span><span class="String">&quot;</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_324"> 324</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_324"></span><span class="anchor" id="line-324"></span>	<span class="ResWord">for</span> ( <span class="ID">i</span>=<span class="Number">0</span>; <span class="ID">i</span>&lt;<span class="ID">ncomps</span>; <span class="ID">i</span>++)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_325"> 325</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_325"></span><span class="anchor" id="line-325"></span>		<span class="ID">cout</span>[<span class="ID">i</span>]= <span class="ID">cin</span>[<span class="ID">i</span>]-<span class="ID">x1</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_326"> 326</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_326"></span><span class="anchor" id="line-326"></span>		<span class="ID">printf</span>(<span class="String">&quot;</span><span class="String">%e </span><span class="String">&quot;</span>,<span class="ID">cout</span>[<span class="ID">i</span>]);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_327"> 327</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_327"></span><span class="anchor" id="line-327"></span>	}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_328"> 328</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_328"></span><span class="anchor" id="line-328"></span>	<span class="ID">printf</span>(<span class="String">&quot;</span><span class="SPChar">\n</span><span class="String">&quot;</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_329"> 329</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_329"></span><span class="anchor" id="line-329"></span>		</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_330"> 330</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_330"></span><span class="anchor" id="line-330"></span>	<span class="ResWord">return</span> <span class="ID">PyArray_Return</span>(<span class="ID">matout</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_331"> 331</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_331"></span><span class="anchor" id="line-331"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_332"> 332</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_332"></span><span class="anchor" id="line-332"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_333"> 333</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_333"></span><span class="anchor" id="line-333"></span><span class="Comment">/* #### Matrix Utility functions ######################### */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_334"> 334</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_334"></span><span class="anchor" id="line-334"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_335"> 335</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_335"></span><span class="anchor" id="line-335"></span><span class="Comment">/* ==== Make a Python Array Obj. from a PyObject, ================</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_336"> 336</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_336"></span><span class="anchor" id="line-336"></span><span class="Comment">     generates a double matrix w/ contiguous memory which may be a new allocation if</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_337"> 337</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_337"></span><span class="anchor" id="line-337"></span><span class="Comment">     the original was not a double type or contiguous </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_338"> 338</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_338"></span><span class="anchor" id="line-338"></span><span class="Comment">  !! Must DECREF the object returned from this routine unless it is returned to the</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_339"> 339</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_339"></span><span class="anchor" id="line-339"></span><span class="Comment">     caller of this routines caller using return PyArray_Return(obj) or</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_340"> 340</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_340"></span><span class="anchor" id="line-340"></span><span class="Comment">     PyArray_BuildValue with the &quot;N&quot; construct   !!!</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_341"> 341</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_341"></span><span class="anchor" id="line-341"></span><span class="Comment">*/</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_342"> 342</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_342"></span><span class="anchor" id="line-342"></span><span class="ID">PyArrayObject</span> *<span class="ID">pymatrix</span>(<span class="ID">PyObject</span> *<span class="ID">objin</span>)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_343"> 343</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_343"></span><span class="anchor" id="line-343"></span>	<span class="ResWord">return</span> (<span class="ID">PyArrayObject</span> *) <span class="ID">PyArray_ContiguousFromObject</span>(<span class="ID">objin</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_344"> 344</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_344"></span><span class="anchor" id="line-344"></span>		<span class="ID">NPY_DOUBLE</span>, <span class="Number">2</span>,<span class="Number">2</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_345"> 345</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_345"></span><span class="anchor" id="line-345"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_346"> 346</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_346"></span><span class="anchor" id="line-346"></span><span class="Comment">/* ==== Create Carray from PyArray ======================</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_347"> 347</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_347"></span><span class="anchor" id="line-347"></span><span class="Comment">    Assumes PyArray is contiguous in memory.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_348"> 348</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_348"></span><span class="anchor" id="line-348"></span><span class="Comment">    Memory is allocated!                                    */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_349"> 349</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_349"></span><span class="anchor" id="line-349"></span><span class="ResWord">double</span> **<span class="ID">pymatrix_to_Carrayptrs</span>(<span class="ID">PyArrayObject</span> *<span class="ID">arrayin</span>)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_350"> 350</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_350"></span><span class="anchor" id="line-350"></span>	<span class="ResWord">double</span> **<span class="ID">c</span>, *<span class="ID">a</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_351"> 351</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_351"></span><span class="anchor" id="line-351"></span>	<span class="ResWord">int</span> <span class="ID">i</span>,<span class="ID">n</span>,<span class="ID">m</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_352"> 352</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_352"></span><span class="anchor" id="line-352"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_353"> 353</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_353"></span><span class="anchor" id="line-353"></span>	<span class="ID">n</span>=<span class="ID">arrayin</span>-&gt;<span class="ID">dimensions</span>[<span class="Number">0</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_354"> 354</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_354"></span><span class="anchor" id="line-354"></span>	<span class="ID">m</span>=<span class="ID">arrayin</span>-&gt;<span class="ID">dimensions</span>[<span class="Number">1</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_355"> 355</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_355"></span><span class="anchor" id="line-355"></span>	<span class="ID">c</span>=<span class="ID">ptrvector</span>(<span class="ID">n</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_356"> 356</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_356"></span><span class="anchor" id="line-356"></span>	<span class="ID">a</span>=(<span class="ResWord">double</span> *) <span class="ID">arrayin</span>-&gt;<span class="ID">data</span>;  <span class="Comment">/* pointer to arrayin data as double */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_357"> 357</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_357"></span><span class="anchor" id="line-357"></span>	<span class="ResWord">for</span> ( <span class="ID">i</span>=<span class="Number">0</span>; <span class="ID">i</span>&lt;<span class="ID">n</span>; <span class="ID">i</span>++)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_358"> 358</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_358"></span><span class="anchor" id="line-358"></span>		<span class="ID">c</span>[<span class="ID">i</span>]=<span class="ID">a</span>+<span class="ID">i</span>*<span class="ID">m</span>;  }</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_359"> 359</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_359"></span><span class="anchor" id="line-359"></span>	<span class="ResWord">return</span> <span class="ID">c</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_360"> 360</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_360"></span><span class="anchor" id="line-360"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_361"> 361</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_361"></span><span class="anchor" id="line-361"></span><span class="Comment">/* ==== Allocate a double *vector (vec of pointers) ======================</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_362"> 362</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_362"></span><span class="anchor" id="line-362"></span><span class="Comment">    Memory is Allocated!  See void free_Carray(double ** )                  */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_363"> 363</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_363"></span><span class="anchor" id="line-363"></span><span class="ResWord">double</span> **<span class="ID">ptrvector</span>(<span class="ResWord">long</span> <span class="ID">n</span>)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_364"> 364</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_364"></span><span class="anchor" id="line-364"></span>	<span class="ResWord">double</span> **<span class="ID">v</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_365"> 365</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_365"></span><span class="anchor" id="line-365"></span>	<span class="ID">v</span>=(<span class="ResWord">double</span> **)<span class="ID">malloc</span>((<span class="ResWord">size_t</span>) (<span class="ID">n</span>*<span class="ResWord">sizeof</span>(<span class="ResWord">double</span>)));</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_366"> 366</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_366"></span><span class="anchor" id="line-366"></span>	<span class="ResWord">if</span> (!<span class="ID">v</span>)   {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_367"> 367</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_367"></span><span class="anchor" id="line-367"></span>		<span class="ID">printf</span>(<span class="String">&quot;</span><span class="String">In **ptrvector. Allocation of memory for double array failed.</span><span class="String">&quot;</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_368"> 368</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_368"></span><span class="anchor" id="line-368"></span>		<span class="ID">exit</span>(<span class="Number">0</span>);  }</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_369"> 369</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_369"></span><span class="anchor" id="line-369"></span>	<span class="ResWord">return</span> <span class="ID">v</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_370"> 370</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_370"></span><span class="anchor" id="line-370"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_371"> 371</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_371"></span><span class="anchor" id="line-371"></span><span class="Comment">/* ==== Free a double *vector (vec of pointers) ========================== */</span> </span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_372"> 372</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_372"></span><span class="anchor" id="line-372"></span><span class="ResWord">void</span> <span class="ID">free_Carrayptrs</span>(<span class="ResWord">double</span> **<span class="ID">v</span>)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_373"> 373</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_373"></span><span class="anchor" id="line-373"></span>	<span class="ID">free</span>((<span class="ResWord">char</span>*) <span class="ID">v</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_374"> 374</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_374"></span><span class="anchor" id="line-374"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_375"> 375</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_375"></span><span class="anchor" id="line-375"></span><span class="Comment">/* ==== Check that PyArrayObject is a double (Float) type and a matrix ==============</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_376"> 376</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_376"></span><span class="anchor" id="line-376"></span><span class="Comment">    return 1 if an error and raise exception */</span> </span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_377"> 377</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_377"></span><span class="anchor" id="line-377"></span><span class="ResWord">int</span>  <span class="ID">not_doublematrix</span>(<span class="ID">PyArrayObject</span> *<span class="ID">mat</span>)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_378"> 378</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_378"></span><span class="anchor" id="line-378"></span>	<span class="ResWord">if</span> (<span class="ID">mat</span>-&gt;<span class="ID">descr</span>-&gt;<span class="ID">type_num</span> != <span class="ID">NPY_DOUBLE</span> || <span class="ID">mat</span>-&gt;<span class="ID">nd</span> != <span class="Number">2</span>)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_379"> 379</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_379"></span><span class="anchor" id="line-379"></span>		<span class="ID">PyErr_SetString</span>(<span class="ID">PyExc_ValueError</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_380"> 380</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_380"></span><span class="anchor" id="line-380"></span>			<span class="String">&quot;</span><span class="String">In not_doublematrix: array must be of type Float and 2 dimensional (n x m).</span><span class="String">&quot;</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_381"> 381</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_381"></span><span class="anchor" id="line-381"></span>		<span class="ResWord">return</span> <span class="Number">1</span>;  }</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_382"> 382</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_382"></span><span class="anchor" id="line-382"></span>	<span class="ResWord">return</span> <span class="Number">0</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_383"> 383</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_383"></span><span class="anchor" id="line-383"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_384"> 384</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_384"></span><span class="anchor" id="line-384"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_385"> 385</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_385"></span><span class="anchor" id="line-385"></span><span class="Comment">/* #### Integer 2D Array Extensions ############################## */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_386"> 386</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_386"></span><span class="anchor" id="line-386"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_387"> 387</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_387"></span><span class="anchor" id="line-387"></span><span class="Comment">/* ==== Integer function - manipulate integer 2D array in place ======================</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_388"> 388</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_388"></span><span class="anchor" id="line-388"></span><span class="Comment">    Replace &gt;=0 integer with 1 and &lt; 0 integer with 0 and put in output</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_389"> 389</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_389"></span><span class="anchor" id="line-389"></span><span class="Comment">    interface:  intfcn1(int1, afloat)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_390"> 390</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_390"></span><span class="anchor" id="line-390"></span><span class="Comment">                int1 is a NumPy integer 2D array, afloat is a Python float</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_391"> 391</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_391"></span><span class="anchor" id="line-391"></span><span class="Comment">                Returns integer 1 if successful                        */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_392"> 392</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_392"></span><span class="anchor" id="line-392"></span><span class="ResWord">static</span> <span class="ID">PyObject</span> *<span class="ID">intfcn1</span>(<span class="ID">PyObject</span> *<span class="ID">self</span>, <span class="ID">PyObject</span> *<span class="ID">args</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_393"> 393</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_393"></span><span class="anchor" id="line-393"></span>{</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_394"> 394</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_394"></span><span class="anchor" id="line-394"></span>	<span class="ID">PyArrayObject</span> *<span class="ID">intin</span>, *<span class="ID">intout</span>;  <span class="Comment">// The python objects to be extracted from the args</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_395"> 395</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_395"></span><span class="anchor" id="line-395"></span><span class="Comment"></span>	<span class="ResWord">int</span> **<span class="ID">cin</span>, **<span class="ID">cout</span>;              <span class="Comment">// The C integer 2D arrays to be created to point to the </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_396"> 396</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_396"></span><span class="anchor" id="line-396"></span><span class="Comment"></span>	                                <span class="Comment">//   python integer 2D arrays, cin and cout point to the rows</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_397"> 397</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_397"></span><span class="anchor" id="line-397"></span><span class="Comment"></span>	                                <span class="Comment">//   of intin and intout, respectively</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_398"> 398</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_398"></span><span class="anchor" id="line-398"></span><span class="Comment"></span>	<span class="ResWord">int</span> <span class="ID">i</span>,<span class="ID">j</span>,<span class="ID">n</span>,<span class="ID">m</span>, <span class="ID">dims</span>[<span class="Number">2</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_399"> 399</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_399"></span><span class="anchor" id="line-399"></span>	<span class="ResWord">double</span> <span class="ID">afloat</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_400"> 400</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_400"></span><span class="anchor" id="line-400"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_401"> 401</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_401"></span><span class="anchor" id="line-401"></span>	<span class="Comment">/* Parse tuples separately since args will differ between C fcns */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_402"> 402</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_402"></span><span class="anchor" id="line-402"></span>	<span class="ResWord">if</span> (!<span class="ID">PyArg_ParseTuple</span>(<span class="ID">args</span>, <span class="String">&quot;</span><span class="String">O!d</span><span class="String">&quot;</span>, </span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_403"> 403</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_403"></span><span class="anchor" id="line-403"></span>		&amp;<span class="ID">PyArray_Type</span>, &amp;<span class="ID">intin</span>, &amp;<span class="ID">afloat</span>))  <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_404"> 404</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_404"></span><span class="anchor" id="line-404"></span>	<span class="ResWord">if</span> (<span class="ResWord">NULL</span> == <span class="ID">intin</span>)  <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_405"> 405</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_405"></span><span class="anchor" id="line-405"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_406"> 406</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_406"></span><span class="anchor" id="line-406"></span>	<span class="ID">printf</span>(<span class="String">&quot;</span><span class="String">In intfcn1, the input Python float = %e, a C double</span><span class="SPChar">\n</span><span class="String">&quot;</span>,<span class="ID">afloat</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_407"> 407</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_407"></span><span class="anchor" id="line-407"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_408"> 408</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_408"></span><span class="anchor" id="line-408"></span>	<span class="Comment">/* Check that object input is int type and a 2D array</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_409"> 409</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_409"></span><span class="anchor" id="line-409"></span><span class="Comment">	   Not needed if python wrapper function checks before call to this routine */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_410"> 410</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_410"></span><span class="anchor" id="line-410"></span>	<span class="ResWord">if</span> (<span class="ID">not_int2Darray</span>(<span class="ID">intin</span>)) <span class="ResWord">return</span> <span class="ResWord">NULL</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_411"> 411</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_411"></span><span class="anchor" id="line-411"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_412"> 412</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_412"></span><span class="anchor" id="line-412"></span>	<span class="Comment">/* Get the dimensions of the input */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_413"> 413</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_413"></span><span class="anchor" id="line-413"></span>	<span class="ID">n</span>=<span class="ID">dims</span>[<span class="Number">0</span>]=<span class="ID">intin</span>-&gt;<span class="ID">dimensions</span>[<span class="Number">0</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_414"> 414</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_414"></span><span class="anchor" id="line-414"></span>	<span class="ID">m</span>=<span class="ID">dims</span>[<span class="Number">1</span>]=<span class="ID">intin</span>-&gt;<span class="ID">dimensions</span>[<span class="Number">1</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_415"> 415</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_415"></span><span class="anchor" id="line-415"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_416"> 416</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_416"></span><span class="anchor" id="line-416"></span>	<span class="Comment">/* Make a new int array of same dims */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_417"> 417</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_417"></span><span class="anchor" id="line-417"></span>	<span class="ID">intout</span>=(<span class="ID">PyArrayObject</span> *) <span class="ID">PyArray_FromDims</span>(<span class="Number">2</span>,<span class="ID">dims</span>,<span class="ID">NPY_LONG</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_418"> 418</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_418"></span><span class="anchor" id="line-418"></span>		</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_419"> 419</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_419"></span><span class="anchor" id="line-419"></span>	<span class="Comment">/* Change contiguous arrays into C ** arrays (Memory is Allocated!) */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_420"> 420</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_420"></span><span class="anchor" id="line-420"></span>	<span class="ID">cin</span>=<span class="ID">pyint2Darray_to_Carrayptrs</span>(<span class="ID">intin</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_421"> 421</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_421"></span><span class="anchor" id="line-421"></span>	<span class="ID">cout</span>=<span class="ID">pyint2Darray_to_Carrayptrs</span>(<span class="ID">intout</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_422"> 422</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_422"></span><span class="anchor" id="line-422"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_423"> 423</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_423"></span><span class="anchor" id="line-423"></span>	<span class="Comment">/* Do the calculation. */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_424"> 424</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_424"></span><span class="anchor" id="line-424"></span>	<span class="ResWord">for</span> ( <span class="ID">i</span>=<span class="Number">0</span>; <span class="ID">i</span>&lt;<span class="ID">n</span>; <span class="ID">i</span>++)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_425"> 425</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_425"></span><span class="anchor" id="line-425"></span>		<span class="ResWord">for</span> ( <span class="ID">j</span>=<span class="Number">0</span>; <span class="ID">j</span>&lt;<span class="ID">m</span>; <span class="ID">j</span>++)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_426"> 426</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_426"></span><span class="anchor" id="line-426"></span>			<span class="ResWord">if</span> (<span class="ID">cin</span>[<span class="ID">i</span>][<span class="ID">j</span>] &gt;= <span class="Number">0</span>)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_427"> 427</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_427"></span><span class="anchor" id="line-427"></span>				<span class="ID">cout</span>[<span class="ID">i</span>][<span class="ID">j</span>]= <span class="Number">1</span>;  }</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_428"> 428</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_428"></span><span class="anchor" id="line-428"></span>			<span class="ResWord">else</span>  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_429"> 429</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_429"></span><span class="anchor" id="line-429"></span>				<span class="ID">cout</span>[<span class="ID">i</span>][<span class="ID">j</span>]= <span class="Number">0</span>;  }</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_430"> 430</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_430"></span><span class="anchor" id="line-430"></span>	}  }</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_431"> 431</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_431"></span><span class="anchor" id="line-431"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_432"> 432</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_432"></span><span class="anchor" id="line-432"></span>	<span class="ID">printf</span>(<span class="String">&quot;</span><span class="String">In intfcn1, the output array is,</span><span class="SPChar">\n</span><span class="SPChar">\n</span><span class="String">&quot;</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_433"> 433</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_433"></span><span class="anchor" id="line-433"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_434"> 434</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_434"></span><span class="anchor" id="line-434"></span>	<span class="ResWord">for</span> ( <span class="ID">i</span>=<span class="Number">0</span>; <span class="ID">i</span>&lt;<span class="ID">n</span>; <span class="ID">i</span>++)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_435"> 435</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_435"></span><span class="anchor" id="line-435"></span>		<span class="ResWord">for</span> ( <span class="ID">j</span>=<span class="Number">0</span>; <span class="ID">j</span>&lt;<span class="ID">m</span>; <span class="ID">j</span>++)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_436"> 436</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_436"></span><span class="anchor" id="line-436"></span>			<span class="ID">printf</span>(<span class="String">&quot;</span><span class="String">%d </span><span class="String">&quot;</span>,<span class="ID">cout</span>[<span class="ID">i</span>][<span class="ID">j</span>]);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_437"> 437</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_437"></span><span class="anchor" id="line-437"></span>		}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_438"> 438</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_438"></span><span class="anchor" id="line-438"></span>		<span class="ID">printf</span>(<span class="String">&quot;</span><span class="SPChar">\n</span><span class="String">&quot;</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_439"> 439</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_439"></span><span class="anchor" id="line-439"></span>	}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_440"> 440</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_440"></span><span class="anchor" id="line-440"></span>	<span class="ID">printf</span>(<span class="String">&quot;</span><span class="SPChar">\n</span><span class="String">&quot;</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_441"> 441</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_441"></span><span class="anchor" id="line-441"></span>		</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_442"> 442</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_442"></span><span class="anchor" id="line-442"></span>	<span class="Comment">/* Free memory, close file and return */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_443"> 443</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_443"></span><span class="anchor" id="line-443"></span>	<span class="ID">free_Cint2Darrayptrs</span>(<span class="ID">cin</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_444"> 444</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_444"></span><span class="anchor" id="line-444"></span>	<span class="ID">free_Cint2Darrayptrs</span>(<span class="ID">cout</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_445"> 445</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_445"></span><span class="anchor" id="line-445"></span>	<span class="ResWord">return</span> <span class="ID">PyArray_Return</span>(<span class="ID">intout</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_446"> 446</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_446"></span><span class="anchor" id="line-446"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_447"> 447</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_447"></span><span class="anchor" id="line-447"></span><span class="Comment">/* #### Integer Array Utility functions ######################### */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_448"> 448</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_448"></span><span class="anchor" id="line-448"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_449"> 449</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_449"></span><span class="anchor" id="line-449"></span><span class="Comment">/* ==== Make a Python int Array Obj. from a PyObject, ================</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_450"> 450</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_450"></span><span class="anchor" id="line-450"></span><span class="Comment">     generates a 2D integer array w/ contiguous memory which may be a new allocation if</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_451"> 451</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_451"></span><span class="anchor" id="line-451"></span><span class="Comment">     the original was not an integer type or contiguous </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_452"> 452</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_452"></span><span class="anchor" id="line-452"></span><span class="Comment">  !! Must DECREF the object returned from this routine unless it is returned to the</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_453"> 453</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_453"></span><span class="anchor" id="line-453"></span><span class="Comment">     caller of this routines caller using return PyArray_Return(obj) or</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_454"> 454</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_454"></span><span class="anchor" id="line-454"></span><span class="Comment">     PyArray_BuildValue with the &quot;N&quot; construct   !!!</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_455"> 455</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_455"></span><span class="anchor" id="line-455"></span><span class="Comment">*/</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_456"> 456</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_456"></span><span class="anchor" id="line-456"></span><span class="ID">PyArrayObject</span> *<span class="ID">pyint2Darray</span>(<span class="ID">PyObject</span> *<span class="ID">objin</span>)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_457"> 457</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_457"></span><span class="anchor" id="line-457"></span>	<span class="ResWord">return</span> (<span class="ID">PyArrayObject</span> *) <span class="ID">PyArray_ContiguousFromObject</span>(<span class="ID">objin</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_458"> 458</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_458"></span><span class="anchor" id="line-458"></span>		<span class="ID">NPY_LONG</span>, <span class="Number">2</span>,<span class="Number">2</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_459"> 459</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_459"></span><span class="anchor" id="line-459"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_460"> 460</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_460"></span><span class="anchor" id="line-460"></span><span class="Comment">/* ==== Create integer 2D Carray from PyArray ======================</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_461"> 461</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_461"></span><span class="anchor" id="line-461"></span><span class="Comment">    Assumes PyArray is contiguous in memory.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_462"> 462</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_462"></span><span class="anchor" id="line-462"></span><span class="Comment">    Memory is allocated!                                    */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_463"> 463</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_463"></span><span class="anchor" id="line-463"></span><span class="ResWord">int</span> **<span class="ID">pyint2Darray_to_Carrayptrs</span>(<span class="ID">PyArrayObject</span> *<span class="ID">arrayin</span>)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_464"> 464</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_464"></span><span class="anchor" id="line-464"></span>	<span class="ResWord">int</span> **<span class="ID">c</span>, *<span class="ID">a</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_465"> 465</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_465"></span><span class="anchor" id="line-465"></span>	<span class="ResWord">int</span> <span class="ID">i</span>,<span class="ID">n</span>,<span class="ID">m</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_466"> 466</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_466"></span><span class="anchor" id="line-466"></span>	</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_467"> 467</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_467"></span><span class="anchor" id="line-467"></span>	<span class="ID">n</span>=<span class="ID">arrayin</span>-&gt;<span class="ID">dimensions</span>[<span class="Number">0</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_468"> 468</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_468"></span><span class="anchor" id="line-468"></span>	<span class="ID">m</span>=<span class="ID">arrayin</span>-&gt;<span class="ID">dimensions</span>[<span class="Number">1</span>];</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_469"> 469</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_469"></span><span class="anchor" id="line-469"></span>	<span class="ID">c</span>=<span class="ID">ptrintvector</span>(<span class="ID">n</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_470"> 470</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_470"></span><span class="anchor" id="line-470"></span>	<span class="ID">a</span>=(<span class="ResWord">int</span> *) <span class="ID">arrayin</span>-&gt;<span class="ID">data</span>;  <span class="Comment">/* pointer to arrayin data as int */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_471"> 471</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_471"></span><span class="anchor" id="line-471"></span>	<span class="ResWord">for</span> ( <span class="ID">i</span>=<span class="Number">0</span>; <span class="ID">i</span>&lt;<span class="ID">n</span>; <span class="ID">i</span>++)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_472"> 472</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_472"></span><span class="anchor" id="line-472"></span>		<span class="ID">c</span>[<span class="ID">i</span>]=<span class="ID">a</span>+<span class="ID">i</span>*<span class="ID">m</span>;  }</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_473"> 473</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_473"></span><span class="anchor" id="line-473"></span>	<span class="ResWord">return</span> <span class="ID">c</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_474"> 474</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_474"></span><span class="anchor" id="line-474"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_475"> 475</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_475"></span><span class="anchor" id="line-475"></span><span class="Comment">/* ==== Allocate a a *int (vec of pointers) ======================</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_476"> 476</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_476"></span><span class="anchor" id="line-476"></span><span class="Comment">    Memory is Allocated!  See void free_Carray(int ** )                  */</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_477"> 477</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_477"></span><span class="anchor" id="line-477"></span><span class="ResWord">int</span> **<span class="ID">ptrintvector</span>(<span class="ResWord">long</span> <span class="ID">n</span>)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_478"> 478</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_478"></span><span class="anchor" id="line-478"></span>	<span class="ResWord">int</span> **<span class="ID">v</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_479"> 479</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_479"></span><span class="anchor" id="line-479"></span>	<span class="ID">v</span>=(<span class="ResWord">int</span> **)<span class="ID">malloc</span>((<span class="ResWord">size_t</span>) (<span class="ID">n</span>*<span class="ResWord">sizeof</span>(<span class="ResWord">int</span>)));</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_480"> 480</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_480"></span><span class="anchor" id="line-480"></span>	<span class="ResWord">if</span> (!<span class="ID">v</span>)   {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_481"> 481</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_481"></span><span class="anchor" id="line-481"></span>		<span class="ID">printf</span>(<span class="String">&quot;</span><span class="String">In **ptrintvector. Allocation of memory for int array failed.</span><span class="String">&quot;</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_482"> 482</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_482"></span><span class="anchor" id="line-482"></span>		<span class="ID">exit</span>(<span class="Number">0</span>);  }</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_483"> 483</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_483"></span><span class="anchor" id="line-483"></span>	<span class="ResWord">return</span> <span class="ID">v</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_484"> 484</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_484"></span><span class="anchor" id="line-484"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_485"> 485</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_485"></span><span class="anchor" id="line-485"></span><span class="Comment">/* ==== Free an int *vector (vec of pointers) ========================== */</span> </span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_486"> 486</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_486"></span><span class="anchor" id="line-486"></span><span class="ResWord">void</span> <span class="ID">free_Cint2Darrayptrs</span>(<span class="ResWord">int</span> **<span class="ID">v</span>)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_487"> 487</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_487"></span><span class="anchor" id="line-487"></span>	<span class="ID">free</span>((<span class="ResWord">char</span>*) <span class="ID">v</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_488"> 488</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_488"></span><span class="anchor" id="line-488"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_489"> 489</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_489"></span><span class="anchor" id="line-489"></span><span class="Comment">/* ==== Check that PyArrayObject is an int (integer) type and a 2D array ==============</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_490"> 490</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_490"></span><span class="anchor" id="line-490"></span><span class="Comment">    return 1 if an error and raise exception</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_491"> 491</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_491"></span><span class="anchor" id="line-491"></span><span class="Comment">    Note:  Use NY_LONG for NumPy integer array, not NP_INT      */</span> </span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_492"> 492</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_492"></span><span class="anchor" id="line-492"></span><span class="ResWord">int</span>  <span class="ID">not_int2Darray</span>(<span class="ID">PyArrayObject</span> *<span class="ID">mat</span>)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_493"> 493</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_493"></span><span class="anchor" id="line-493"></span>	<span class="ResWord">if</span> (<span class="ID">mat</span>-&gt;<span class="ID">descr</span>-&gt;<span class="ID">type_num</span> != <span class="ID">NPY_LONG</span> || <span class="ID">mat</span>-&gt;<span class="ID">nd</span> != <span class="Number">2</span>)  {</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_494"> 494</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_494"></span><span class="anchor" id="line-494"></span>		<span class="ID">PyErr_SetString</span>(<span class="ID">PyExc_ValueError</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_495"> 495</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_495"></span><span class="anchor" id="line-495"></span>			<span class="String">&quot;</span><span class="String">In not_int2Darray: array must be of type int and 2 dimensional (n x m).</span><span class="String">&quot;</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_496"> 496</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_496"></span><span class="anchor" id="line-496"></span>		<span class="ResWord">return</span> <span class="Number">1</span>;  }</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_497"> 497</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_497"></span><span class="anchor" id="line-497"></span>	<span class="ResWord">return</span> <span class="Number">0</span>;</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_498"> 498</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_498"></span><span class="anchor" id="line-498"></span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_499"> 499</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_499"></span><span class="anchor" id="line-499"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_500"> 500</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_500"></span><span class="anchor" id="line-500"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_501"> 501</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_501"></span><span class="anchor" id="line-501"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_502"> 502</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_502"></span><span class="anchor" id="line-502"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_503"> 503</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_503"></span><span class="anchor" id="line-503"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_504"> 504</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_504"></span><span class="anchor" id="line-504"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_505"> 505</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_505"></span><span class="anchor" id="line-505"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_506"> 506</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_506"></span><span class="anchor" id="line-506"></span><span class="Comment">// EOF</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_507"> 507</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_507"></span><span class="anchor" id="line-507"></span><span class="Comment"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_508"> 508</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_508"></span><span class="anchor" id="line-508"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_509"> 509</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_509"></span><span class="anchor" id="line-509"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_510"> 510</a> </span><span class="LineAnchor" id="CA-4c24d1a924163136cd0183d8f428952dda2a5d5a_510"></span><span class="anchor" id="line-510"></span>     </span>
</pre></div></div><li style="list-style-type:none"><p class="line891"><a class="attachment" href="NumPy_arraysa868.html?action=AttachFile&amp;do=view&amp;target=C_arraytest.c" title="attachment:C_arraytest.c">C_arraytest.c</a> <span class="anchor" id="line-96-1"></span><span class="anchor" id="line-97-1"></span></li></ul><p class="line874">Now, lets look at the source code in smaller chunks. <span class="anchor" id="line-98-1"></span><span class="anchor" id="line-99-1"></span><p class="line867">
<h4 id="Headers">Headers</h4>
<span class="anchor" id="line-100-1"></span><span class="anchor" id="line-101-1"></span><p class="line862">You must include the following headers with Python.h <strong>always</strong> the first header included. <span class="anchor" id="line-102-1"></span><span class="anchor" id="line-103-1"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-104-1"></span><span class="anchor" id="line-105-1"></span><span class="anchor" id="line-106-1"></span><pre><span class="anchor" id="line-1-5"></span>#include &quot;Python.h&quot;
<span class="anchor" id="line-2-3"></span>#include &quot;arrayobject.h&quot;</pre><span class="anchor" id="line-107-1"></span><span class="anchor" id="line-108-1"></span></li></ul><p class="line874">I also include the header C_arraytest.h which contains the prototype of the matsq function: <span class="anchor" id="line-109-1"></span><span class="anchor" id="line-110-1"></span><ul><li style="list-style-type:none"><p class="line862">{{{static <a class="nonexistent" href="../../PyObject.html">PyObject</a> *matsq(<a class="nonexistent" href="../../PyObject.html">PyObject</a> *self, <a class="nonexistent" href="../../PyObject.html">PyObject</a> *args); <span class="anchor" id="line-111-1"></span></li></ul><p class="line874">}}} <span class="anchor" id="line-112-1"></span><span class="anchor" id="line-113-1"></span><p class="line862">The static keyword in front of a function declaration makes this function private to your extension module. The linker just won't see it. This way you can use the same intuitional function names(i.e. sum, check, trace) for all extension modules without having name clashes between them at link time. The type of the function is <tt class="backtick">PyObject&nbsp;*</tt> because it will always be returning to a Python calling function so you can (must, actually) return a Python object. The arguments are always the same , <span class="anchor" id="line-114-1"></span><span class="anchor" id="line-115-1"></span><ul><li style="list-style-type:none"><p class="line862">{{{<a class="nonexistent" href="../../PyObject.html">PyObject</a> *self and <a class="nonexistent" href="../../PyObject.html">PyObject</a> *args <span class="anchor" id="line-116-1"></span></li></ul><p class="line874">}}} <span class="anchor" id="line-117-1"></span><span class="anchor" id="line-118-1"></span><p class="line874">The first one self is never used, but necessary because of how Python passes arguments. The second args is a pointer to a Python tuple that contains all of the arguments (B,i,x) of the function. <span class="anchor" id="line-119-1"></span><span class="anchor" id="line-120-1"></span><p class="line867">
<h4 id="Method_definitions">Method definitions</h4>
<span class="anchor" id="line-121-1"></span><span class="anchor" id="line-122-1"></span><p class="line862">This sets up a table of function names that will be the interface from your Python code to your C extension. The name of the C extension module will be <tt class="backtick">_C_arraytest</tt> (note the leading underscore). It is important to get the name right each time it is used because there are strict requirements on using the module name in the code. The name appears first in the method definitions table as the first part of the table name: <span class="anchor" id="line-123-1"></span><span class="anchor" id="line-124-1"></span><ul><li style="list-style-type:none"><p class="line862">{{{static <a class="nonexistent" href="../../PyMethodDef.html">PyMethodDef</a> _C_arraytestMethods[] = { <span class="anchor" id="line-125-1"></span><ul><li style="list-style-type:none">.., <span class="anchor" id="line-126-1"></span>{&quot;matsq&quot;, matsq, METH_VARARGS}, <span class="anchor" id="line-127-1"></span></li><li style="list-style-type:none">.., <span class="anchor" id="line-128-1"></span><p class="line862">{NULL, NULL}     <span class="comment" style="display:none">Sentinel - marks the end of this structure</span> <span class="anchor" id="line-129-1"></span></li></ul></li></ul><p class="line874">}; <span class="anchor" id="line-130-1"></span>}}} <span class="anchor" id="line-131-1"></span><span class="anchor" id="line-132-1"></span><p class="line862">where I used ellipses (...) to ignore other code not relevant to this function. The <tt class="backtick">METH_VARARGS</tt> parameter tells the compiler that you will pass the arguments the usual way without keywords as in the example <tt class="backtick">A=matsq(B,i,x)</tt> above. There are ways to use Python keywords, but I have not tried them out. The table should always end with {NULL, NULL} which is just a &quot;marker&quot; to note the end of the table. <span class="anchor" id="line-133-1"></span><span class="anchor" id="line-134-1"></span><p class="line867">
<h4 id="Initializations">Initializations</h4>
<span class="anchor" id="line-135-1"></span><span class="anchor" id="line-136-1"></span><p class="line862">These functions tell the Python interpreter what to call when the module is loaded. Note the name of the module (<tt class="backtick">_C_arraytest</tt>) must come directly after the init in the name of the initialization structure. <span class="anchor" id="line-137-1"></span><span class="anchor" id="line-138-1"></span><ul><li style="list-style-type:none">{{{void init_C_arraytest() { <span class="anchor" id="line-139-1"></span><ul><li style="list-style-type:none"><p class="line862">(void) Py_<a class="nonexistent" href="../../InitModule.html">InitModule</a>(&quot;_C_arraytest&quot;, _C_arraytestMethods); <span class="anchor" id="line-140-1"></span>import_array(); // Must be present for <a class="nonexistent" href="../../NumPy.html">NumPy</a>. Called first after above line. <span class="anchor" id="line-141-1"></span></li></ul></li></ul><p class="line874">} <span class="anchor" id="line-142-1"></span>}}} <span class="anchor" id="line-143-1"></span><span class="anchor" id="line-144-1"></span><p class="line874">The order is important and you must call these two initialization functions first. <span class="anchor" id="line-145-1"></span><span class="anchor" id="line-146-1"></span><p class="line867">
<h4 id="The_matsqfunction_code">The matsqfunction code</h4>
<span class="anchor" id="line-147-1"></span><span class="anchor" id="line-148-1"></span><p class="line874">Now here is the actual function that you will call from Python code. I will split it up and explain each section. <span class="anchor" id="line-149-1"></span><span class="anchor" id="line-150-1"></span><p class="line874">The function name and type: <span class="anchor" id="line-151-1"></span><span class="anchor" id="line-152-1"></span><ul><li style="list-style-type:none"><p class="line862">{{{static <a class="nonexistent" href="../../PyObject.html">PyObject</a> *matsq(<a class="nonexistent" href="../../PyObject.html">PyObject</a> *self, <a class="nonexistent" href="../../PyObject.html">PyObject</a> *args) <span class="anchor" id="line-153-1"></span></li></ul><p class="line874">}}} <span class="anchor" id="line-154-1"></span><span class="anchor" id="line-155-1"></span><p class="line874">You can see they match the prototype in C_arraytest.h. <span class="anchor" id="line-156-1"></span><span class="anchor" id="line-157-1"></span><p class="line874">The local variables: <span class="anchor" id="line-158-1"></span><span class="anchor" id="line-159-1"></span><ul><li style="list-style-type:none"><span class="anchor" id="line-160-1"></span><span class="anchor" id="line-161-1"></span><span class="anchor" id="line-162-1"></span><span class="anchor" id="line-163-1"></span><span class="anchor" id="line-164-1"></span><span class="anchor" id="line-165-1"></span><span class="anchor" id="line-166-1"></span><span class="anchor" id="line-167-1"></span><span class="anchor" id="line-168-1"></span><span class="anchor" id="line-169-1"></span><span class="anchor" id="line-170-1"></span><span class="anchor" id="line-171-1"></span><span class="anchor" id="line-172-1"></span><span class="anchor" id="line-173-1"></span><span class="anchor" id="line-174-1"></span><span class="anchor" id="line-175-1"></span><span class="anchor" id="line-176-1"></span><span class="anchor" id="line-177-1"></span><span class="anchor" id="line-178-1"></span><span class="anchor" id="line-179-1"></span><span class="anchor" id="line-180-1"></span><span class="anchor" id="line-181-1"></span><span class="anchor" id="line-182-1"></span><span class="anchor" id="line-183-1"></span><span class="anchor" id="line-184-1"></span><span class="anchor" id="line-185-1"></span><span class="anchor" id="line-186-1"></span><span class="anchor" id="line-187-1"></span><span class="anchor" id="line-188-1"></span><span class="anchor" id="line-189-1"></span><span class="anchor" id="line-190-1"></span><span class="anchor" id="line-191-1"></span><span class="anchor" id="line-192-1"></span><span class="anchor" id="line-193-1"></span><span class="anchor" id="line-194-1"></span><span class="anchor" id="line-195-1"></span><span class="anchor" id="line-196-1"></span><span class="anchor" id="line-197-1"></span><span class="anchor" id="line-198-1"></span><span class="anchor" id="line-199-1"></span><span class="anchor" id="line-200-1"></span><span class="anchor" id="line-201-1"></span><span class="anchor" id="line-202-1"></span><span class="anchor" id="line-203-1"></span><span class="anchor" id="line-204-1"></span><span class="anchor" id="line-205-1"></span><span class="anchor" id="line-206-1"></span><span class="anchor" id="line-207-1"></span><span class="anchor" id="line-208-1"></span><span class="anchor" id="line-209-1"></span><span class="anchor" id="line-210-1"></span><span class="anchor" id="line-211-1"></span><span class="anchor" id="line-212-1"></span><span class="anchor" id="line-213-1"></span><span class="anchor" id="line-214-1"></span><span class="anchor" id="line-215-1"></span><span class="anchor" id="line-216-1"></span><span class="anchor" id="line-217-1"></span><span class="anchor" id="line-218-1"></span><span class="anchor" id="line-219-1"></span><span class="anchor" id="line-220-1"></span><span class="anchor" id="line-221-1"></span><span class="anchor" id="line-222-1"></span><span class="anchor" id="line-223-1"></span><span class="anchor" id="line-224-1"></span><span class="anchor" id="line-225-1"></span><span class="anchor" id="line-226-1"></span><span class="anchor" id="line-227-1"></span><span class="anchor" id="line-228-1"></span><span class="anchor" id="line-229-1"></span><span class="anchor" id="line-230-1"></span><span class="anchor" id="line-231-1"></span><span class="anchor" id="line-232-1"></span><span class="anchor" id="line-233-1"></span><span class="anchor" id="line-234-1"></span><span class="anchor" id="line-235-1"></span><span class="anchor" id="line-236-1"></span><span class="anchor" id="line-237-1"></span><span class="anchor" id="line-238-1"></span><span class="anchor" id="line-239-1"></span><span class="anchor" id="line-240-1"></span><span class="anchor" id="line-241-1"></span><span class="anchor" id="line-242-1"></span><span class="anchor" id="line-243-1"></span><span class="anchor" id="line-244-1"></span><span class="anchor" id="line-245-1"></span><span class="anchor" id="line-246-1"></span><span class="anchor" id="line-247-1"></span><span class="anchor" id="line-248-1"></span><span class="anchor" id="line-249-1"></span><span class="anchor" id="line-250-1"></span><span class="anchor" id="line-251-1"></span><span class="anchor" id="line-252-1"></span><span class="anchor" id="line-253-1"></span><span class="anchor" id="line-254-1"></span><span class="anchor" id="line-255-1"></span><span class="anchor" id="line-256-1"></span><span class="anchor" id="line-257-1"></span><span class="anchor" id="line-258-1"></span><span class="anchor" id="line-259-1"></span><span class="anchor" id="line-260-1"></span><span class="anchor" id="line-261-1"></span><span class="anchor" id="line-262-1"></span><span class="anchor" id="line-263-1"></span><span class="anchor" id="line-264-1"></span><span class="anchor" id="line-265-1"></span><span class="anchor" id="line-266-1"></span><span class="anchor" id="line-267-1"></span><span class="anchor" id="line-268-1"></span><span class="anchor" id="line-269-1"></span><span class="anchor" id="line-270-1"></span><span class="anchor" id="line-271-1"></span><span class="anchor" id="line-272-1"></span><span class="anchor" id="line-273-1"></span><span class="anchor" id="line-274-1"></span><span class="anchor" id="line-275-1"></span><span class="anchor" id="line-276-1"></span><span class="anchor" id="line-277-1"></span><span class="anchor" id="line-278-1"></span><span class="anchor" id="line-279-1"></span><span class="anchor" id="line-280-1"></span><span class="anchor" id="line-281-1"></span><span class="anchor" id="line-282-1"></span><span class="anchor" id="line-283-1"></span><span class="anchor" id="line-284-1"></span><span class="anchor" id="line-285-1"></span><span class="anchor" id="line-286-1"></span><span class="anchor" id="line-287-1"></span><span class="anchor" id="line-288-1"></span><span class="anchor" id="line-289-1"></span><span class="anchor" id="line-290-1"></span><span class="anchor" id="line-291-1"></span><span class="anchor" id="line-292-1"></span><span class="anchor" id="line-293-1"></span><span class="anchor" id="line-294-1"></span><span class="anchor" id="line-295-1"></span><span class="anchor" id="line-296-1"></span><span class="anchor" id="line-297-1"></span><span class="anchor" id="line-298-1"></span><span class="anchor" id="line-299-1"></span><span class="anchor" id="line-300-1"></span><span class="anchor" id="line-301-1"></span><span class="anchor" id="line-302-1"></span><span class="anchor" id="line-303-1"></span><span class="anchor" id="line-304-1"></span><span class="anchor" id="line-305-1"></span><span class="anchor" id="line-306-1"></span><span class="anchor" id="line-307-1"></span><span class="anchor" id="line-308-1"></span><span class="anchor" id="line-309-1"></span><span class="anchor" id="line-310-1"></span><span class="anchor" id="line-311-1"></span><span class="anchor" id="line-312-1"></span><span class="anchor" id="line-313-1"></span><span class="anchor" id="line-314-1"></span><span class="anchor" id="line-315-1"></span><span class="anchor" id="line-316-1"></span><span class="anchor" id="line-317-1"></span><span class="anchor" id="line-318-1"></span><span class="anchor" id="line-319-1"></span><span class="anchor" id="line-320-1"></span><span class="anchor" id="line-321-1"></span><span class="anchor" id="line-322-1"></span><span class="anchor" id="line-323-1"></span><span class="anchor" id="line-324-1"></span><span class="anchor" id="line-325-1"></span><span class="anchor" id="line-326-1"></span><span class="anchor" id="line-327-1"></span><span class="anchor" id="line-328-1"></span><span class="anchor" id="line-329-1"></span><span class="anchor" id="line-330-1"></span><span class="anchor" id="line-331-1"></span><span class="anchor" id="line-332-1"></span><span class="anchor" id="line-333-1"></span><span class="anchor" id="line-334-1"></span><span class="anchor" id="line-335-1"></span><span class="anchor" id="line-336-1"></span><span class="anchor" id="line-337-1"></span><span class="anchor" id="line-338-1"></span><span class="anchor" id="line-339-1"></span><span class="anchor" id="line-340-1"></span><span class="anchor" id="line-341-1"></span><span class="anchor" id="line-342-1"></span><span class="anchor" id="line-343-1"></span><span class="anchor" id="line-344-1"></span><span class="anchor" id="line-345-1"></span><span class="anchor" id="line-346-1"></span><span class="anchor" id="line-347-1"></span><span class="anchor" id="line-348-1"></span><span class="anchor" id="line-349-1"></span><span class="anchor" id="line-350-1"></span><span class="anchor" id="line-351-1"></span><span class="anchor" id="line-352-1"></span><span class="anchor" id="line-353-1"></span><span class="anchor" id="line-354-1"></span><span class="anchor" id="line-355-1"></span><span class="anchor" id="line-356-1"></span><span class="anchor" id="line-357-1"></span><span class="anchor" id="line-358-1"></span><span class="anchor" id="line-359-1"></span><span class="anchor" id="line-360-1"></span><span class="anchor" id="line-361-1"></span><span class="anchor" id="line-362-1"></span><span class="anchor" id="line-363-1"></span><span class="anchor" id="line-364-1"></span><span class="anchor" id="line-365-1"></span><span class="anchor" id="line-366-1"></span><span class="anchor" id="line-367-1"></span><span class="anchor" id="line-368-1"></span><span class="anchor" id="line-369-1"></span><span class="anchor" id="line-370-1"></span><span class="anchor" id="line-371-1"></span><span class="anchor" id="line-372-1"></span><span class="anchor" id="line-373-1"></span><span class="anchor" id="line-374-1"></span><span class="anchor" id="line-375-1"></span><span class="anchor" id="line-376-1"></span><span class="anchor" id="line-377-1"></span><span class="anchor" id="line-378-1"></span><span class="anchor" id="line-379-1"></span><span class="anchor" id="line-380-1"></span><span class="anchor" id="line-381-1"></span><span class="anchor" id="line-382-1"></span><span class="anchor" id="line-383-1"></span><span class="anchor" id="line-384-1"></span><span class="anchor" id="line-385-1"></span><span class="anchor" id="line-386-1"></span><span class="anchor" id="line-387-1"></span><span class="anchor" id="line-388-1"></span><span class="anchor" id="line-389-1"></span><span class="anchor" id="line-390-1"></span><span class="anchor" id="line-391-1"></span><span class="anchor" id="line-392-1"></span><span class="anchor" id="line-393-1"></span><span class="anchor" id="line-394-1"></span><span class="anchor" id="line-395-1"></span><span class="anchor" id="line-396-1"></span><span class="anchor" id="line-397-1"></span><span class="anchor" id="line-398-1"></span><span class="anchor" id="line-399-1"></span><span class="anchor" id="line-400-1"></span><span class="anchor" id="line-401-1"></span><span class="anchor" id="line-402-1"></span><span class="anchor" id="line-403-1"></span><span class="anchor" id="line-404-1"></span><span class="anchor" id="line-405-1"></span><span class="anchor" id="line-406-1"></span><span class="anchor" id="line-407-1"></span><span class="anchor" id="line-408-1"></span><span class="anchor" id="line-409-1"></span><span class="anchor" id="line-410-1"></span><span class="anchor" id="line-411-1"></span><span class="anchor" id="line-412-1"></span><span class="anchor" id="line-413-1"></span><span class="anchor" id="line-414-1"></span><span class="anchor" id="line-415-1"></span><span class="anchor" id="line-416-1"></span><span class="anchor" id="line-417-1"></span><span class="anchor" id="line-418-1"></span><span class="anchor" id="line-419-1"></span><span class="anchor" id="line-420-1"></span><span class="anchor" id="line-421-1"></span><span class="anchor" id="line-422-1"></span><span class="anchor" id="line-423-1"></span><span class="anchor" id="line-424-1"></span><span class="anchor" id="line-425-1"></span><span class="anchor" id="line-426-1"></span><span class="anchor" id="line-427-1"></span><span class="anchor" id="line-428-1"></span><span class="anchor" id="line-429-1"></span><span class="anchor" id="line-430-1"></span><span class="anchor" id="line-431-1"></span><span class="anchor" id="line-432-1"></span><span class="anchor" id="line-433-1"></span><span class="anchor" id="line-434-1"></span><span class="anchor" id="line-435-1"></span><span class="anchor" id="line-436-1"></span><span class="anchor" id="line-437-1"></span><span class="anchor" id="line-438-1"></span><span class="anchor" id="line-439-1"></span><span class="anchor" id="line-440-1"></span><span class="anchor" id="line-441-1"></span><span class="anchor" id="line-442-1"></span><span class="anchor" id="line-443-1"></span><span class="anchor" id="line-444-1"></span><span class="anchor" id="line-445-1"></span><span class="anchor" id="line-446-1"></span><span class="anchor" id="line-447-1"></span><span class="anchor" id="line-448-1"></span><span class="anchor" id="line-449-1"></span><span class="anchor" id="line-450-1"></span><span class="anchor" id="line-451-1"></span><span class="anchor" id="line-452-1"></span><span class="anchor" id="line-453-1"></span><span class="anchor" id="line-454-1"></span><span class="anchor" id="line-455-1"></span><span class="anchor" id="line-456-1"></span><span class="anchor" id="line-457-1"></span><span class="anchor" id="line-458-1"></span><span class="anchor" id="line-459-1"></span><span class="anchor" id="line-460-1"></span><span class="anchor" id="line-461-1"></span><span class="anchor" id="line-462-1"></span><span class="anchor" id="line-463-1"></span><span class="anchor" id="line-464-1"></span><span class="anchor" id="line-465-1"></span><span class="anchor" id="line-466-1"></span><span class="anchor" id="line-467-1"></span><span class="anchor" id="line-468-1"></span><span class="anchor" id="line-469-1"></span><span class="anchor" id="line-470-1"></span><span class="anchor" id="line-471-1"></span><span class="anchor" id="line-472-1"></span><span class="anchor" id="line-473-1"></span><span class="anchor" id="line-474-1"></span><span class="anchor" id="line-475-1"></span><span class="anchor" id="line-476-1"></span><span class="anchor" id="line-477-1"></span><span class="anchor" id="line-478-1"></span><span class="anchor" id="line-479-1"></span><span class="anchor" id="line-480-1"></span><span class="anchor" id="line-481-1"></span><span class="anchor" id="line-482-1"></span><span class="anchor" id="line-483-1"></span><span class="anchor" id="line-484-1"></span><span class="anchor" id="line-485-1"></span><span class="anchor" id="line-486-1"></span><span class="anchor" id="line-487-1"></span><span class="anchor" id="line-488-1"></span><span class="anchor" id="line-489-1"></span><span class="anchor" id="line-490-1"></span><span class="anchor" id="line-491-1"></span><span class="anchor" id="line-492-1"></span><span class="anchor" id="line-493-1"></span><span class="anchor" id="line-494-1"></span><span class="anchor" id="line-495-1"></span><span class="anchor" id="line-496-1"></span><span class="anchor" id="line-497-1"></span><span class="anchor" id="line-498-1"></span><span class="anchor" id="line-499-1"></span><span class="anchor" id="line-500-1"></span><span class="anchor" id="line-501-1"></span><span class="anchor" id="line-502-1"></span><span class="anchor" id="line-503-1"></span><span class="anchor" id="line-504-1"></span><span class="anchor" id="line-505-1"></span><span class="anchor" id="line-506-1"></span><span class="anchor" id="line-507-1"></span><span class="anchor" id="line-508-1"></span><span class="anchor" id="line-509-1"></span><span class="anchor" id="line-510-1"></span><span class="anchor" id="line-511"></span><span class="anchor" id="line-512"></span><span class="anchor" id="line-513"></span><span class="anchor" id="line-514"></span><span class="anchor" id="line-515"></span><span class="anchor" id="line-516"></span></li></ul></pre><span class="anchor" id="bottom"></span></div><p id="pageinfo" class="info" lang="en" dir="ltr">SciPy: Cookbook/C_Extensions/NumPy_arrays  (last edited 2015-10-24 17:48:26 by <span title="">anonymous</span>)</p>

<div id="pagebottom"></div>
</div>


<div id="footer">
<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="NumPy_arrays37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../../../external.html?link=http://localhost:8080/Cookbook/C_Extensions/NumPy_arrays">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

<ul id="credits">
<li><a href="../../../external.html?link=http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="../../../external.html?link=http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="../../../external.html?link=http://moinmo.in/GPL" title="MoinMoin is GPL licensed.">GPL licensed</a></li><li><a href="../../../external.html?link=http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li>
</ul>


</div>
</body>

<!-- Mirrored from localhost:8080/Cookbook/C_Extensions/NumPy_arrays?highlight=%28%28SciPy%29%29 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 23:20:10 GMT -->
</html>

