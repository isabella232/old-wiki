<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<!-- Mirrored from localhost:8080/Cookbook/Matplotlib/Gridding_irregularly_spaced_data?highlight=%28%28Cookbook%29%29 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 23:19:09 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="edit_on_doubleclick" content="/">
<meta name="robots" content="noindex,nofollow">

<title>Cookbook/Matplotlib/Gridding_irregularly_spaced_data - SciPy</title>
<script type="text/javascript" src="../../moin_static197/common/js/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../../moin_static197/modern/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="../../moin_static197/modern/css/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="../../moin_static197/modern/css/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="../../moin_static197/modern/css/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static197/modern/css/msie.css">
<![endif]-->


<link rel="alternate" title="SciPy: Cookbook/Matplotlib/Gridding_irregularly_spaced_data" href="../../../external.html?link=http://localhost:8080/Cookbook/Matplotlib/Gridding_irregularly_spaced_data?diffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=Cookbook%2FMatplotlib%2FGridding_irregularly_spaced_data&amp;ddiffs=1" type="application/rss+xml">


<link rel="Start" href="../../AllPages.html">
<link rel="Alternate" title="Wiki Markup" href="../../../external.html?link=http://localhost:8080/Cookbook/Matplotlib/Gridding_irregularly_spaced_data?action=raw">
<link rel="Alternate" media="print" title="Print View" href="../../../external.html?link=http://localhost:8080/Cookbook/Matplotlib/Gridding_irregularly_spaced_data?action=print">
<link rel="Up" href="../Matplotlib.html">
<link rel="Appendix" title="bin.png" href="Gridding_irregularly_spaced_data6a51.html?action=AttachFile&amp;do=view&amp;target=bin.png">
<link rel="Appendix" title="bin_small" href="Gridding_irregularly_spaced_datac407.html?action=AttachFile&amp;do=view&amp;target=bin_small">
<link rel="Appendix" title="bin_small.png" href="Gridding_irregularly_spaced_data6381.html?action=AttachFile&amp;do=view&amp;target=bin_small.png">
<link rel="Appendix" title="binned_data.png" href="Gridding_irregularly_spaced_datad950.html?action=AttachFile&amp;do=view&amp;target=binned_data.png">
<link rel="Appendix" title="griddataexample1.png" href="Gridding_irregularly_spaced_data7015.html?action=AttachFile&amp;do=view&amp;target=griddataexample1.png">
<link rel="Appendix" title="ppb.png" href="Gridding_irregularly_spaced_databf10.html?action=AttachFile&amp;do=view&amp;target=ppb.png">
<link rel="Appendix" title="ppb_raw.png" href="Gridding_irregularly_spaced_data98c3.html?action=AttachFile&amp;do=view&amp;target=ppb_raw.png">
<link rel="Appendix" title="raw.png" href="Gridding_irregularly_spaced_datad8c3.html?action=AttachFile&amp;do=view&amp;target=raw.png">
<link rel="Appendix" title="raw_small" href="Gridding_irregularly_spaced_datae219.html?action=AttachFile&amp;do=view&amp;target=raw_small">
<link rel="Appendix" title="raw_small.png" href="Gridding_irregularly_spaced_data9c22.html?action=AttachFile&amp;do=view&amp;target=raw_small.png">
<link rel="Appendix" title="unbinned_data.png" href="Gridding_irregularly_spaced_dataaf09.html?action=AttachFile&amp;do=view&amp;target=unbinned_data.png">
<link rel="Search" href="../../FindPage.html">
<link rel="Index" href="../../TitleIndex.html">
<link rel="Glossary" href="../../WordIndex.html">
<link rel="Help" href="../../HelpOnFormatting.html">
</head>

<body  lang="en" dir="ltr">

<div id="header">


<form id="searchform" method="get" action="../../../external.html?link=http://localhost:8080/Cookbook/Matplotlib/Gridding_irregularly_spaced_data">
<div>
<input type="hidden" name="action" value="fullsearch">
<input type="hidden" name="context" value="180">
<label for="searchinput">Search:</label>
<input id="searchinput" type="text" name="value" value="" size="20"
    onfocus="searchFocus(this)" onblur="searchBlur(this)"
    onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search">
<input id="titlesearch" name="titlesearch" type="submit"
    value="Titles" alt="Search Titles">
<input id="fullsearch" name="fullsearch" type="submit"
    value="Text" alt="Search Full Text">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<ul id="username"><li><a href="Gridding_irregularly_spaced_data456e.html?action=login" id="login" rel="nofollow">Login</a></li></ul>
<div id="locationline">
<div id="interwiki"><span><a href="../../AllPages.html" rel="nofollow">SciPy</a></span></div>

<ul id="pagelocation">
<li><a href="../../Cookbook.html">Cookbook</a></li><li><a href="../Matplotlib.html">Matplotlib</a></li><li><a class="backlink" href="Gridding_irregularly_spaced_data6bb9.html?action=fullsearch&amp;context=180&amp;value=linkto%3A%22Cookbook%2FMatplotlib%2FGridding_irregularly_spaced_data%22" rel="nofollow" title="Click to do a full-text search for this title">Gridding_irregularly_spaced_data</a></li>
</ul>

</div>


<ul id="navibar">
<li class="wikilink"><a href="../../RecentChanges.html">RecentChanges</a></li><li class="wikilink"><a class="nonexistent" href="../../FindPage.html">FindPage</a></li><li class="wikilink"><a class="nonexistent" href="../../HelpContents.html">HelpContents</a></li><li class="current"><a href="Gridding_irregularly_spaced_data.html">Gridding_ir...spaced_data</a></li>
</ul>

<div id="pageline"><hr style="display:none;"></div>

<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="Gridding_irregularly_spaced_data37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../../../external.html?link=http://localhost:8080/Cookbook/Matplotlib/Gridding_irregularly_spaced_data">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

</div>

<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><p class="line874">A commonly asked question on the matplotlib mailing lists is &quot;how do I make a contour plot of my irregularly spaced data?&quot;.  The answer is, first you interpolate it to a regular grid.  As of version 0.98.3, matplotlib provides a griddata function that behaves similarly to the matlab version.  It performs &quot;natural neighbor interpolation&quot; of irregularly spaced data a regular grid, which you can then plot with contour, imshow or pcolor.   <span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><p class="line867">
<h2 id="Example_1">Example 1</h2>
<span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span><p class="line874">This requires Scipy 0.9: <span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><p class="line867"><span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span><span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span><span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span><span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span><span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span><span class="anchor" id="line-29"></span><span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span><span class="anchor" id="line-34"></span><span class="anchor" id="line-1-1"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
function isnumbered(obj) {
  return obj.childNodes.length && obj.firstChild.childNodes.length && obj.firstChild.firstChild.className == 'LineNumber';
}
function nformat(num,chrs,add) {
  var nlen = Math.max(0,chrs-(''+num).length), res = '';
  while (nlen>0) { res += ' '; nlen-- }
  return res+num+add;
}
function addnumber(did, nstart, nstep) {
  var c = document.getElementById(did), l = c.firstChild, n = 1;
  if (!isnumbered(c)) {
    if (typeof nstart == 'undefined') nstart = 1;
    if (typeof nstep  == 'undefined') nstep = 1;
    var n = nstart;
    while (l != null) {
      if (l.tagName == 'SPAN') {
        var s = document.createElement('SPAN');
        var a = document.createElement('A');
        s.className = 'LineNumber';
        a.appendChild(document.createTextNode(nformat(n,4,'')));
        a.href = '#' + did + '_' + n;
        s.appendChild(a);
        s.appendChild(document.createTextNode(' '));
        n += nstep;
        if (l.childNodes.length) {
          l.insertBefore(s, l.firstChild);
        }
        else {
          l.appendChild(s);
        }
      }
      l = l.nextSibling;
    }
  }
  return false;
}
function remnumber(did) {
  var c = document.getElementById(did), l = c.firstChild;
  if (isnumbered(c)) {
    while (l != null) {
      if (l.tagName == 'SPAN' && l.firstChild.className == 'LineNumber') l.removeChild(l.firstChild);
      l = l.nextSibling;
    }
  }
  return false;
}
function togglenumber(did, nstart, nstep) {
  var c = document.getElementById(did);
  if (isnumbered(c)) {
    remnumber(did);
  } else {
    addnumber(did,nstart,nstep);
  }
  return false;
}
</script>

<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-eba2b37ec77ae1f2a9984b431d718f2455e23202\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_1">   1</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_1"></span><span class="anchor" id="line-1-2"></span><span class="ResWord">import</span> <span class="ID">numpy</span> <span class="ResWord">as</span> <span class="ID">np</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_2">   2</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_2"></span><span class="anchor" id="line-2-1"></span><span class="ResWord">from</span> <span class="ID">scipy.interpolate</span> <span class="ResWord">import</span> <span class="ID">griddata</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_3">   3</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_3"></span><span class="anchor" id="line-3-1"></span><span class="ResWord">import</span> <span class="ID">matplotlib.pyplot</span> <span class="ResWord">as</span> <span class="ID">plt</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_4">   4</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_4"></span><span class="anchor" id="line-4-1"></span><span class="ResWord">import</span> <span class="ID">numpy.ma</span> <span class="ResWord">as</span> <span class="ID">ma</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_5">   5</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_5"></span><span class="anchor" id="line-5-1"></span><span class="ResWord">from</span> <span class="ID">numpy.random</span> <span class="ResWord">import</span> <span class="ID">uniform</span>, <span class="ID">seed</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_6">   6</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_6"></span><span class="anchor" id="line-6-1"></span><span class="Comment"># make up some randomly distributed data</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_7">   7</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_7"></span><span class="anchor" id="line-7-1"></span><span class="ID">seed</span>(<span class="Number">1234</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_8">   8</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_8"></span><span class="anchor" id="line-8-1"></span><span class="ID">npts</span> = <span class="Number">200</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_9">   9</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_9"></span><span class="anchor" id="line-9-1"></span><span class="ID">x</span> = <span class="ID">uniform</span>(-<span class="Number">2</span>,<span class="Number">2</span>,<span class="ID">npts</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_10">  10</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_10"></span><span class="anchor" id="line-10-1"></span><span class="ID">y</span> = <span class="ID">uniform</span>(-<span class="Number">2</span>,<span class="Number">2</span>,<span class="ID">npts</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_11">  11</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_11"></span><span class="anchor" id="line-11-1"></span><span class="ID">z</span> = <span class="ID">x</span>*<span class="ID">np</span>.<span class="ID">exp</span>(-<span class="ID">x</span>**<span class="Number">2</span>-<span class="ID">y</span>**<span class="Number">2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_12">  12</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_12"></span><span class="anchor" id="line-12-1"></span><span class="Comment"># define grid.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_13">  13</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_13"></span><span class="anchor" id="line-13-1"></span><span class="ID">xi</span> = <span class="ID">np</span>.<span class="ID">linspace</span>(-<span class="Number">2.1</span>,<span class="Number">2.1</span>,<span class="Number">100</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_14">  14</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_14"></span><span class="anchor" id="line-14-1"></span><span class="ID">yi</span> = <span class="ID">np</span>.<span class="ID">linspace</span>(-<span class="Number">2.1</span>,<span class="Number">2.1</span>,<span class="Number">100</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_15">  15</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_15"></span><span class="anchor" id="line-15-1"></span><span class="Comment"># grid the data.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_16">  16</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_16"></span><span class="anchor" id="line-16-1"></span><span class="ID">zi</span> = <span class="ID">griddata</span>((<span class="ID">x</span>, <span class="ID">y</span>), <span class="ID">z</span>, (<span class="ID">xi</span>[<span class="ResWord">None</span>,:], <span class="ID">yi</span>[:,<span class="ResWord">None</span>]), <span class="ID">method</span>=<span class="String">'</span><span class="String">cubic</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_17">  17</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_17"></span><span class="anchor" id="line-17-1"></span><span class="Comment"># contour the gridded data, plotting dots at the randomly spaced data points.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_18">  18</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_18"></span><span class="anchor" id="line-18-1"></span><span class="ID">CS</span> = <span class="ID">plt</span>.<span class="ID">contour</span>(<span class="ID">xi</span>,<span class="ID">yi</span>,<span class="ID">zi</span>,<span class="Number">15</span>,<span class="ID">linewidths</span>=<span class="Number">0.5</span>,<span class="ID">colors</span>=<span class="String">'</span><span class="String">k</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_19">  19</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_19"></span><span class="anchor" id="line-19-1"></span><span class="ID">CS</span> = <span class="ID">plt</span>.<span class="ID">contourf</span>(<span class="ID">xi</span>,<span class="ID">yi</span>,<span class="ID">zi</span>,<span class="Number">15</span>,<span class="ID">cmap</span>=<span class="ID">plt</span>.<span class="ID">cm</span>.<span class="ID">jet</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_20">  20</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_20"></span><span class="anchor" id="line-20-1"></span><span class="ID">plt</span>.<span class="ID">colorbar</span>() <span class="Comment"># draw colorbar</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_21">  21</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_21"></span><span class="anchor" id="line-21-1"></span><span class="Comment"># plot data points.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_22">  22</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_22"></span><span class="anchor" id="line-22-1"></span><span class="ID">plt</span>.<span class="ID">scatter</span>(<span class="ID">x</span>,<span class="ID">y</span>,<span class="ID">marker</span>=<span class="String">'</span><span class="String">o</span><span class="String">'</span>,<span class="ID">c</span>=<span class="String">'</span><span class="String">b</span><span class="String">'</span>,<span class="ID">s</span>=<span class="Number">5</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_23">  23</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_23"></span><span class="anchor" id="line-23-1"></span><span class="ID">plt</span>.<span class="ID">xlim</span>(-<span class="Number">2</span>,<span class="Number">2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_24">  24</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_24"></span><span class="anchor" id="line-24-1"></span><span class="ID">plt</span>.<span class="ID">ylim</span>(-<span class="Number">2</span>,<span class="Number">2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_25">  25</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_25"></span><span class="anchor" id="line-25-1"></span><span class="ID">plt</span>.<span class="ID">title</span>(<span class="String">'</span><span class="String">griddata test (</span><span class="String">%d</span><span class="String"> points)</span><span class="String">'</span> % <span class="ID">npts</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_26">  26</a> </span><span class="LineAnchor" id="CA-eba2b37ec77ae1f2a9984b431d718f2455e23202_26"></span><span class="anchor" id="line-26-1"></span><span class="ID">plt</span>.<span class="ID">show</span>()</span>
</pre></div></div><span class="anchor" id="line-35"></span><span class="anchor" id="line-36"></span><p class="line867"><img alt="griddataexample1.png" class="attachment" src="griddataexample1eaee.png?action=AttachFile&amp;do=get&amp;target=griddataexample1.png" title="griddataexample1.png" /> <span class="anchor" id="line-37"></span><span class="anchor" id="line-38"></span><p class="line867">
<h2 id="Example_2">Example 2</h2>
<span class="anchor" id="line-39"></span><span class="anchor" id="line-40"></span><p class="line867"><span class="anchor" id="line-41"></span><span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span><span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span><span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span><span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span><span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span><span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span><span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span><span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span><span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span><span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span><span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span><span class="anchor" id="line-66"></span><span class="anchor" id="line-1-3"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-2876d579c0d16bc21296bf266c8f879584acfebe\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_1">   1</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_1"></span><span class="anchor" id="line-1-4"></span><span class="ResWord">import</span> <span class="ID">numpy</span> <span class="ResWord">as</span> <span class="ID">np</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_2">   2</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_2"></span><span class="anchor" id="line-2-2"></span><span class="ResWord">from</span> <span class="ID">matplotlib.mlab</span> <span class="ResWord">import</span> <span class="ID">griddata</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_3">   3</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_3"></span><span class="anchor" id="line-3-2"></span><span class="ResWord">import</span> <span class="ID">matplotlib.pyplot</span> <span class="ResWord">as</span> <span class="ID">plt</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_4">   4</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_4"></span><span class="anchor" id="line-4-2"></span><span class="ResWord">import</span> <span class="ID">numpy.ma</span> <span class="ResWord">as</span> <span class="ID">ma</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_5">   5</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_5"></span><span class="anchor" id="line-5-2"></span><span class="ResWord">from</span> <span class="ID">numpy.random</span> <span class="ResWord">import</span> <span class="ID">uniform</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_6">   6</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_6"></span><span class="anchor" id="line-6-2"></span><span class="Comment"># make up some randomly distributed data</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_7">   7</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_7"></span><span class="anchor" id="line-7-2"></span><span class="ID">npts</span> = <span class="Number">200</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_8">   8</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_8"></span><span class="anchor" id="line-8-2"></span><span class="ID">x</span> = <span class="ID">uniform</span>(-<span class="Number">2</span>,<span class="Number">2</span>,<span class="ID">npts</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_9">   9</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_9"></span><span class="anchor" id="line-9-2"></span><span class="ID">y</span> = <span class="ID">uniform</span>(-<span class="Number">2</span>,<span class="Number">2</span>,<span class="ID">npts</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_10">  10</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_10"></span><span class="anchor" id="line-10-2"></span><span class="ID">z</span> = <span class="ID">x</span>*<span class="ID">np</span>.<span class="ID">exp</span>(-<span class="ID">x</span>**<span class="Number">2</span>-<span class="ID">y</span>**<span class="Number">2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_11">  11</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_11"></span><span class="anchor" id="line-11-2"></span><span class="Comment"># define grid.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_12">  12</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_12"></span><span class="anchor" id="line-12-2"></span><span class="ID">xi</span> = <span class="ID">np</span>.<span class="ID">linspace</span>(-<span class="Number">2.1</span>,<span class="Number">2.1</span>,<span class="Number">100</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_13">  13</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_13"></span><span class="anchor" id="line-13-2"></span><span class="ID">yi</span> = <span class="ID">np</span>.<span class="ID">linspace</span>(-<span class="Number">2.1</span>,<span class="Number">2.1</span>,<span class="Number">100</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_14">  14</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_14"></span><span class="anchor" id="line-14-2"></span><span class="Comment"># grid the data.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_15">  15</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_15"></span><span class="anchor" id="line-15-2"></span><span class="ID">zi</span> = <span class="ID">griddata</span>(<span class="ID">x</span>,<span class="ID">y</span>,<span class="ID">z</span>,<span class="ID">xi</span>,<span class="ID">yi</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_16">  16</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_16"></span><span class="anchor" id="line-16-2"></span><span class="Comment"># contour the gridded data, plotting dots at the randomly spaced data points.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_17">  17</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_17"></span><span class="anchor" id="line-17-2"></span><span class="ID">CS</span> = <span class="ID">plt</span>.<span class="ID">contour</span>(<span class="ID">xi</span>,<span class="ID">yi</span>,<span class="ID">zi</span>,<span class="Number">15</span>,<span class="ID">linewidths</span>=<span class="Number">0.5</span>,<span class="ID">colors</span>=<span class="String">'</span><span class="String">k</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_18">  18</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_18"></span><span class="anchor" id="line-18-2"></span><span class="ID">CS</span> = <span class="ID">plt</span>.<span class="ID">contourf</span>(<span class="ID">xi</span>,<span class="ID">yi</span>,<span class="ID">zi</span>,<span class="Number">15</span>,<span class="ID">cmap</span>=<span class="ID">plt</span>.<span class="ID">cm</span>.<span class="ID">jet</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_19">  19</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_19"></span><span class="anchor" id="line-19-2"></span><span class="ID">plt</span>.<span class="ID">colorbar</span>() <span class="Comment"># draw colorbar</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_20">  20</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_20"></span><span class="anchor" id="line-20-2"></span><span class="Comment"># plot data points.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_21">  21</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_21"></span><span class="anchor" id="line-21-2"></span><span class="ID">plt</span>.<span class="ID">scatter</span>(<span class="ID">x</span>,<span class="ID">y</span>,<span class="ID">marker</span>=<span class="String">'</span><span class="String">o</span><span class="String">'</span>,<span class="ID">c</span>=<span class="String">'</span><span class="String">b</span><span class="String">'</span>,<span class="ID">s</span>=<span class="Number">5</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_22">  22</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_22"></span><span class="anchor" id="line-22-2"></span><span class="ID">plt</span>.<span class="ID">xlim</span>(-<span class="Number">2</span>,<span class="Number">2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_23">  23</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_23"></span><span class="anchor" id="line-23-2"></span><span class="ID">plt</span>.<span class="ID">ylim</span>(-<span class="Number">2</span>,<span class="Number">2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_24">  24</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_24"></span><span class="anchor" id="line-24-2"></span><span class="ID">plt</span>.<span class="ID">title</span>(<span class="String">'</span><span class="String">griddata test (</span><span class="String">%d</span><span class="String"> points)</span><span class="String">'</span> % <span class="ID">npts</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-2876d579c0d16bc21296bf266c8f879584acfebe_25">  25</a> </span><span class="LineAnchor" id="CA-2876d579c0d16bc21296bf266c8f879584acfebe_25"></span><span class="anchor" id="line-25-2"></span><span class="ID">plt</span>.<span class="ID">show</span>()</span>
</pre></div></div><span class="anchor" id="line-67"></span><span class="anchor" id="line-68"></span><p class="line874">By default, griddata uses the scikits delaunay package (included in matplotlib) to do the natural neighbor interpolation.  Unfortunately, the delaunay package is known to fail for some nearly pathological cases.  If you run into one of those cases, you can install the matplotlib natgrid toolkit.  Once that is installed, the griddata function will use it instead of delaunay to do the interpolation.  The natgrid algorithm is a bit more robust, but cannot be included in matplotlib proper because of licensing issues.  <span class="anchor" id="line-69"></span><span class="anchor" id="line-70"></span><p class="line862">The radial basis function module in the scipy sandbox can also be used to interpolate/smooth scattered data in n dimensions. See <a href="../RadialBasisFunctions.html"><strong class="highlight">Cookbook</strong>/RadialBasisFunctions</a> for details. <span class="anchor" id="line-71"></span><span class="anchor" id="line-72"></span><p class="line867">
<h2 id="Example_3">Example 3</h2>
<span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span><p class="line874">A less robust but perhaps more intuitive method is presented in the code below.  This function takes three 1D arrays, namely two independent data arrays and one dependent data array and bins them into a 2D grid.  On top of that, the code also returns two other grids, one where each binned value represents the number of points in that bin and another in which each bin contains the indices of the original dependent array which are contained in that bin.  These can be further used for interpolation between bins if necessary. <span class="anchor" id="line-75"></span><span class="anchor" id="line-76"></span><p class="line874">The is essentially an Occam's Razor approach to the matplotlib.mlab griddata function, as both produce similar results. <span class="anchor" id="line-77"></span><span class="anchor" id="line-78"></span><p class="line867"><span class="anchor" id="line-79"></span><span class="anchor" id="line-80"></span><span class="anchor" id="line-81"></span><span class="anchor" id="line-82"></span><span class="anchor" id="line-83"></span><span class="anchor" id="line-84"></span><span class="anchor" id="line-85"></span><span class="anchor" id="line-86"></span><span class="anchor" id="line-87"></span><span class="anchor" id="line-88"></span><span class="anchor" id="line-89"></span><span class="anchor" id="line-90"></span><span class="anchor" id="line-91"></span><span class="anchor" id="line-92"></span><span class="anchor" id="line-93"></span><span class="anchor" id="line-94"></span><span class="anchor" id="line-95"></span><span class="anchor" id="line-96"></span><span class="anchor" id="line-97"></span><span class="anchor" id="line-98"></span><span class="anchor" id="line-99"></span><span class="anchor" id="line-100"></span><span class="anchor" id="line-101"></span><span class="anchor" id="line-102"></span><span class="anchor" id="line-103"></span><span class="anchor" id="line-104"></span><span class="anchor" id="line-105"></span><span class="anchor" id="line-106"></span><span class="anchor" id="line-107"></span><span class="anchor" id="line-108"></span><span class="anchor" id="line-109"></span><span class="anchor" id="line-110"></span><span class="anchor" id="line-111"></span><span class="anchor" id="line-112"></span><span class="anchor" id="line-113"></span><span class="anchor" id="line-114"></span><span class="anchor" id="line-115"></span><span class="anchor" id="line-116"></span><span class="anchor" id="line-117"></span><span class="anchor" id="line-118"></span><span class="anchor" id="line-119"></span><span class="anchor" id="line-120"></span><span class="anchor" id="line-121"></span><span class="anchor" id="line-122"></span><span class="anchor" id="line-123"></span><span class="anchor" id="line-124"></span><span class="anchor" id="line-125"></span><span class="anchor" id="line-126"></span><span class="anchor" id="line-127"></span><span class="anchor" id="line-128"></span><span class="anchor" id="line-129"></span><span class="anchor" id="line-130"></span><span class="anchor" id="line-131"></span><span class="anchor" id="line-132"></span><span class="anchor" id="line-133"></span><span class="anchor" id="line-134"></span><span class="anchor" id="line-135"></span><span class="anchor" id="line-136"></span><span class="anchor" id="line-137"></span><span class="anchor" id="line-138"></span><span class="anchor" id="line-139"></span><span class="anchor" id="line-140"></span><span class="anchor" id="line-141"></span><span class="anchor" id="line-142"></span><span class="anchor" id="line-143"></span><span class="anchor" id="line-144"></span><span class="anchor" id="line-145"></span><span class="anchor" id="line-146"></span><span class="anchor" id="line-147"></span><span class="anchor" id="line-148"></span><span class="anchor" id="line-149"></span><span class="anchor" id="line-150"></span><span class="anchor" id="line-151"></span><span class="anchor" id="line-152"></span><span class="anchor" id="line-153"></span><span class="anchor" id="line-154"></span><span class="anchor" id="line-155"></span><span class="anchor" id="line-156"></span><span class="anchor" id="line-157"></span><span class="anchor" id="line-158"></span><span class="anchor" id="line-159"></span><span class="anchor" id="line-160"></span><span class="anchor" id="line-161"></span><span class="anchor" id="line-162"></span><span class="anchor" id="line-163"></span><span class="anchor" id="line-164"></span><span class="anchor" id="line-165"></span><span class="anchor" id="line-166"></span><span class="anchor" id="line-167"></span><span class="anchor" id="line-168"></span><span class="anchor" id="line-169"></span><span class="anchor" id="line-170"></span><span class="anchor" id="line-171"></span><span class="anchor" id="line-172"></span><span class="anchor" id="line-173"></span><span class="anchor" id="line-174"></span><span class="anchor" id="line-175"></span><span class="anchor" id="line-176"></span><span class="anchor" id="line-1-5"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_1">   1</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_1"></span><span class="anchor" id="line-1-6"></span><span class="Comment"># griddata.py - 2010-07-11 ccampo</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_2">   2</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_2"></span><span class="anchor" id="line-2-3"></span><span class="ResWord">import</span> <span class="ID">numpy</span> <span class="ResWord">as</span> <span class="ID">np</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_3">   3</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_3"></span><span class="anchor" id="line-3-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_4">   4</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_4"></span><span class="anchor" id="line-4-3"></span><span class="ResWord">def</span> <span class="ID">griddata</span>(<span class="ID">x</span>, <span class="ID">y</span>, <span class="ID">z</span>, <span class="ID">binsize</span>=<span class="Number">0.01</span>, <span class="ID">retbin</span>=<span class="ResWord">True</span>, <span class="ID">retloc</span>=<span class="ResWord">True</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_5">   5</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_5"></span><span class="anchor" id="line-5-3"></span>    <span class="String">&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_6">   6</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_6"></span><span class="anchor" id="line-6-3"></span><span class="String">    Place unevenly spaced 2D data on a grid by 2D binning (nearest</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_7">   7</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_7"></span><span class="anchor" id="line-7-3"></span><span class="String">    neighbor interpolation).</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_8">   8</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_8"></span><span class="anchor" id="line-8-3"></span><span class="String">    </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_9">   9</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_9"></span><span class="anchor" id="line-9-3"></span><span class="String">    Parameters</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_10">  10</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_10"></span><span class="anchor" id="line-10-3"></span><span class="String">    ----------</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_11">  11</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_11"></span><span class="anchor" id="line-11-3"></span><span class="String">    x : ndarray (1D)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_12">  12</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_12"></span><span class="anchor" id="line-12-3"></span><span class="String">        The idependent data x-axis of the grid.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_13">  13</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_13"></span><span class="anchor" id="line-13-3"></span><span class="String">    y : ndarray (1D)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_14">  14</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_14"></span><span class="anchor" id="line-14-3"></span><span class="String">        The idependent data y-axis of the grid.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_15">  15</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_15"></span><span class="anchor" id="line-15-3"></span><span class="String">    z : ndarray (1D)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_16">  16</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_16"></span><span class="anchor" id="line-16-3"></span><span class="String">        The dependent data in the form z = f(x,y).</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_17">  17</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_17"></span><span class="anchor" id="line-17-3"></span><span class="String">    binsize : scalar, optional</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_18">  18</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_18"></span><span class="anchor" id="line-18-3"></span><span class="String">        The full width and height of each bin on the grid.  If each</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_19">  19</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_19"></span><span class="anchor" id="line-19-3"></span><span class="String">        bin is a cube, then this is the x and y dimension.  This is</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_20">  20</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_20"></span><span class="anchor" id="line-20-3"></span><span class="String">        the step in both directions, x and y. Defaults to 0.01.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_21">  21</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_21"></span><span class="anchor" id="line-21-3"></span><span class="String">    retbin : boolean, optional</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_22">  22</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_22"></span><span class="anchor" id="line-22-3"></span><span class="String">        Function returns `bins` variable (see below for description)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_23">  23</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_23"></span><span class="anchor" id="line-23-3"></span><span class="String">        if set to True.  Defaults to True.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_24">  24</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_24"></span><span class="anchor" id="line-24-3"></span><span class="String">    retloc : boolean, optional</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_25">  25</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_25"></span><span class="anchor" id="line-25-3"></span><span class="String">        Function returns `wherebins` variable (see below for description)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_26">  26</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_26"></span><span class="anchor" id="line-26-2"></span><span class="String">        if set to True.  Defaults to True.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_27">  27</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_27"></span><span class="anchor" id="line-27-1"></span><span class="String">   </span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_28">  28</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_28"></span><span class="anchor" id="line-28-1"></span><span class="String">    Returns</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_29">  29</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_29"></span><span class="anchor" id="line-29-1"></span><span class="String">    -------</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_30">  30</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_30"></span><span class="anchor" id="line-30-1"></span><span class="String">    grid : ndarray (2D)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_31">  31</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_31"></span><span class="anchor" id="line-31-1"></span><span class="String">        The evenly gridded data.  The value of each cell is the median</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_32">  32</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_32"></span><span class="anchor" id="line-32-1"></span><span class="String">        value of the contents of the bin.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_33">  33</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_33"></span><span class="anchor" id="line-33-1"></span><span class="String">    bins : ndarray (2D)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_34">  34</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_34"></span><span class="anchor" id="line-34-1"></span><span class="String">        A grid the same shape as `grid`, except the value of each cell</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_35">  35</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_35"></span><span class="anchor" id="line-35-1"></span><span class="String">        is the number of points in that bin.  Returns only if</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_36">  36</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_36"></span><span class="anchor" id="line-36-1"></span><span class="String">        `retbin` is set to True.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_37">  37</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_37"></span><span class="anchor" id="line-37-1"></span><span class="String">    wherebin : list (2D)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_38">  38</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_38"></span><span class="anchor" id="line-38-1"></span><span class="String">        A 2D list the same shape as `grid` and `bins` where each cell</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_39">  39</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_39"></span><span class="anchor" id="line-39-1"></span><span class="String">        contains the indicies of `z` which contain the values stored</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_40">  40</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_40"></span><span class="anchor" id="line-40-1"></span><span class="String">        in the particular bin.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_41">  41</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_41"></span><span class="anchor" id="line-41-1"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_42">  42</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_42"></span><span class="anchor" id="line-42-1"></span><span class="String">    Revisions</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_43">  43</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_43"></span><span class="anchor" id="line-43-1"></span><span class="String">    ---------</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_44">  44</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_44"></span><span class="anchor" id="line-44-1"></span><span class="String">    2010-07-11  ccampo  Initial version</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_45">  45</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_45"></span><span class="anchor" id="line-45-1"></span><span class="String">    &quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_46">  46</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_46"></span><span class="anchor" id="line-46-1"></span>    <span class="Comment"># get extrema values.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_47">  47</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_47"></span><span class="anchor" id="line-47-1"></span>    <span class="ID">xmin</span>, <span class="ID">xmax</span> = <span class="ID">x</span>.<span class="ID">min</span>(), <span class="ID">x</span>.<span class="ID">max</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_48">  48</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_48"></span><span class="anchor" id="line-48-1"></span>    <span class="ID">ymin</span>, <span class="ID">ymax</span> = <span class="ID">y</span>.<span class="ID">min</span>(), <span class="ID">y</span>.<span class="ID">max</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_49">  49</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_49"></span><span class="anchor" id="line-49-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_50">  50</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_50"></span><span class="anchor" id="line-50-1"></span>    <span class="Comment"># make coordinate arrays.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_51">  51</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_51"></span><span class="anchor" id="line-51-1"></span>    <span class="ID">xi</span>      = <span class="ID">np</span>.<span class="ID">arange</span>(<span class="ID">xmin</span>, <span class="ID">xmax</span>+<span class="ID">binsize</span>, <span class="ID">binsize</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_52">  52</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_52"></span><span class="anchor" id="line-52-1"></span>    <span class="ID">yi</span>      = <span class="ID">np</span>.<span class="ID">arange</span>(<span class="ID">ymin</span>, <span class="ID">ymax</span>+<span class="ID">binsize</span>, <span class="ID">binsize</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_53">  53</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_53"></span><span class="anchor" id="line-53-1"></span>    <span class="ID">xi</span>, <span class="ID">yi</span> = <span class="ID">np</span>.<span class="ID">meshgrid</span>(<span class="ID">xi</span>,<span class="ID">yi</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_54">  54</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_54"></span><span class="anchor" id="line-54-1"></span>    </span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_55">  55</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_55"></span><span class="anchor" id="line-55-1"></span>    <span class="Comment"># make the grid.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_56">  56</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_56"></span><span class="anchor" id="line-56-1"></span>    <span class="ID">grid</span>           = <span class="ID">np</span>.<span class="ID">zeros</span>(<span class="ID">xi</span>.<span class="ID">shape</span>, <span class="ID">dtype</span>=<span class="ID">x</span>.<span class="ID">dtype</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_57">  57</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_57"></span><span class="anchor" id="line-57-1"></span>    <span class="ID">nrow</span>, <span class="ID">ncol</span> = <span class="ID">grid</span>.<span class="ID">shape</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_58">  58</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_58"></span><span class="anchor" id="line-58-1"></span>    <span class="ResWord">if</span> <span class="ID">retbin</span>: <span class="ID">bins</span> = <span class="ID">np</span>.<span class="ID">copy</span>(<span class="ID">grid</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_59">  59</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_59"></span><span class="anchor" id="line-59-1"></span>    </span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_60">  60</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_60"></span><span class="anchor" id="line-60-1"></span>    <span class="Comment"># create list in same shape as grid to store indices</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_61">  61</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_61"></span><span class="anchor" id="line-61-1"></span>    <span class="ResWord">if</span> <span class="ID">retloc</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_62">  62</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_62"></span><span class="anchor" id="line-62-1"></span>        <span class="ID">wherebin</span> = <span class="ID">np</span>.<span class="ID">copy</span>(<span class="ID">grid</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_63">  63</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_63"></span><span class="anchor" id="line-63-1"></span>        <span class="ID">wherebin</span> = <span class="ID">wherebin</span>.<span class="ID">tolist</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_64">  64</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_64"></span><span class="anchor" id="line-64-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_65">  65</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_65"></span><span class="anchor" id="line-65-1"></span>    <span class="Comment"># fill in the grid.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_66">  66</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_66"></span><span class="anchor" id="line-66-1"></span>    <span class="ResWord">for</span> <span class="ID">row</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ID">nrow</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_67">  67</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_67"></span><span class="anchor" id="line-67-1"></span>        <span class="ResWord">for</span> <span class="ID">col</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="ID">ncol</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_68">  68</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_68"></span><span class="anchor" id="line-68-1"></span>            <span class="ID">xc</span> = <span class="ID">xi</span>[<span class="ID">row</span>, <span class="ID">col</span>]    <span class="Comment"># x coordinate.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_69">  69</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_69"></span><span class="anchor" id="line-69-1"></span>            <span class="ID">yc</span> = <span class="ID">yi</span>[<span class="ID">row</span>, <span class="ID">col</span>]    <span class="Comment"># y coordinate.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_70">  70</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_70"></span><span class="anchor" id="line-70-1"></span>    </span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_71">  71</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_71"></span><span class="anchor" id="line-71-1"></span>            <span class="Comment"># find the position that xc and yc correspond to.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_72">  72</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_72"></span><span class="anchor" id="line-72-1"></span>            <span class="ID">posx</span> = <span class="ID">np</span>.<span class="ID">abs</span>(<span class="ID">x</span> - <span class="ID">xc</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_73">  73</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_73"></span><span class="anchor" id="line-73-1"></span>            <span class="ID">posy</span> = <span class="ID">np</span>.<span class="ID">abs</span>(<span class="ID">y</span> - <span class="ID">yc</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_74">  74</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_74"></span><span class="anchor" id="line-74-1"></span>            <span class="ID">ibin</span> = <span class="ID">np</span>.<span class="ID">logical_and</span>(<span class="ID">posx</span> &lt; <span class="ID">binsize</span>/<span class="Number">2.</span>, <span class="ID">posy</span> &lt; <span class="ID">binsize</span>/<span class="Number">2.</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_75">  75</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_75"></span><span class="anchor" id="line-75-1"></span>            <span class="ID">ind</span>  = <span class="ID">np</span>.<span class="ID">where</span>(<span class="ID">ibin</span> == <span class="ResWord">True</span>)[<span class="Number">0</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_76">  76</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_76"></span><span class="anchor" id="line-76-1"></span>            </span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_77">  77</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_77"></span><span class="anchor" id="line-77-1"></span>            <span class="Comment"># fill the bin.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_78">  78</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_78"></span><span class="anchor" id="line-78-1"></span>            <span class="ResWord">bin</span> = <span class="ID">z</span>[<span class="ID">ibin</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_79">  79</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_79"></span><span class="anchor" id="line-79-1"></span>            <span class="ResWord">if</span> <span class="ID">retloc</span>: <span class="ID">wherebin</span>[<span class="ID">row</span>][<span class="ID">col</span>] = <span class="ID">ind</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_80">  80</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_80"></span><span class="anchor" id="line-80-1"></span>            <span class="ResWord">if</span> <span class="ID">retbin</span>: <span class="ID">bins</span>[<span class="ID">row</span>, <span class="ID">col</span>] = <span class="ResWord">bin</span>.<span class="ID">size</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_81">  81</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_81"></span><span class="anchor" id="line-81-1"></span>            <span class="ResWord">if</span> <span class="ResWord">bin</span>.<span class="ID">size</span> != <span class="Number">0</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_82">  82</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_82"></span><span class="anchor" id="line-82-1"></span>                <span class="ID">binval</span>         = <span class="ID">np</span>.<span class="ID">median</span>(<span class="ResWord">bin</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_83">  83</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_83"></span><span class="anchor" id="line-83-1"></span>                <span class="ID">grid</span>[<span class="ID">row</span>, <span class="ID">col</span>] = <span class="ID">binval</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_84">  84</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_84"></span><span class="anchor" id="line-84-1"></span>            <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_85">  85</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_85"></span><span class="anchor" id="line-85-1"></span>                <span class="ID">grid</span>[<span class="ID">row</span>, <span class="ID">col</span>] = <span class="ID">np</span>.<span class="ID">nan</span>   <span class="Comment"># fill empty bins with nans.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_86">  86</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_86"></span><span class="anchor" id="line-86-1"></span>    </span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_87">  87</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_87"></span><span class="anchor" id="line-87-1"></span>    <span class="Comment"># return the grid</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_88">  88</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_88"></span><span class="anchor" id="line-88-1"></span>    <span class="ResWord">if</span> <span class="ID">retbin</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_89">  89</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_89"></span><span class="anchor" id="line-89-1"></span>        <span class="ResWord">if</span> <span class="ID">retloc</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_90">  90</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_90"></span><span class="anchor" id="line-90-1"></span>            <span class="ResWord">return</span> <span class="ID">grid</span>, <span class="ID">bins</span>, <span class="ID">wherebin</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_91">  91</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_91"></span><span class="anchor" id="line-91-1"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_92">  92</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_92"></span><span class="anchor" id="line-92-1"></span>            <span class="ResWord">return</span> <span class="ID">grid</span>, <span class="ID">bins</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_93">  93</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_93"></span><span class="anchor" id="line-93-1"></span>    <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_94">  94</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_94"></span><span class="anchor" id="line-94-1"></span>        <span class="ResWord">if</span> <span class="ID">retloc</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_95">  95</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_95"></span><span class="anchor" id="line-95-1"></span>            <span class="ResWord">return</span> <span class="ID">grid</span>, <span class="ID">wherebin</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_96">  96</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_96"></span><span class="anchor" id="line-96-1"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_97">  97</a> </span><span class="LineAnchor" id="CA-13702a9994e40aa2e77e0ed8b4d1fec7431b774b_97"></span><span class="anchor" id="line-97-1"></span>            <span class="ResWord">return</span> <span class="ID">grid</span></span>
</pre></div></div><span class="anchor" id="line-177"></span><span class="anchor" id="line-178"></span><p class="line874">The following example demonstrates a usage of this method. <span class="anchor" id="line-179"></span><span class="anchor" id="line-180"></span><p class="line867"><span class="anchor" id="line-181"></span><span class="anchor" id="line-182"></span><span class="anchor" id="line-183"></span><span class="anchor" id="line-184"></span><span class="anchor" id="line-185"></span><span class="anchor" id="line-186"></span><span class="anchor" id="line-187"></span><span class="anchor" id="line-188"></span><span class="anchor" id="line-189"></span><span class="anchor" id="line-190"></span><span class="anchor" id="line-191"></span><span class="anchor" id="line-192"></span><span class="anchor" id="line-193"></span><span class="anchor" id="line-194"></span><span class="anchor" id="line-195"></span><span class="anchor" id="line-196"></span><span class="anchor" id="line-197"></span><span class="anchor" id="line-198"></span><span class="anchor" id="line-199"></span><span class="anchor" id="line-200"></span><span class="anchor" id="line-201"></span><span class="anchor" id="line-202"></span><span class="anchor" id="line-203"></span><span class="anchor" id="line-204"></span><span class="anchor" id="line-205"></span><span class="anchor" id="line-206"></span><span class="anchor" id="line-207"></span><span class="anchor" id="line-208"></span><span class="anchor" id="line-209"></span><span class="anchor" id="line-210"></span><span class="anchor" id="line-211"></span><span class="anchor" id="line-212"></span><span class="anchor" id="line-213"></span><span class="anchor" id="line-214"></span><span class="anchor" id="line-215"></span><span class="anchor" id="line-216"></span><span class="anchor" id="line-217"></span><span class="anchor" id="line-218"></span><span class="anchor" id="line-219"></span><span class="anchor" id="line-220"></span><span class="anchor" id="line-221"></span><span class="anchor" id="line-222"></span><span class="anchor" id="line-223"></span><span class="anchor" id="line-224"></span><span class="anchor" id="line-225"></span><span class="anchor" id="line-226"></span><span class="anchor" id="line-227"></span><span class="anchor" id="line-228"></span><span class="anchor" id="line-229"></span><span class="anchor" id="line-230"></span><span class="anchor" id="line-231"></span><span class="anchor" id="line-232"></span><span class="anchor" id="line-233"></span><span class="anchor" id="line-234"></span><span class="anchor" id="line-235"></span><span class="anchor" id="line-236"></span><span class="anchor" id="line-237"></span><span class="anchor" id="line-238"></span><span class="anchor" id="line-239"></span><span class="anchor" id="line-240"></span><span class="anchor" id="line-241"></span><span class="anchor" id="line-242"></span><span class="anchor" id="line-243"></span><span class="anchor" id="line-244"></span><span class="anchor" id="line-245"></span><span class="anchor" id="line-246"></span><span class="anchor" id="line-247"></span><span class="anchor" id="line-248"></span><span class="anchor" id="line-249"></span><span class="anchor" id="line-250"></span><span class="anchor" id="line-251"></span><span class="anchor" id="line-252"></span><span class="anchor" id="line-1-7"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-017333b90a16e7d9e1db3301a9e81c479ebc403c\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_1">   1</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_1"></span><span class="anchor" id="line-1-8"></span><span class="ResWord">import</span> <span class="ID">numpy</span> <span class="ResWord">as</span> <span class="ID">np</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_2">   2</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_2"></span><span class="anchor" id="line-2-4"></span><span class="ResWord">import</span> <span class="ID">matplotlib.pyplot</span> <span class="ResWord">as</span> <span class="ID">plt</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_3">   3</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_3"></span><span class="anchor" id="line-3-4"></span><span class="ResWord">import</span> <span class="ID">griddata</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_4">   4</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_4"></span><span class="anchor" id="line-4-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_5">   5</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_5"></span><span class="anchor" id="line-5-4"></span><span class="ID">npr</span> = <span class="ID">np</span>.<span class="ID">random</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_6">   6</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_6"></span><span class="anchor" id="line-6-4"></span><span class="ID">npts</span> = <span class="Number">3000.</span>                            <span class="Comment"># the total number of data points.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_7">   7</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_7"></span><span class="anchor" id="line-7-4"></span><span class="ID">x</span> = <span class="ID">npr</span>.<span class="ID">normal</span>(<span class="ID">size</span>=<span class="ID">npts</span>)            <span class="Comment"># create some normally distributed dependent data in x.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_8">   8</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_8"></span><span class="anchor" id="line-8-4"></span><span class="ID">y</span> = <span class="ID">npr</span>.<span class="ID">normal</span>(<span class="ID">size</span>=<span class="ID">npts</span>)            <span class="Comment"># ... do the same for y.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_9">   9</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_9"></span><span class="anchor" id="line-9-4"></span><span class="ID">zorig</span> = <span class="ID">x</span>**<span class="Number">2</span> + <span class="ID">y</span>**<span class="Number">2</span>                      <span class="Comment"># z is a function of the form z = f(x, y).</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_10">  10</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_10"></span><span class="anchor" id="line-10-4"></span><span class="ID">noise</span> = <span class="ID">npr</span>.<span class="ID">normal</span>(<span class="ID">scale</span>=<span class="Number">1.0</span>, <span class="ID">size</span>=<span class="ID">npts</span>) <span class="Comment"># add a good amount of noise</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_11">  11</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_11"></span><span class="anchor" id="line-11-4"></span><span class="ID">z</span> = <span class="ID">zorig</span> + <span class="ID">noise</span>                    <span class="Comment"># z = f(x, y) = x**2 + y**2</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_12">  12</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_12"></span><span class="anchor" id="line-12-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_13">  13</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_13"></span><span class="anchor" id="line-13-4"></span><span class="Comment"># plot some profiles / cross-sections for some visualization.  our</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_14">  14</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_14"></span><span class="anchor" id="line-14-4"></span><span class="Comment"># function is a symmetric, upward opening paraboloid z = x**2 + y**2.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_15">  15</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_15"></span><span class="anchor" id="line-15-4"></span><span class="Comment"># We expect it to be symmetric about and and y, attain a minimum on</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_16">  16</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_16"></span><span class="anchor" id="line-16-4"></span><span class="Comment"># the origin and display minor Gaussian noise.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_17">  17</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_17"></span><span class="anchor" id="line-17-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_18">  18</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_18"></span><span class="anchor" id="line-18-4"></span><span class="ID">plt</span>.<span class="ID">ion</span>()   <span class="Comment"># pyplot interactive mode on</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_19">  19</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_19"></span><span class="anchor" id="line-19-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_20">  20</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_20"></span><span class="anchor" id="line-20-4"></span><span class="Comment"># x vs z cross-section.  notice the noise.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_21">  21</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_21"></span><span class="anchor" id="line-21-4"></span><span class="ID">plt</span>.<span class="ID">plot</span>(<span class="ID">x</span>, <span class="ID">z</span>, <span class="String">'</span><span class="String">.</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_22">  22</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_22"></span><span class="anchor" id="line-22-4"></span><span class="ID">plt</span>.<span class="ID">title</span>(<span class="String">'</span><span class="String">X vs Z=F(X,Y=constant)</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_23">  23</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_23"></span><span class="anchor" id="line-23-4"></span><span class="ID">plt</span>.<span class="ID">xlabel</span>(<span class="String">'</span><span class="String">X</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_24">  24</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_24"></span><span class="anchor" id="line-24-4"></span><span class="ID">plt</span>.<span class="ID">ylabel</span>(<span class="String">'</span><span class="String">Z</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_25">  25</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_25"></span><span class="anchor" id="line-25-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_26">  26</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_26"></span><span class="anchor" id="line-26-3"></span><span class="Comment"># y vs z cross-section.  notice the noise.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_27">  27</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_27"></span><span class="anchor" id="line-27-2"></span><span class="ID">plt</span>.<span class="ID">plot</span>(<span class="ID">y</span>, <span class="ID">z</span>, <span class="String">'</span><span class="String">.</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_28">  28</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_28"></span><span class="anchor" id="line-28-2"></span><span class="ID">plt</span>.<span class="ID">title</span>(<span class="String">'</span><span class="String">Y vs Z=F(Y,X=constant)</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_29">  29</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_29"></span><span class="anchor" id="line-29-2"></span><span class="ID">plt</span>.<span class="ID">xlabel</span>(<span class="String">'</span><span class="String">Y</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_30">  30</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_30"></span><span class="anchor" id="line-30-2"></span><span class="ID">plt</span>.<span class="ID">ylabel</span>(<span class="String">'</span><span class="String">Z</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_31">  31</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_31"></span><span class="anchor" id="line-31-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_32">  32</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_32"></span><span class="anchor" id="line-32-2"></span><span class="Comment"># now show the dependent data (x vs y).  we could represent the z data</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_33">  33</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_33"></span><span class="anchor" id="line-33-2"></span><span class="Comment"># as a third axis by either a 3d plot or contour plot, but we need to</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_34">  34</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_34"></span><span class="anchor" id="line-34-2"></span><span class="Comment"># grid it first....</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_35">  35</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_35"></span><span class="anchor" id="line-35-2"></span><span class="ID">plt</span>.<span class="ID">plot</span>(<span class="ID">x</span>, <span class="ID">y</span>, <span class="String">'</span><span class="String">.</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_36">  36</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_36"></span><span class="anchor" id="line-36-2"></span><span class="ID">plt</span>.<span class="ID">title</span>(<span class="String">'</span><span class="String">X vs Y</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_37">  37</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_37"></span><span class="anchor" id="line-37-2"></span><span class="ID">plt</span>.<span class="ID">xlabel</span>(<span class="String">'</span><span class="String">X</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_38">  38</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_38"></span><span class="anchor" id="line-38-2"></span><span class="ID">plt</span>.<span class="ID">ylabel</span>(<span class="String">'</span><span class="String">Y</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_39">  39</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_39"></span><span class="anchor" id="line-39-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_40">  40</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_40"></span><span class="anchor" id="line-40-2"></span><span class="Comment"># enter the gridding.  imagine drawing a symmetrical grid over the</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_41">  41</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_41"></span><span class="anchor" id="line-41-2"></span><span class="Comment"># plot above.  the binsize is the width and height of one of the grid</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_42">  42</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_42"></span><span class="anchor" id="line-42-2"></span><span class="Comment"># cells, or bins in units of x and y.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_43">  43</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_43"></span><span class="anchor" id="line-43-2"></span><span class="ID">binsize</span> = <span class="Number">0.3</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_44">  44</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_44"></span><span class="anchor" id="line-44-2"></span><span class="ID">grid</span>, <span class="ID">bins</span>, <span class="ID">binloc</span> = <span class="ID">griddata</span>.<span class="ID">griddata</span>(<span class="ID">x</span>, <span class="ID">y</span>, <span class="ID">z</span>, <span class="ID">binsize</span>=<span class="ID">binsize</span>)  <span class="Comment"># see this routine's docstring</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_45">  45</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_45"></span><span class="anchor" id="line-45-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_46">  46</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_46"></span><span class="anchor" id="line-46-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_47">  47</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_47"></span><span class="anchor" id="line-47-2"></span><span class="Comment"># minimum values for colorbar. filter our nans which are in the grid</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_48">  48</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_48"></span><span class="anchor" id="line-48-2"></span><span class="ID">zmin</span>    = <span class="ID">grid</span>[<span class="ID">np</span>.<span class="ID">where</span>(<span class="ID">np</span>.<span class="ID">isnan</span>(<span class="ID">grid</span>) == <span class="ResWord">False</span>)].<span class="ID">min</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_49">  49</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_49"></span><span class="anchor" id="line-49-2"></span><span class="ID">zmax</span>    = <span class="ID">grid</span>[<span class="ID">np</span>.<span class="ID">where</span>(<span class="ID">np</span>.<span class="ID">isnan</span>(<span class="ID">grid</span>) == <span class="ResWord">False</span>)].<span class="ID">max</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_50">  50</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_50"></span><span class="anchor" id="line-50-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_51">  51</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_51"></span><span class="anchor" id="line-51-2"></span><span class="Comment"># colorbar stuff</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_52">  52</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_52"></span><span class="anchor" id="line-52-2"></span><span class="ID">palette</span> = <span class="ID">plt</span>.<span class="ID">matplotlib</span>.<span class="ID">colors</span>.<span class="ID">LinearSegmentedColormap</span>(<span class="String">'</span><span class="String">jet3</span><span class="String">'</span>,<span class="ID">plt</span>.<span class="ID">cm</span>.<span class="ID">datad</span>[<span class="String">'</span><span class="String">jet</span><span class="String">'</span>],<span class="Number">2048</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_53">  53</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_53"></span><span class="anchor" id="line-53-2"></span><span class="ID">palette</span>.<span class="ID">set_under</span>(<span class="ID">alpha</span>=<span class="Number">0.0</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_54">  54</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_54"></span><span class="anchor" id="line-54-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_55">  55</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_55"></span><span class="anchor" id="line-55-2"></span><span class="Comment"># plot the results.  first plot is x, y vs z, where z is a filled level plot.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_56">  56</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_56"></span><span class="anchor" id="line-56-2"></span><span class="ID">extent</span> = (<span class="ID">x</span>.<span class="ID">min</span>(), <span class="ID">x</span>.<span class="ID">max</span>(), <span class="ID">y</span>.<span class="ID">min</span>(), <span class="ID">y</span>.<span class="ID">max</span>()) <span class="Comment"># extent of the plot</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_57">  57</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_57"></span><span class="anchor" id="line-57-2"></span><span class="ID">plt</span>.<span class="ID">subplot</span>(<span class="Number">1</span>, <span class="Number">2</span>, <span class="Number">1</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_58">  58</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_58"></span><span class="anchor" id="line-58-2"></span><span class="ID">plt</span>.<span class="ID">imshow</span>(<span class="ID">grid</span>, <span class="ID">extent</span>=<span class="ID">extent</span>, <span class="ID">cmap</span>=<span class="ID">palette</span>, <span class="ID">origin</span>=<span class="String">'</span><span class="String">lower</span><span class="String">'</span>, <span class="ID">vmin</span>=<span class="ID">zmin</span>, <span class="ID">vmax</span>=<span class="ID">zmax</span>, <span class="ID">aspect</span>=<span class="String">'</span><span class="String">auto</span><span class="String">'</span>, <span class="ID">interpolation</span>=<span class="String">'</span><span class="String">bilinear</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_59">  59</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_59"></span><span class="anchor" id="line-59-2"></span><span class="ID">plt</span>.<span class="ID">xlabel</span>(<span class="String">'</span><span class="String">X values</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_60">  60</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_60"></span><span class="anchor" id="line-60-2"></span><span class="ID">plt</span>.<span class="ID">ylabel</span>(<span class="String">'</span><span class="String">Y values</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_61">  61</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_61"></span><span class="anchor" id="line-61-2"></span><span class="ID">plt</span>.<span class="ID">title</span>(<span class="String">'</span><span class="String">Z = F(X, Y)</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_62">  62</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_62"></span><span class="anchor" id="line-62-2"></span><span class="ID">plt</span>.<span class="ID">colorbar</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_63">  63</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_63"></span><span class="anchor" id="line-63-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_64">  64</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_64"></span><span class="anchor" id="line-64-2"></span><span class="Comment"># now show the number of points in each bin.  since the independent data are</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_65">  65</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_65"></span><span class="anchor" id="line-65-2"></span><span class="Comment"># Gaussian distributed, we expect a 2D Gaussian.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_66">  66</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_66"></span><span class="anchor" id="line-66-2"></span><span class="ID">plt</span>.<span class="ID">subplot</span>(<span class="Number">1</span>, <span class="Number">2</span>, <span class="Number">2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_67">  67</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_67"></span><span class="anchor" id="line-67-2"></span><span class="ID">plt</span>.<span class="ID">imshow</span>(<span class="ID">bins</span>, <span class="ID">extent</span>=<span class="ID">extent</span>, <span class="ID">cmap</span>=<span class="ID">palette</span>, <span class="ID">origin</span>=<span class="String">'</span><span class="String">lower</span><span class="String">'</span>, <span class="ID">vmin</span>=<span class="Number">0</span>, <span class="ID">vmax</span>=<span class="ID">bins</span>.<span class="ID">max</span>(), <span class="ID">aspect</span>=<span class="String">'</span><span class="String">auto</span><span class="String">'</span>, <span class="ID">interpolation</span>=<span class="String">'</span><span class="String">bilinear</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_68">  68</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_68"></span><span class="anchor" id="line-68-2"></span><span class="ID">plt</span>.<span class="ID">xlabel</span>(<span class="String">'</span><span class="String">X values</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_69">  69</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_69"></span><span class="anchor" id="line-69-2"></span><span class="ID">plt</span>.<span class="ID">ylabel</span>(<span class="String">'</span><span class="String">Y values</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_70">  70</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_70"></span><span class="anchor" id="line-70-2"></span><span class="ID">plt</span>.<span class="ID">title</span>(<span class="String">'</span><span class="String">X, Y vs The No. of Pts Per Bin</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_71">  71</a> </span><span class="LineAnchor" id="CA-017333b90a16e7d9e1db3301a9e81c479ebc403c_71"></span><span class="anchor" id="line-71-2"></span><span class="ID">plt</span>.<span class="ID">colorbar</span>()</span>
</pre></div></div><span class="anchor" id="line-253"></span><span class="anchor" id="line-254"></span><p class="line874">The binned data: <span class="anchor" id="line-255"></span><img alt="bin_small.png" class="attachment" src="bin_smallef6e.png?action=AttachFile&amp;do=get&amp;target=bin_small.png" title="bin_small.png" /> <span class="anchor" id="line-256"></span><span class="anchor" id="line-257"></span><p class="line874">Raw data superimposed on top of binned data: <span class="anchor" id="line-258"></span><img alt="raw_small.png" class="attachment" src="raw_smalld99c.png?action=AttachFile&amp;do=get&amp;target=raw_small.png" title="raw_small.png" /> <span class="anchor" id="line-259"></span><span class="anchor" id="line-260"></span><p class="line867"><hr /><p class="line874"> <span class="anchor" id="line-261"></span><a href="../../CategoryCookbookMatplotlib.html">Category<strong class="highlight">Cookbook</strong>Matplotlib</a> <span class="anchor" id="line-262"></span><span class="anchor" id="bottom"></span></div><p id="pageinfo" class="info" lang="en" dir="ltr">SciPy: Cookbook/Matplotlib/Gridding_irregularly_spaced_data  (last edited 2015-10-24 17:48:26 by <span title="">anonymous</span>)</p>

<div id="pagebottom"></div>
</div>


<div id="footer">
<ul class="editbar"><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbattachments" href="Gridding_irregularly_spaced_data37dc.html?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="../../../external.html?link=http://localhost:8080/Cookbook/Matplotlib/Gridding_irregularly_spaced_data">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

<ul id="credits">
<li><a href="../../../external.html?link=http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="../../../external.html?link=http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="../../../external.html?link=http://moinmo.in/GPL" title="MoinMoin is GPL licensed.">GPL licensed</a></li><li><a href="../../../external.html?link=http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li>
</ul>


</div>
</body>

<!-- Mirrored from localhost:8080/Cookbook/Matplotlib/Gridding_irregularly_spaced_data?highlight=%28%28Cookbook%29%29 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Oct 2015 23:19:09 GMT -->
</html>

